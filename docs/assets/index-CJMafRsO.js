function ia(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const cr=globalThis,Di=cr.ShadowRoot&&(cr.ShadyCSS===void 0||cr.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Li=Symbol(),gn=new WeakMap;let Ps=class{constructor(t,r,i){if(this._$cssResult$=!0,i!==Li)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=r}get styleSheet(){let t=this.o;const r=this.t;if(Di&&t===void 0){const i=r!==void 0&&r.length===1;i&&(t=gn.get(r)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&gn.set(r,t))}return t}toString(){return this.cssText}};const na=e=>new Ps(typeof e=="string"?e:e+"",void 0,Li),sa=(e,...t)=>{const r=e.length===1?e[0]:t.reduce((i,n,s)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[s+1],e[0]);return new Ps(r,e,Li)},oa=(e,t)=>{if(Di)e.adoptedStyleSheets=t.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of t){const i=document.createElement("style"),n=cr.litNonce;n!==void 0&&i.setAttribute("nonce",n),i.textContent=r.cssText,e.appendChild(i)}},_n=Di?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let r="";for(const i of t.cssRules)r+=i.cssText;return na(r)})(e):e;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:aa,defineProperty:la,getOwnPropertyDescriptor:ca,getOwnPropertyNames:ua,getOwnPropertySymbols:da,getPrototypeOf:ha}=Object,$e=globalThis,mn=$e.trustedTypes,pa=mn?mn.emptyScript:"",Zr=$e.reactiveElementPolyfillSupport,Mt=(e,t)=>e,fr={toAttribute(e,t){switch(t){case Boolean:e=e?pa:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=e!==null;break;case Number:r=e===null?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch{r=null}}return r}},Ni=(e,t)=>!aa(e,t),yn={attribute:!0,type:String,converter:fr,reflect:!1,hasChanged:Ni};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),$e.litPropertyMetadata??($e.litPropertyMetadata=new WeakMap);class nt extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??(this.l=[])).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,r=yn){if(r.state&&(r.attribute=!1),this._$Ei(),this.elementProperties.set(t,r),!r.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(t,i,r);n!==void 0&&la(this.prototype,t,n)}}static getPropertyDescriptor(t,r,i){const{get:n,set:s}=ca(this.prototype,t)??{get(){return this[r]},set(o){this[r]=o}};return{get(){return n==null?void 0:n.call(this)},set(o){const l=n==null?void 0:n.call(this);s.call(this,o),this.requestUpdate(t,l,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??yn}static _$Ei(){if(this.hasOwnProperty(Mt("elementProperties")))return;const t=ha(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(Mt("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Mt("properties"))){const r=this.properties,i=[...ua(r),...da(r)];for(const n of i)this.createProperty(n,r[n])}const t=this[Symbol.metadata];if(t!==null){const r=litPropertyMetadata.get(t);if(r!==void 0)for(const[i,n]of r)this.elementProperties.set(i,n)}this._$Eh=new Map;for(const[r,i]of this.elementProperties){const n=this._$Eu(r,i);n!==void 0&&this._$Eh.set(n,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const r=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const n of i)r.unshift(_n(n))}else t!==void 0&&r.push(_n(t));return r}static _$Eu(t,r){const i=r.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var t;this._$ES=new Promise(r=>this.enableUpdating=r),this._$AL=new Map,this._$E_(),this.requestUpdate(),(t=this.constructor.l)==null||t.forEach(r=>r(this))}addController(t){var r;(this._$EO??(this._$EO=new Set)).add(t),this.renderRoot!==void 0&&this.isConnected&&((r=t.hostConnected)==null||r.call(t))}removeController(t){var r;(r=this._$EO)==null||r.delete(t)}_$E_(){const t=new Map,r=this.constructor.elementProperties;for(const i of r.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return oa(t,this.constructor.elementStyles),t}connectedCallback(){var t;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$EO)==null||t.forEach(r=>{var i;return(i=r.hostConnected)==null?void 0:i.call(r)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$EO)==null||t.forEach(r=>{var i;return(i=r.hostDisconnected)==null?void 0:i.call(r)})}attributeChangedCallback(t,r,i){this._$AK(t,i)}_$EC(t,r){var s;const i=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,i);if(n!==void 0&&i.reflect===!0){const o=(((s=i.converter)==null?void 0:s.toAttribute)!==void 0?i.converter:fr).toAttribute(r,i.type);this._$Em=t,o==null?this.removeAttribute(n):this.setAttribute(n,o),this._$Em=null}}_$AK(t,r){var s;const i=this.constructor,n=i._$Eh.get(t);if(n!==void 0&&this._$Em!==n){const o=i.getPropertyOptions(n),l=typeof o.converter=="function"?{fromAttribute:o.converter}:((s=o.converter)==null?void 0:s.fromAttribute)!==void 0?o.converter:fr;this._$Em=n,this[n]=l.fromAttribute(r,o.type),this._$Em=null}}requestUpdate(t,r,i){if(t!==void 0){if(i??(i=this.constructor.getPropertyOptions(t)),!(i.hasChanged??Ni)(this[t],r))return;this.P(t,r,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(t,r,i){this._$AL.has(t)||this._$AL.set(t,r),i.reflect===!0&&this._$Em!==t&&(this._$Ej??(this._$Ej=new Set)).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[s,o]of this._$Ep)this[s]=o;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[s,o]of n)o.wrapped!==!0||this._$AL.has(s)||this[s]===void 0||this.P(s,this[s],o)}let t=!1;const r=this._$AL;try{t=this.shouldUpdate(r),t?(this.willUpdate(r),(i=this._$EO)==null||i.forEach(n=>{var s;return(s=n.hostUpdate)==null?void 0:s.call(n)}),this.update(r)):this._$EU()}catch(n){throw t=!1,this._$EU(),n}t&&this._$AE(r)}willUpdate(t){}_$AE(t){var r;(r=this._$EO)==null||r.forEach(i=>{var n;return(n=i.hostUpdated)==null?void 0:n.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&(this._$Ej=this._$Ej.forEach(r=>this._$EC(r,this[r]))),this._$EU()}updated(t){}firstUpdated(t){}}nt.elementStyles=[],nt.shadowRootOptions={mode:"open"},nt[Mt("elementProperties")]=new Map,nt[Mt("finalized")]=new Map,Zr==null||Zr({ReactiveElement:nt}),($e.reactiveElementVersions??($e.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Rt=globalThis,gr=Rt.trustedTypes,vn=gr?gr.createPolicy("lit-html",{createHTML:e=>e}):void 0,Us="$lit$",xe=`lit$${Math.random().toFixed(9).slice(2)}$`,Fs="?"+xe,fa=`<${Fs}>`,Xe=document,Ft=()=>Xe.createComment(""),Ht=e=>e===null||typeof e!="object"&&typeof e!="function",Hs=Array.isArray,ga=e=>Hs(e)||typeof(e==null?void 0:e[Symbol.iterator])=="function",ei=`[ 	
\f\r]`,Et=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,bn=/-->/g,Sn=/>/g,ze=RegExp(`>|${ei}(?:([^\\s"'>=/]+)(${ei}*=${ei}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),wn=/'/g,Cn=/"/g,Bs=/^(?:script|style|textarea|title)$/i,_a=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),ma=_a(1),ht=Symbol.for("lit-noChange"),J=Symbol.for("lit-nothing"),In=new WeakMap,Ve=Xe.createTreeWalker(Xe,129);function js(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return vn!==void 0?vn.createHTML(t):t}const ya=(e,t)=>{const r=e.length-1,i=[];let n,s=t===2?"<svg>":"",o=Et;for(let l=0;l<r;l++){const a=e[l];let u,d,h=-1,p=0;for(;p<a.length&&(o.lastIndex=p,d=o.exec(a),d!==null);)p=o.lastIndex,o===Et?d[1]==="!--"?o=bn:d[1]!==void 0?o=Sn:d[2]!==void 0?(Bs.test(d[2])&&(n=RegExp("</"+d[2],"g")),o=ze):d[3]!==void 0&&(o=ze):o===ze?d[0]===">"?(o=n??Et,h=-1):d[1]===void 0?h=-2:(h=o.lastIndex-d[2].length,u=d[1],o=d[3]===void 0?ze:d[3]==='"'?Cn:wn):o===Cn||o===wn?o=ze:o===bn||o===Sn?o=Et:(o=ze,n=void 0);const f=o===ze&&e[l+1].startsWith("/>")?" ":"";s+=o===Et?a+fa:h>=0?(i.push(u),a.slice(0,h)+Us+a.slice(h)+xe+f):a+xe+(h===-2?l:f)}return[js(e,s+(e[r]||"<?>")+(t===2?"</svg>":"")),i]};class Bt{constructor({strings:t,_$litType$:r},i){let n;this.parts=[];let s=0,o=0;const l=t.length-1,a=this.parts,[u,d]=ya(t,r);if(this.el=Bt.createElement(u,i),Ve.currentNode=this.el.content,r===2){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(n=Ve.nextNode())!==null&&a.length<l;){if(n.nodeType===1){if(n.hasAttributes())for(const h of n.getAttributeNames())if(h.endsWith(Us)){const p=d[o++],f=n.getAttribute(h).split(xe),g=/([.?@])?(.*)/.exec(p);a.push({type:1,index:s,name:g[2],strings:f,ctor:g[1]==="."?ba:g[1]==="?"?Sa:g[1]==="@"?wa:Dr}),n.removeAttribute(h)}else h.startsWith(xe)&&(a.push({type:6,index:s}),n.removeAttribute(h));if(Bs.test(n.tagName)){const h=n.textContent.split(xe),p=h.length-1;if(p>0){n.textContent=gr?gr.emptyScript:"";for(let f=0;f<p;f++)n.append(h[f],Ft()),Ve.nextNode(),a.push({type:2,index:++s});n.append(h[p],Ft())}}}else if(n.nodeType===8)if(n.data===Fs)a.push({type:2,index:s});else{let h=-1;for(;(h=n.data.indexOf(xe,h+1))!==-1;)a.push({type:7,index:s}),h+=xe.length-1}s++}}static createElement(t,r){const i=Xe.createElement("template");return i.innerHTML=t,i}}function pt(e,t,r=e,i){var o,l;if(t===ht)return t;let n=i!==void 0?(o=r._$Co)==null?void 0:o[i]:r._$Cl;const s=Ht(t)?void 0:t._$litDirective$;return(n==null?void 0:n.constructor)!==s&&((l=n==null?void 0:n._$AO)==null||l.call(n,!1),s===void 0?n=void 0:(n=new s(e),n._$AT(e,r,i)),i!==void 0?(r._$Co??(r._$Co=[]))[i]=n:r._$Cl=n),n!==void 0&&(t=pt(e,n._$AS(e,t.values),n,i)),t}class va{constructor(t,r){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:r},parts:i}=this._$AD,n=((t==null?void 0:t.creationScope)??Xe).importNode(r,!0);Ve.currentNode=n;let s=Ve.nextNode(),o=0,l=0,a=i[0];for(;a!==void 0;){if(o===a.index){let u;a.type===2?u=new Qt(s,s.nextSibling,this,t):a.type===1?u=new a.ctor(s,a.name,a.strings,this,t):a.type===6&&(u=new Ca(s,this,t)),this._$AV.push(u),a=i[++l]}o!==(a==null?void 0:a.index)&&(s=Ve.nextNode(),o++)}return Ve.currentNode=Xe,n}p(t){let r=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,r),r+=i.strings.length-2):i._$AI(t[r])),r++}}class Qt{get _$AU(){var t;return((t=this._$AM)==null?void 0:t._$AU)??this._$Cv}constructor(t,r,i,n){this.type=2,this._$AH=J,this._$AN=void 0,this._$AA=t,this._$AB=r,this._$AM=i,this.options=n,this._$Cv=(n==null?void 0:n.isConnected)??!0}get parentNode(){let t=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=r.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,r=this){t=pt(this,t,r),Ht(t)?t===J||t==null||t===""?(this._$AH!==J&&this._$AR(),this._$AH=J):t!==this._$AH&&t!==ht&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):ga(t)?this.k(t):this._(t)}S(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.S(t))}_(t){this._$AH!==J&&Ht(this._$AH)?this._$AA.nextSibling.data=t:this.T(Xe.createTextNode(t)),this._$AH=t}$(t){var s;const{values:r,_$litType$:i}=t,n=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=Bt.createElement(js(i.h,i.h[0]),this.options)),i);if(((s=this._$AH)==null?void 0:s._$AD)===n)this._$AH.p(r);else{const o=new va(n,this),l=o.u(this.options);o.p(r),this.T(l),this._$AH=o}}_$AC(t){let r=In.get(t.strings);return r===void 0&&In.set(t.strings,r=new Bt(t)),r}k(t){Hs(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let i,n=0;for(const s of t)n===r.length?r.push(i=new Qt(this.S(Ft()),this.S(Ft()),this,this.options)):i=r[n],i._$AI(s),n++;n<r.length&&(this._$AR(i&&i._$AB.nextSibling,n),r.length=n)}_$AR(t=this._$AA.nextSibling,r){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,r);t&&t!==this._$AB;){const n=t.nextSibling;t.remove(),t=n}}setConnected(t){var r;this._$AM===void 0&&(this._$Cv=t,(r=this._$AP)==null||r.call(this,t))}}class Dr{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,r,i,n,s){this.type=1,this._$AH=J,this._$AN=void 0,this.element=t,this.name=r,this._$AM=n,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=J}_$AI(t,r=this,i,n){const s=this.strings;let o=!1;if(s===void 0)t=pt(this,t,r,0),o=!Ht(t)||t!==this._$AH&&t!==ht,o&&(this._$AH=t);else{const l=t;let a,u;for(t=s[0],a=0;a<s.length-1;a++)u=pt(this,l[i+a],r,a),u===ht&&(u=this._$AH[a]),o||(o=!Ht(u)||u!==this._$AH[a]),u===J?t=J:t!==J&&(t+=(u??"")+s[a+1]),this._$AH[a]=u}o&&!n&&this.j(t)}j(t){t===J?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class ba extends Dr{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===J?void 0:t}}class Sa extends Dr{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==J)}}class wa extends Dr{constructor(t,r,i,n,s){super(t,r,i,n,s),this.type=5}_$AI(t,r=this){if((t=pt(this,t,r,0)??J)===ht)return;const i=this._$AH,n=t===J&&i!==J||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==J&&(i===J||n);n&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var r;typeof this._$AH=="function"?this._$AH.call(((r=this.options)==null?void 0:r.host)??this.element,t):this._$AH.handleEvent(t)}}class Ca{constructor(t,r,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=r,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){pt(this,t)}}const ti=Rt.litHtmlPolyfillSupport;ti==null||ti(Bt,Qt),(Rt.litHtmlVersions??(Rt.litHtmlVersions=[])).push("3.1.4");const Ia=(e,t,r)=>{const i=(r==null?void 0:r.renderBefore)??t;let n=i._$litPart$;if(n===void 0){const s=(r==null?void 0:r.renderBefore)??null;i._$litPart$=n=new Qt(t.insertBefore(Ft(),s),s,void 0,r??{})}return n._$AI(e),n};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class $t extends nt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var r;const t=super.createRenderRoot();return(r=this.renderOptions).renderBefore??(r.renderBefore=t.firstChild),t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Ia(r,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)==null||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)==null||t.setConnected(!1)}render(){return ht}}var Ns;$t._$litElement$=!0,$t.finalized=!0,(Ns=globalThis.litElementHydrateSupport)==null||Ns.call(globalThis,{LitElement:$t});const ri=globalThis.litElementPolyfillSupport;ri==null||ri({LitElement:$t});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.6");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ta=e=>(t,r)=>{r!==void 0?r.addInitializer(()=>{customElements.define(e,t)}):customElements.define(e,t)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Aa={attribute:!0,type:String,converter:fr,reflect:!1,hasChanged:Ni},Ea=(e=Aa,t,r)=>{const{kind:i,metadata:n}=r;let s=globalThis.litPropertyMetadata.get(n);if(s===void 0&&globalThis.litPropertyMetadata.set(n,s=new Map),s.set(r.name,e),i==="accessor"){const{name:o}=r;return{set(l){const a=t.get.call(this);t.set.call(this,l),this.requestUpdate(o,a,e)},init(l){return l!==void 0&&this.P(o,void 0,e),l}}}if(i==="setter"){const{name:o}=r;return function(l){const a=this[o];t.call(this,l),this.requestUpdate(o,a,e)}}throw Error("Unsupported decorator location: "+i)};function Oa(e){return(t,r)=>typeof r=="object"?Ea(e,t,r):((i,n,s)=>{const o=n.hasOwnProperty(s);return n.constructor.createProperty(s,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(n,s):void 0})(e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function xa(e){return Oa({...e,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ka=(e,t,r)=>(r.configurable=!0,r.enumerable=!0,Reflect.decorate&&typeof t!="object"&&Object.defineProperty(e,t,r),r);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Ma(e,t){return(r,i,n)=>{const s=o=>{var l;return((l=o.renderRoot)==null?void 0:l.querySelector(e))??null};return ka(r,i,{get(){return s(this)}})}}const Tn=e=>{if(typeof e=="object"&&e!==null){if(typeof Object.getPrototypeOf=="function"){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}return!1},ve=(...e)=>e.reduce((t,r)=>{if(Array.isArray(r))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(r).forEach(i=>{["__proto__","constructor","prototype"].includes(i)||(Array.isArray(t[i])&&Array.isArray(r[i])?t[i]=ve.options.mergeArrays?ve.options.uniqueArrayItems?Array.from(new Set(t[i].concat(r[i]))):[...t[i],...r[i]]:r[i]:Tn(t[i])&&Tn(r[i])?t[i]=ve(t[i],r[i]):t[i]=r[i]===void 0?ve.options.allowUndefinedOverrides?r[i]:t[i]:r[i])}),t},{}),yi={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};ve.options=yi;ve.withOptions=(e,...t)=>{ve.options=Object.assign(Object.assign({},yi),e);const r=ve(...t);return ve.options=yi,r};const zs=e=>e&&e.length?`${e.map((r,i)=>{const n=i+1,s=[];return s.push(`col${n}=${encodeURIComponent(r.columnName)}`),s.push(`op${n}=${r.operator}`),s.push(r.values.map(o=>{const l=typeof o=="bigint"?o.toString():o;return`val${n}=${encodeURIComponent(String(l))}`}).join("&")),s.join("&")}).join("&")}`:null,qs=e=>e&&e.length?`${e.map((r,i)=>{const n=i+1,s=[];return s.push(`param${n}=${encodeURIComponent(r.name)}`),s.push(`paramVal${n}=${encodeURIComponent(r.value)}`),s.join("&")}).join("&")}`:null,Ra=e=>typeof e=="string"||typeof e=="number"||typeof e=="boolean"?e:JSON.stringify(e),$a=e=>Array.isArray(e)?e.join(","):e,Gs=(e,t=!1)=>{const r=[];return Object.keys(e).forEach(n=>{const s=e[n];if(s!==void 0){const o=t?Ra(s):$a(s);r.push(`${n}=${o}`)}}),r.length?r.join("&"):null},ii=e=>typeof e=="number"?`${e}px`:e,Da=(e,t)=>{let r=e;const i=encodeURIComponent(t);return e.indexOf("#")>=0?r=`${r}${i}`:r=`${r}#${i}`,r};function Vs(e,t,r=""){const i=r?new URL(r,window.location.origin).href:e;return Da(i,t)}const An=e=>e&&btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),La=e=>e.getBoundingClientRect().top+window.scrollY,ni={START:"start",END:"end"},Na=(e,t)=>{Object.keys(t).forEach(r=>{e.setAttribute(r,t[r].toString())})},Pa=(e,t)=>{var r,i,n,s;const o=e.customCssUrl,l=t.customizations,a=e.customizations||e.customisations;return{style:{...a==null?void 0:a.style,...l==null?void 0:l.style,customCSS:{...(r=a==null?void 0:a.style)===null||r===void 0?void 0:r.customCSS,...(i=l==null?void 0:l.style)===null||i===void 0?void 0:i.customCSS},customCSSUrl:((n=l==null?void 0:l.style)===null||n===void 0?void 0:n.customCSSUrl)||((s=a==null?void 0:a.style)===null||s===void 0?void 0:s.customCSSUrl)||o},content:{...a==null?void 0:a.content,...l==null?void 0:l.content}}},Ua=e=>zs(e||[]);function Ws(e){return typeof e=="string"?document.querySelector(e):e}const Fa=(e,t)=>ve(e,t),Ha=e=>{const t=/(?:query|mutation)\s+(\w+)/,r=e.match(t);return r==null?void 0:r[1]};function Ks(e){if(!e||typeof e!="object")return e;for(const t in e)t==="__typename"?delete e[t]:typeof e[t]=="object"&&Ks(e[t]);return e}const Ot=(e,t)=>{e!=null&&e.style&&Object.keys(t).forEach(r=>{e.style[r]=t[r].toString()})},Ba=(e,t)=>{e!=null&&e.style&&t.forEach(r=>{e.style.removeProperty(r)})},_r=e=>e===void 0,ja=e=>typeof e=="string"?["char","string"]:typeof e=="number"?["double","double"]:typeof e=="boolean"?["boolean","boolean"]:["",""];var Q;(function(e){e.None="None",e.EmbeddedSSO="EmbeddedSSO",e.SSO="SSO_SAML",e.SAML="SSO_SAML",e.SAMLRedirect="SSO_SAML",e.OIDC="SSO_OIDC",e.OIDCRedirect="SSO_OIDC",e.AuthServer="AuthServer",e.TrustedAuthToken="AuthServer",e.TrustedAuthTokenCookieless="AuthServerCookieless",e.Basic="Basic"})(Q||(Q={}));var En;(function(e){e.SearchData="search-data",e.Home="insights-home",e.Liveboards="liveboards",e.Answers="answers",e.MonitorSubscription="monitor-alerts",e.SpotIQAnalysis="spotiq-analysis"})(En||(En={}));var On;(function(e){e.EQ="EQ",e.NE="NE",e.LT="LT",e.LE="LE",e.GT="GT",e.GE="GE",e.CONTAINS="CONTAINS",e.BEGINS_WITH="BEGINS_WITH",e.ENDS_WITH="ENDS_WITH",e.BW_INC_MAX="BW_INC_MAX",e.BW_INC_MIN="BW_INC_MIN",e.BW_INC="BW_INC",e.BW="BW",e.IN="IN",e.NOT_IN="NOT_IN"})(On||(On={}));var xn;(function(e){e.Search="SEARCH",e.Watchlist="WATCHLIST",e.Favorite="FAVORITE",e.MyLibrary="MY_LIBRARY",e.Trending="TRENDING",e.Learning="LEARNING"})(xn||(xn={}));var H;(function(e){e.Init="init",e.AuthInit="authInit",e.Load="load",e.Data="data",e.FiltersChanged="filtersChanged",e.QueryChanged="queryChanged",e.Drilldown="drillDown",e.DataSourceSelected="dataSourceSelected",e.AddRemoveColumns="addRemoveColumns",e.CustomAction="customAction",e.VizPointDoubleClick="vizPointDoubleClick",e.VizPointClick="vizPointClick",e.Error="Error",e.Alert="alert",e.AuthExpire="ThoughtspotAuthExpired",e.AuthFailure="ThoughtspotAuthFailure",e.AuthLogout="ThoughtspotAuthLogout",e.EmbedHeight="EMBED_HEIGHT",e.EmbedIframeCenter="EmbedIframeCenter",e.GetDataClick="getDataClick",e.RouteChange="ROUTE_CHANGE",e.V1Data="exportVizDataToParent",e.NoCookieAccess="noCookieAccess",e.SAMLComplete="samlComplete",e.DialogOpen="dialog-open",e.DialogClose="dialog-close",e.LiveboardRendered="PinboardRendered",e.ALL="*",e.Save="save",e.Download="download",e.DownloadAsPng="downloadAsPng",e.DownloadAsPdf="downloadAsPdf",e.DownloadAsCsv="downloadAsCsv",e.DownloadAsXlsx="downloadAsXlsx",e.AnswerDelete="answerDelete",e.Pin="pin",e.SpotIQAnalyze="spotIQAnalyze",e.Share="share",e.DrillInclude="context-menu-item-include",e.DrillExclude="context-menu-item-exclude",e.CopyToClipboard="context-menu-item-copy-to-clipboard",e.UpdateTML="updateTSL",e.EditTML="editTSL",e.ExportTML="exportTSL",e.SaveAsView="saveAsView",e.CopyAEdit="copyAEdit",e.ShowUnderlyingData="showUnderlyingData",e.AnswerChartSwitcher="answerChartSwitcher",e.APP_INIT="appInit",e.LiveboardInfo="pinboardInfo",e.AddToFavorites="addToFavorites",e.Schedule="subscription",e.Edit="edit",e.MakeACopy="makeACopy",e.Present="present",e.Delete="delete",e.SchedulesList="schedule-list",e.Cancel="cancel",e.Explore="explore",e.CopyLink="embedDocument",e.CrossFilterChanged="cross-filter-changed",e.VizPointRightClick="vizPointRightClick",e.InsertIntoSlide="insertInToSlide",e.FilterChanged="filterChanged",e.SageEmbedQuery="sageEmbedQuery",e.SageWorksheetUpdated="sageWorksheetUpdated",e.UpdateConnection="updateConnection",e.CreateConnection="createConnection",e.UpdatePersonalisedView="updatePersonalisedView",e.SavePersonalisedView="savePersonalisedView",e.ResetLiveboard="resetLiveboard",e.DeletePersonalisedView="deletePersonalisedView",e.CreateWorksheet="createWorksheet",e.AskSageInit="AskSageInit",e.Rename="rename",e.OnBeforeGetVizDataIntercept="onBeforeGetVizDataIntercept",e.ParameterChanged="parameterChanged"})(H||(H={}));var De;(function(e){e.Search="search",e.DrillDown="triggerDrillDown",e.Filter="filter",e.Reload="reload",e.SetVisibleVizs="SetPinboardVisibleVizs",e.SetActiveTab="SetActiveTab",e.UpdateRuntimeFilters="UpdateRuntimeFilters",e.Navigate="Navigate",e.OpenFilter="openFilter",e.AddColumns="addColumns",e.RemoveColumn="removeColumn",e.getExportRequestForCurrentPinboard="getExportRequestForCurrentPinboard",e.Pin="pin",e.LiveboardInfo="pinboardInfo",e.Schedule="subscription",e.SchedulesList="schedule-list",e.ExportTML="exportTSL",e.EditTML="editTSL",e.UpdateTML="updateTSL",e.DownloadAsPdf="downloadAsPdf",e.MakeACopy="makeACopy",e.Remove="delete",e.Explore="explore",e.CreateMonitor="createMonitor",e.ManageMonitor="manageMonitor",e.Edit="edit",e.CopyLink="embedDocument",e.Present="present",e.GetTML="getTML",e.ShowUnderlyingData="showUnderlyingData",e.Delete="onDeleteAnswer",e.SpotIQAnalyze="spotIQAnalyze",e.Download="downloadAsPng",e.DownloadAsPng="downloadAsPng",e.DownloadAsCsv="downloadAsCSV",e.DownloadAsXlsx="downloadAsXLSX",e.Share="share",e.Save="save",e.SyncToSheets="sync-to-sheets",e.SyncToOtherApps="sync-to-other-apps",e.ManagePipelines="manage-pipeline",e.ResetSearch="resetSearch",e.GetFilters="getFilters",e.UpdateFilters="updateFilters",e.GetTabs="getTabs",e.SetVisibleTabs="SetPinboardVisibleTabs",e.SetHiddenTabs="SetPinboardHiddenTabs",e.UpdateSageQuery="updateSageQuery",e.GetAnswerSession="getAnswerSession",e.AskSage="AskSage",e.UpdateCrossFilter="UpdateCrossFilter",e.ResetLiveboardPersonalisedView="ResetLiveboardPersonalisedView",e.CreateLiveboard="CreateLiveboard",e.UpdateParameters="UpdateParameters",e.GetParameters="GetParameters"})(De||(De={}));var kn;(function(e){e.Hidden="hide",e.Collapsed="collapse",e.Expanded="expand"})(kn||(kn={}));var I;(function(e){e.EmbedApp="embedApp",e.DataSources="dataSources",e.DataSourceMode="dataSourceMode",e.DisableActions="disableAction",e.DisableActionReason="disableHint",e.ForceTable="forceTable",e.preventLiveboardFilterRemoval="preventPinboardFilterRemoval",e.SearchQuery="searchQuery",e.HideActions="hideAction",e.HideObjects="hideObjects",e.HostAppUrl="hostAppUrl",e.EnableVizTransformations="enableVizTransform",e.EnableSearchAssist="enableSearchAssist",e.HideResult="hideResult",e.UseLastSelectedDataSource="useLastSelectedSources",e.Tag="tag",e.searchTokenString="searchTokenString",e.executeSearch="executeSearch",e.fullHeight="isFullHeightPinboard",e.livedBoardEmbed="isLiveboardEmbed",e.searchEmbed="isSearchEmbed",e.vizEmbed="isVizEmbed",e.Version="sdkVersion",e.ViewPortHeight="viewPortHeight",e.ViewPortWidth="viewPortWidth",e.VisibleActions="visibleAction",e.CustomCSSUrl="customCssUrl",e.DisableLoginRedirect="disableLoginRedirect",e.visibleVizs="pinboardVisibleVizs",e.LiveboardV2Enabled="isPinboardV2Enabled",e.DataPanelV2Enabled="enableDataPanelV2",e.ShowAlerts="showAlerts",e.Locale="locale",e.CustomStyle="customStyle",e.ForceSAMLAutoRedirect="forceSAMLAutoRedirect",e.AuthType="authType",e.IconSpriteUrl="iconSprite",e.cookieless="cookieless",e.ContextMenuTrigger="isContextMenuEnabledOnLeftClick",e.LinkOverride="linkOverride",e.blockNonEmbedFullAppAccess="blockNonEmbedFullAppAccess",e.ShowInsertToSlide="insertInToSlide",e.PrimaryNavHidden="primaryNavHidden",e.HideProfleAndHelp="profileAndHelpInNavBarHidden",e.HideApplicationSwitcher="applicationSwitcherHidden",e.HideOrgSwitcher="orgSwitcherHidden",e.IsSageEmbed="isSageEmbed",e.HideWorksheetSelector="hideWorksheetSelector",e.DisableWorksheetChange="disableWorksheetChange",e.HideEurekaResults="hideEurekaResults",e.HideEurekaSuggestions="hideEurekaSuggestions",e.HideAutocompleteSuggestions="hideAutocompleteSuggestions",e.HideLiveboardHeader="hideLiveboardHeader",e.ShowLiveboardDescription="showLiveboardDescription",e.ShowLiveboardTitle="showLiveboardTitle",e.HiddenTabs="hideTabs",e.VisibleTabs="visibleTabs",e.HideTabPanel="hideTabPanel",e.HideSampleQuestions="hideSampleQuestions",e.WorksheetId="worksheet",e.Query="query",e.HideHomepageLeftNav="hideHomepageLeftNav",e.ModularHomeExperienceEnabled="modularHomeExperience",e.PendoTrackingKey="additionalPendoKey",e.LiveboardHeaderSticky="isLiveboardHeaderSticky",e.IsProductTour="isProductTour",e.HideSearchBarTitle="hideSearchBarTitle",e.HideSageAnswerHeader="hideSageAnswerHeader",e.HideSearchBar="hideSearchBar",e.ClientLogLevel="clientLogLevel",e.OverrideNativeConsole="overrideConsoleLogs",e.enableAskSage="enableAskSage",e.CollapseSearchBarInitially="collapseSearchBarInitially",e.DataPanelCustomGroupsAccordionInitialState="dataPanelCustomGroupsAccordionInitialState",e.EnableCustomColumnGroups="enableCustomColumnGroups",e.DateFormatLocale="dateFormatLocale",e.NumberFormatLocale="numberFormatLocale",e.CurrencyFormat="currencyFormat",e.Enable2ColumnLayout="enable2ColumnLayout",e.IsFullAppEmbed="isFullAppEmbed",e.IsOnBeforeGetVizDataInterceptEnabled="isOnBeforeGetVizDataInterceptEnabled"})(I||(I={}));var ke;(function(e){e.Save="save",e.Update="update",e.SaveUntitled="saveUntitled",e.SaveAsView="saveAsView",e.MakeACopy="makeACopy",e.EditACopy="editACopy",e.CopyLink="embedDocument",e.ResetLayout="resetLayout",e.Schedule="subscription",e.SchedulesList="schedule-list",e.Share="share",e.AddFilter="addFilter",e.AddDataPanelObjects="addDataPanelObjects",e.ConfigureFilter="configureFilter",e.CollapseDataSources="collapseDataSources",e.ChooseDataSources="chooseDataSources",e.AddFormula="addFormula",e.AddParameter="addParameter",e.AddColumnSet="addSimpleCohort",e.AddQuerySet="addAdvancedCohort",e.SearchOnTop="searchOnTop",e.SpotIQAnalyze="spotIQAnalyze",e.ExplainInsight="explainInsight",e.SpotIQFollow="spotIQFollow",e.ShareViz="shareViz",e.ReplaySearch="replaySearch",e.ShowUnderlyingData="showUnderlyingData",e.Download="download",e.DownloadAsPng="downloadAsPng",e.DownloadAsPdf="downloadAsPdf",e.DownloadAsCsv="downloadAsCSV",e.DownloadAsXlsx="downloadAsXLSX",e.DownloadTrace="downloadTrace",e.ExportTML="exportTSL",e.ImportTML="importTSL",e.UpdateTML="updateTSL",e.EditTML="editTSL",e.Present="present",e.ToggleSize="toggleSize",e.Edit="edit",e.EditTitle="editTitle",e.Remove="delete",e.Ungroup="ungroup",e.Describe="describe",e.Relate="relate",e.CustomizeHeadlines="customizeHeadlines",e.PinboardInfo="pinboardInfo",e.LiveboardInfo="pinboardInfo",e.SendAnswerFeedback="sendFeedback",e.DownloadEmbraceQueries="downloadEmbraceQueries",e.Pin="pin",e.AnalysisInfo="analysisInfo",e.Subscription="subscription",e.Explore="explore",e.DrillInclude="context-menu-item-include",e.DrillExclude="context-menu-item-exclude",e.CopyToClipboard="context-menu-item-copy-to-clipboard",e.CopyAndEdit="context-menu-item-copy-and-edit",e.DrillEdit="context-menu-item-edit",e.EditMeasure="context-menu-item-edit-measure",e.Separator="context-menu-item-separator",e.DrillDown="DRILL",e.RequestAccess="requestAccess",e.QueryDetailsButtons="queryDetailsButtons",e.AnswerDelete="onDeleteAnswer",e.AnswerChartSwitcher="answerChartSwitcher",e.AddToFavorites="addToFavorites",e.EditDetails="editDetails",e.CreateMonitor="createMonitor",e.ReportError="reportError",e.SyncToSheets="sync-to-sheets",e.SyncToOtherApps="sync-to-other-apps",e.ManagePipelines="manage-pipeline",e.CrossFilter="context-menu-item-cross-filter",e.SyncToSlack="syncToSlack",e.SyncToTeams="syncToTeams",e.RemoveCrossFilter="context-menu-item-remove-cross-filter",e.AxisMenuAggregate="axisMenuAggregate",e.AxisMenuTimeBucket="axisMenuTimeBucket",e.AxisMenuFilter="axisMenuFilter",e.AxisMenuConditionalFormat="axisMenuConditionalFormat",e.AxisMenuSort="axisMenuSort",e.AxisMenuGroup="axisMenuGroup",e.AxisMenuPosition="axisMenuPosition",e.AxisMenuRename="axisMenuRename",e.AxisMenuEdit="axisMenuEdit",e.AxisMenuNumberFormat="axisMenuNumberFormat",e.AxisMenuTextWrapping="axisMenuTextWrapping",e.AxisMenuRemove="axisMenuRemove",e.InsertInToSlide="insertInToSlide",e.RenameModalTitleDescription="renameModalTitleDescription",e.RequestVerification="requestVerification",e.MarkAsVerified="markAsVerified",e.AddTab="addTab",e.EnableContextualChangeAnalysis="enableContextualChangeAnalysis",e.ShowSageQuery="showSageQuery",e.EditSageAnswer="editSageAnswer",e.SageAnswerFeedback="sageAnswerFeedback",e.ModifySageAnswer="modifySageAnswer",e.MoveToTab="onContainerMove",e.ManageMonitor="ManageMonitor",e.PersonalisedViewsDropdown="personalisedViewsDropdown",e.LiveboardUsers="liveboardUsers",e.TML="tml",e.VerifiedLiveboard="verifiedLiveboard",e.AskAi="AskAi",e.AddToWatchlist="addToWatchlist",e.RemoveFromWatchlist="removeFromWatchlist",e.OrganiseFavourites="organiseFavourites",e.AIHighlights="AIHighlights"})(ke||(ke={}));var We;(function(e){e.FullApp="FullApp",e.SearchEmbed="SearchEmbed",e.LiveboardEmbed="LiveboardEmbed",e.VizEmbed="VizEmbed"})(We||(We={}));var mr;(function(e){e.LEFT_CLICK="left-click",e.RIGHT_CLICK="right-click"})(mr||(mr={}));var z;(function(e){e.SILENT="SILENT",e.ERROR="ERROR",e.WARN="WARN",e.INFO="INFO",e.DEBUG="DEBUG",e.TRACE="TRACE"})(z||(z={}));const za={[z.SILENT]:()=>{},[z.ERROR]:console.error,[z.WARN]:console.warn,[z.INFO]:console.info,[z.DEBUG]:console.debug,[z.TRACE]:console.trace};let vi=z.TRACE;const qa=e=>{vi=e},Mn={[z.SILENT]:0,[z.ERROR]:1,[z.WARN]:2,[z.INFO]:3,[z.DEBUG]:4,[z.TRACE]:5},Rn=(e,t)=>{const r=Mn[e],i=Mn[t];return r-i};class Ga{constructor(){this.logLevel=z.ERROR,this.setLogLevel=t=>{this.logLevel=t},this.getLogLevel=()=>this.logLevel}canLog(t){return t===z.SILENT?!1:_r(vi)?Rn(this.logLevel,t)>=0:Rn(vi,t)>=0}logMessages(t,r){if(this.canLog(r)){const i=za[r];i&&i(...t)}}log(...t){this.info(t)}info(...t){this.logMessages(t,z.INFO)}debug(...t){this.logMessages(t,z.DEBUG)}trace(...t){this.logMessages(t,z.TRACE)}error(...t){this.logMessages(t,z.ERROR)}warn(...t){this.logMessages(t,z.WARN)}}const K=new Ga;var rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Va(){this.__data__=[],this.size=0}var Wa=Va;function Ka(e,t){return e===t||e!==e&&t!==t}var Qs=Ka,Qa=Qs;function Xa(e,t){for(var r=e.length;r--;)if(Qa(e[r][0],t))return r;return-1}var Lr=Xa,Ya=Lr,Ja=Array.prototype,Za=Ja.splice;function el(e){var t=this.__data__,r=Ya(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():Za.call(t,r,1),--this.size,!0}var tl=el,rl=Lr;function il(e){var t=this.__data__,r=rl(t,e);return r<0?void 0:t[r][1]}var nl=il,sl=Lr;function ol(e){return sl(this.__data__,e)>-1}var al=ol,ll=Lr;function cl(e,t){var r=this.__data__,i=ll(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var ul=cl,dl=Wa,hl=tl,pl=nl,fl=al,gl=ul;function yt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}yt.prototype.clear=dl;yt.prototype.delete=hl;yt.prototype.get=pl;yt.prototype.has=fl;yt.prototype.set=gl;var Nr=yt,_l=Nr;function ml(){this.__data__=new _l,this.size=0}var yl=ml;function vl(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var bl=vl;function Sl(e){return this.__data__.get(e)}var wl=Sl;function Cl(e){return this.__data__.has(e)}var Il=Cl,Tl=typeof rr=="object"&&rr&&rr.Object===Object&&rr,Xs=Tl,Al=Xs,El=typeof self=="object"&&self&&self.Object===Object&&self,Ol=Al||El||Function("return this")(),Ie=Ol,xl=Ie,kl=xl.Symbol,Ui=kl,$n=Ui,Ys=Object.prototype,Ml=Ys.hasOwnProperty,Rl=Ys.toString,xt=$n?$n.toStringTag:void 0;function $l(e){var t=Ml.call(e,xt),r=e[xt];try{e[xt]=void 0;var i=!0}catch{}var n=Rl.call(e);return i&&(t?e[xt]=r:delete e[xt]),n}var Dl=$l,Ll=Object.prototype,Nl=Ll.toString;function Pl(e){return Nl.call(e)}var Ul=Pl,Dn=Ui,Fl=Dl,Hl=Ul,Bl="[object Null]",jl="[object Undefined]",Ln=Dn?Dn.toStringTag:void 0;function zl(e){return e==null?e===void 0?jl:Bl:Ln&&Ln in Object(e)?Fl(e):Hl(e)}var Pr=zl;function ql(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Js=ql,Gl=Pr,Vl=Js,Wl="[object AsyncFunction]",Kl="[object Function]",Ql="[object GeneratorFunction]",Xl="[object Proxy]";function Yl(e){if(!Vl(e))return!1;var t=Gl(e);return t==Kl||t==Ql||t==Wl||t==Xl}var Zs=Yl,Jl=Ie,Zl=Jl["__core-js_shared__"],ec=Zl,si=ec,Nn=function(){var e=/[^.]+$/.exec(si&&si.keys&&si.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function tc(e){return!!Nn&&Nn in e}var rc=tc,ic=Function.prototype,nc=ic.toString;function sc(e){if(e!=null){try{return nc.call(e)}catch{}try{return e+""}catch{}}return""}var eo=sc,oc=Zs,ac=rc,lc=Js,cc=eo,uc=/[\\^$.*+?()[\]{}|]/g,dc=/^\[object .+?Constructor\]$/,hc=Function.prototype,pc=Object.prototype,fc=hc.toString,gc=pc.hasOwnProperty,_c=RegExp("^"+fc.call(gc).replace(uc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function mc(e){if(!lc(e)||ac(e))return!1;var t=oc(e)?_c:dc;return t.test(cc(e))}var yc=mc;function vc(e,t){return e==null?void 0:e[t]}var bc=vc,Sc=yc,wc=bc;function Cc(e,t){var r=wc(e,t);return Sc(r)?r:void 0}var vt=Cc,Ic=vt,Tc=Ie,Ac=Ic(Tc,"Map"),Fi=Ac,Ec=vt,Oc=Ec(Object,"create"),Ur=Oc,Pn=Ur;function xc(){this.__data__=Pn?Pn(null):{},this.size=0}var kc=xc;function Mc(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Rc=Mc,$c=Ur,Dc="__lodash_hash_undefined__",Lc=Object.prototype,Nc=Lc.hasOwnProperty;function Pc(e){var t=this.__data__;if($c){var r=t[e];return r===Dc?void 0:r}return Nc.call(t,e)?t[e]:void 0}var Uc=Pc,Fc=Ur,Hc=Object.prototype,Bc=Hc.hasOwnProperty;function jc(e){var t=this.__data__;return Fc?t[e]!==void 0:Bc.call(t,e)}var zc=jc,qc=Ur,Gc="__lodash_hash_undefined__";function Vc(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=qc&&t===void 0?Gc:t,this}var Wc=Vc,Kc=kc,Qc=Rc,Xc=Uc,Yc=zc,Jc=Wc;function bt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}bt.prototype.clear=Kc;bt.prototype.delete=Qc;bt.prototype.get=Xc;bt.prototype.has=Yc;bt.prototype.set=Jc;var Zc=bt,Un=Zc,eu=Nr,tu=Fi;function ru(){this.size=0,this.__data__={hash:new Un,map:new(tu||eu),string:new Un}}var iu=ru;function nu(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var su=nu,ou=su;function au(e,t){var r=e.__data__;return ou(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Fr=au,lu=Fr;function cu(e){var t=lu(this,e).delete(e);return this.size-=t?1:0,t}var uu=cu,du=Fr;function hu(e){return du(this,e).get(e)}var pu=hu,fu=Fr;function gu(e){return fu(this,e).has(e)}var _u=gu,mu=Fr;function yu(e,t){var r=mu(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var vu=yu,bu=iu,Su=uu,wu=pu,Cu=_u,Iu=vu;function St(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}St.prototype.clear=bu;St.prototype.delete=Su;St.prototype.get=wu;St.prototype.has=Cu;St.prototype.set=Iu;var to=St,Tu=Nr,Au=Fi,Eu=to,Ou=200;function xu(e,t){var r=this.__data__;if(r instanceof Tu){var i=r.__data__;if(!Au||i.length<Ou-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Eu(i)}return r.set(e,t),this.size=r.size,this}var ku=xu,Mu=Nr,Ru=yl,$u=bl,Du=wl,Lu=Il,Nu=ku;function wt(e){var t=this.__data__=new Mu(e);this.size=t.size}wt.prototype.clear=Ru;wt.prototype.delete=$u;wt.prototype.get=Du;wt.prototype.has=Lu;wt.prototype.set=Nu;var Pu=wt,Uu="__lodash_hash_undefined__";function Fu(e){return this.__data__.set(e,Uu),this}var Hu=Fu;function Bu(e){return this.__data__.has(e)}var ju=Bu,zu=to,qu=Hu,Gu=ju;function yr(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new zu;++t<r;)this.add(e[t])}yr.prototype.add=yr.prototype.push=qu;yr.prototype.has=Gu;var Vu=yr;function Wu(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var Ku=Wu;function Qu(e,t){return e.has(t)}var Xu=Qu,Yu=Vu,Ju=Ku,Zu=Xu,ed=1,td=2;function rd(e,t,r,i,n,s){var o=r&ed,l=e.length,a=t.length;if(l!=a&&!(o&&a>l))return!1;var u=s.get(e),d=s.get(t);if(u&&d)return u==t&&d==e;var h=-1,p=!0,f=r&td?new Yu:void 0;for(s.set(e,t),s.set(t,e);++h<l;){var g=e[h],_=t[h];if(i)var m=o?i(_,g,h,t,e,s):i(g,_,h,e,t,s);if(m!==void 0){if(m)continue;p=!1;break}if(f){if(!Ju(t,function(S,b){if(!Zu(f,b)&&(g===S||n(g,S,r,i,s)))return f.push(b)})){p=!1;break}}else if(!(g===_||n(g,_,r,i,s))){p=!1;break}}return s.delete(e),s.delete(t),p}var ro=rd,id=Ie,nd=id.Uint8Array,sd=nd;function od(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var ad=od;function ld(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var cd=ld,Fn=Ui,Hn=sd,ud=Qs,dd=ro,hd=ad,pd=cd,fd=1,gd=2,_d="[object Boolean]",md="[object Date]",yd="[object Error]",vd="[object Map]",bd="[object Number]",Sd="[object RegExp]",wd="[object Set]",Cd="[object String]",Id="[object Symbol]",Td="[object ArrayBuffer]",Ad="[object DataView]",Bn=Fn?Fn.prototype:void 0,oi=Bn?Bn.valueOf:void 0;function Ed(e,t,r,i,n,s,o){switch(r){case Ad:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Td:return!(e.byteLength!=t.byteLength||!s(new Hn(e),new Hn(t)));case _d:case md:case bd:return ud(+e,+t);case yd:return e.name==t.name&&e.message==t.message;case Sd:case Cd:return e==t+"";case vd:var l=hd;case wd:var a=i&fd;if(l||(l=pd),e.size!=t.size&&!a)return!1;var u=o.get(e);if(u)return u==t;i|=gd,o.set(e,t);var d=dd(l(e),l(t),i,n,s,o);return o.delete(e),d;case Id:if(oi)return oi.call(e)==oi.call(t)}return!1}var Od=Ed;function xd(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var kd=xd,Md=Array.isArray,Hi=Md,Rd=kd,$d=Hi;function Dd(e,t,r){var i=t(e);return $d(e)?i:Rd(i,r(e))}var Ld=Dd;function Nd(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var o=e[r];t(o,r,e)&&(s[n++]=o)}return s}var Pd=Nd;function Ud(){return[]}var Fd=Ud,Hd=Pd,Bd=Fd,jd=Object.prototype,zd=jd.propertyIsEnumerable,jn=Object.getOwnPropertySymbols,qd=jn?function(e){return e==null?[]:(e=Object(e),Hd(jn(e),function(t){return zd.call(e,t)}))}:Bd,Gd=qd;function Vd(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var Wd=Vd;function Kd(e){return e!=null&&typeof e=="object"}var Hr=Kd,Qd=Pr,Xd=Hr,Yd="[object Arguments]";function Jd(e){return Xd(e)&&Qd(e)==Yd}var Zd=Jd,zn=Zd,eh=Hr,io=Object.prototype,th=io.hasOwnProperty,rh=io.propertyIsEnumerable,ih=zn(function(){return arguments}())?zn:function(e){return eh(e)&&th.call(e,"callee")&&!rh.call(e,"callee")},nh=ih,vr={exports:{}};function sh(){return!1}var oh=sh;vr.exports;(function(e,t){var r=Ie,i=oh,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,l=o?r.Buffer:void 0,a=l?l.isBuffer:void 0,u=a||i;e.exports=u})(vr,vr.exports);var no=vr.exports,ah=9007199254740991,lh=/^(?:0|[1-9]\d*)$/;function ch(e,t){var r=typeof e;return t=t??ah,!!t&&(r=="number"||r!="symbol"&&lh.test(e))&&e>-1&&e%1==0&&e<t}var uh=ch,dh=9007199254740991;function hh(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=dh}var so=hh,ph=Pr,fh=so,gh=Hr,_h="[object Arguments]",mh="[object Array]",yh="[object Boolean]",vh="[object Date]",bh="[object Error]",Sh="[object Function]",wh="[object Map]",Ch="[object Number]",Ih="[object Object]",Th="[object RegExp]",Ah="[object Set]",Eh="[object String]",Oh="[object WeakMap]",xh="[object ArrayBuffer]",kh="[object DataView]",Mh="[object Float32Array]",Rh="[object Float64Array]",$h="[object Int8Array]",Dh="[object Int16Array]",Lh="[object Int32Array]",Nh="[object Uint8Array]",Ph="[object Uint8ClampedArray]",Uh="[object Uint16Array]",Fh="[object Uint32Array]",F={};F[Mh]=F[Rh]=F[$h]=F[Dh]=F[Lh]=F[Nh]=F[Ph]=F[Uh]=F[Fh]=!0;F[_h]=F[mh]=F[xh]=F[yh]=F[kh]=F[vh]=F[bh]=F[Sh]=F[wh]=F[Ch]=F[Ih]=F[Th]=F[Ah]=F[Eh]=F[Oh]=!1;function Hh(e){return gh(e)&&fh(e.length)&&!!F[ph(e)]}var Bh=Hh;function jh(e){return function(t){return e(t)}}var zh=jh,br={exports:{}};br.exports;(function(e,t){var r=Xs,i=t&&!t.nodeType&&t,n=i&&!0&&e&&!e.nodeType&&e,s=n&&n.exports===i,o=s&&r.process,l=function(){try{var a=n&&n.require&&n.require("util").types;return a||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(br,br.exports);var qh=br.exports,Gh=Bh,Vh=zh,qn=qh,Gn=qn&&qn.isTypedArray,Wh=Gn?Vh(Gn):Gh,oo=Wh,Kh=Wd,Qh=nh,Xh=Hi,Yh=no,Jh=uh,Zh=oo,ep=Object.prototype,tp=ep.hasOwnProperty;function rp(e,t){var r=Xh(e),i=!r&&Qh(e),n=!r&&!i&&Yh(e),s=!r&&!i&&!n&&Zh(e),o=r||i||n||s,l=o?Kh(e.length,String):[],a=l.length;for(var u in e)(t||tp.call(e,u))&&!(o&&(u=="length"||n&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Jh(u,a)))&&l.push(u);return l}var ip=rp,np=Object.prototype;function sp(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||np;return e===r}var op=sp;function ap(e,t){return function(r){return e(t(r))}}var lp=ap,cp=lp,up=cp(Object.keys,Object),dp=up,hp=op,pp=dp,fp=Object.prototype,gp=fp.hasOwnProperty;function _p(e){if(!hp(e))return pp(e);var t=[];for(var r in Object(e))gp.call(e,r)&&r!="constructor"&&t.push(r);return t}var mp=_p,yp=Zs,vp=so;function bp(e){return e!=null&&vp(e.length)&&!yp(e)}var Sp=bp,wp=ip,Cp=mp,Ip=Sp;function Tp(e){return Ip(e)?wp(e):Cp(e)}var Ap=Tp,Ep=Ld,Op=Gd,xp=Ap;function kp(e){return Ep(e,xp,Op)}var Mp=kp,Vn=Mp,Rp=1,$p=Object.prototype,Dp=$p.hasOwnProperty;function Lp(e,t,r,i,n,s){var o=r&Rp,l=Vn(e),a=l.length,u=Vn(t),d=u.length;if(a!=d&&!o)return!1;for(var h=a;h--;){var p=l[h];if(!(o?p in t:Dp.call(t,p)))return!1}var f=s.get(e),g=s.get(t);if(f&&g)return f==t&&g==e;var _=!0;s.set(e,t),s.set(t,e);for(var m=o;++h<a;){p=l[h];var S=e[p],b=t[p];if(i)var v=o?i(b,S,p,t,e,s):i(S,b,p,e,t,s);if(!(v===void 0?S===b||n(S,b,r,i,s):v)){_=!1;break}m||(m=p=="constructor")}if(_&&!m){var w=e.constructor,C=t.constructor;w!=C&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof C=="function"&&C instanceof C)&&(_=!1)}return s.delete(e),s.delete(t),_}var Np=Lp,Pp=vt,Up=Ie,Fp=Pp(Up,"DataView"),Hp=Fp,Bp=vt,jp=Ie,zp=Bp(jp,"Promise"),qp=zp,Gp=vt,Vp=Ie,Wp=Gp(Vp,"Set"),Kp=Wp,Qp=vt,Xp=Ie,Yp=Qp(Xp,"WeakMap"),Jp=Yp,bi=Hp,Si=Fi,wi=qp,Ci=Kp,Ii=Jp,ao=Pr,Ct=eo,Wn="[object Map]",Zp="[object Object]",Kn="[object Promise]",Qn="[object Set]",Xn="[object WeakMap]",Yn="[object DataView]",ef=Ct(bi),tf=Ct(Si),rf=Ct(wi),nf=Ct(Ci),sf=Ct(Ii),qe=ao;(bi&&qe(new bi(new ArrayBuffer(1)))!=Yn||Si&&qe(new Si)!=Wn||wi&&qe(wi.resolve())!=Kn||Ci&&qe(new Ci)!=Qn||Ii&&qe(new Ii)!=Xn)&&(qe=function(e){var t=ao(e),r=t==Zp?e.constructor:void 0,i=r?Ct(r):"";if(i)switch(i){case ef:return Yn;case tf:return Wn;case rf:return Kn;case nf:return Qn;case sf:return Xn}return t});var of=qe,ai=Pu,af=ro,lf=Od,cf=Np,Jn=of,Zn=Hi,es=no,uf=oo,df=1,ts="[object Arguments]",rs="[object Array]",ir="[object Object]",hf=Object.prototype,is=hf.hasOwnProperty;function pf(e,t,r,i,n,s){var o=Zn(e),l=Zn(t),a=o?rs:Jn(e),u=l?rs:Jn(t);a=a==ts?ir:a,u=u==ts?ir:u;var d=a==ir,h=u==ir,p=a==u;if(p&&es(e)){if(!es(t))return!1;o=!0,d=!1}if(p&&!d)return s||(s=new ai),o||uf(e)?af(e,t,r,i,n,s):lf(e,t,a,r,i,n,s);if(!(r&df)){var f=d&&is.call(e,"__wrapped__"),g=h&&is.call(t,"__wrapped__");if(f||g){var _=f?e.value():e,m=g?t.value():t;return s||(s=new ai),n(_,m,r,i,s)}}return p?(s||(s=new ai),cf(e,t,r,i,n,s)):!1}var ff=pf,gf=ff,ns=Hr;function lo(e,t,r,i,n){return e===t?!0:e==null||t==null||!ns(e)&&!ns(t)?e!==e&&t!==t:gf(e,t,r,i,lo,n)}var _f=lo,mf=_f;function yf(e,t){return mf(e,t)}var vf=yf;const bf=Pi(vf),rt={AUTH_VERIFICATION:"/callosum/v1/session/info",SAML_LOGIN_TEMPLATE:e=>`/callosum/v1/saml/login?targetURLPath=${e}`,OIDC_LOGIN_TEMPLATE:e=>`/callosum/v1/oidc/login?targetURLPath=${e}`,TOKEN_LOGIN:"/callosum/v1/session/login/token",BASIC_LOGIN:"/callosum/v1/session/login",LOGOUT:"/callosum/v1/session/logout",EXECUTE_TML:"/api/rest/2.0/metadata/tml/import",EXPORT_TML:"/api/rest/2.0/metadata/tml/export",IS_ACTIVE:"/callosum/v1/session/isactive"};function Bi(e,t={}){return fetch(e,t).then(async r=>{var i;return!r.ok&&r.type!=="opaqueredirect"&&r.type!=="opaque"&&K.error("Failure",await((i=r.text)===null||i===void 0?void 0:i.call(r))),r})}async function Sf(e,t){const r=`${e}${rt.IS_ACTIVE}`;try{return(await fetch(r,{headers:{Authorization:`Bearer ${t}`,"x-requested-by":"ThoughtSpot"},credentials:"omit"})).ok}catch(i){K.warn(`Token Verification Service failed : ${i.message}`)}return!1}async function wf(e){return fetch(e)}async function Cf(e,t,r){const i=t?`username=${t}&auth_token=${r}`:`auth_token=${r}`;return Bi(`${e}${rt.TOKEN_LOGIN}?${i}`,{credentials:"include",redirect:"manual"})}async function If(e,t,r){const i=t?`username=${encodeURIComponent(t)}&auth_token=${encodeURIComponent(r)}`:`auth_token=${encodeURIComponent(r)}`;return Bi(`${e}${rt.TOKEN_LOGIN}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded","x-requested-by":"ThoughtSpot"},body:i,credentials:"include",redirect:"manual"})}async function Tf(e,t,r){return Bi(`${e}${rt.BASIC_LOGIN}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded","x-requested-by":"ThoughtSpot"},body:`username=${encodeURIComponent(t)}&password=${encodeURIComponent(r)}`,credentials:"include"})}const ss="Duplicate token, please issue a new token every time getAuthToken callback is called.See https://developers.thoughtspot.com/docs/?pageid=embed-auth#trusted-auth-embed for more details.",Af="Invalid token received form token callback or authToken endpoint.";let Ke=null;const jt=async e=>{if(Ke&&!e.disableTokenVerification){let n;try{n=await os(e,Ke,!0)}catch{n=!1}if(n)return Ke}const{authEndpoint:t,getAuthToken:r}=e;let i=null;return r?i=await r():i=await(await wf(t)).text(),await os(e,i),Ke=i,i},os=async(e,t,r)=>{if(e.disableTokenVerification)return K.info("Token verification is disabled. Assuming token is valid."),!0;try{if(await Sf(e.thoughtSpotHost,t))return!0}catch{return!1}throw Ke&&Ke===t?(!e.suppressErrorAlerts&&!r&&alert(ss),new Error(ss)):new Error(Af)},ji=()=>{Ke=null};let co={};const ae=()=>co,Ef=e=>(co=e,e),zi=async(e,t)=>{const r=ae();if(r.authType!==Q.TrustedAuthTokenCookieless)return fetch(e,t);const i=new Request(e,t),n=await jt(r);return n&&i.headers.append("Authorization",`Bearer ${n}`),fetch(i)};async function Ti({query:e,variables:t,thoughtSpotHost:r,isCompositeQuery:i=!1}){const n=Ha(e);try{const o=await(await zi(`${r}/prism/?op=${n}`,{method:"POST",headers:{"content-type":"application/json;charset=UTF-8","x-requested-by":"ThoughtSpot",accept:"*/*","accept-language":"en-us"},body:JSON.stringify({operationName:n,query:e,variables:t}),credentials:"include"})).json(),l=Object.values(o.data);return i?o.data:l[0]}catch(s){return s}}const Of=`
    query GetSourceDetail($ids: [GUID!]!) {
        getSourceDetailById(ids: $ids, type: LOGICAL_TABLE) {
        id
        name
        description
        authorName
        authorDisplayName
        isExternal
        type
        created
        modified
        columns {
            id
            name
            author
            authorDisplayName
            description
            dataType
            type
            modified
            ownerName
            owner
            dataRecency
            sources {
            tableId
            tableName
            columnId
            columnName
            __typename
            }
            synonyms
            cohortAnswerId
            __typename
        }
        relationships
        destinationRelationships
        dataSourceId
        __typename
        }
    }  
`,li=new Map;async function xf(e,t){if(li.get(t))return li.get(t);const i=(await Ti({query:Of,variables:{ids:[t]},thoughtSpotHost:e}))[0];return i&&li.set(t,i),i}const It=`
id {
    sessionId
    genNo
    acSession {
        sessionId
        genNo
    }
}
`,kf=`
mutation GetUnAggregatedAnswerSession($session: BachSessionIdInput!, $columns: [UserPointSelectionInput!]!) {
    Answer__getUnaggregatedAnswer(session: $session, columns: $columns) {
        ${It}
        answer {
            visualizations {
                ... on TableViz {
                    columns {
                        column {
                            id
                            name
                            referencedColumns {
                                guid
                                displayName
                            }
                        }
                    }
                }
            }
        }
    }
}  
`,Mf=`
mutation RemoveColumns($session: BachSessionIdInput!, $logicalColumnIds: [GUID!], $columnIds: [GUID!]) {
    Answer__removeColumns(
        session: $session
        logicalColumnIds: $logicalColumnIds
        columnIds: $columnIds
        ) {
            ${It}
    }
}
    `,Rf=`
    mutation AddColumns($session: BachSessionIdInput!, $columns: [AnswerColumnInfo!]!) {
        Answer__addColumn(session: $session, columns: $columns) {
            ${It}
        }
    }
    `,$f=`
    mutation AddUpdateFilter($session: BachSessionIdInput!, $params: AddUpdateFilterInput!) {
        Answer__addUpdateFilter(session: $session, params: $params) {
            ${It}
        }
    }
`,Df=`
    query GetAnswer($session: BachSessionIdInput!) {
        getAnswer(session: $session) {
            ${It}
            answer {
                id
                name
                description
                displayMode
                sources {
                    header {
                        guid
                        displayName
                    }
                }
                filterGroups {
                    columnInfo {
                        name
                        referencedColumns {
                            guid
                            displayName
                        }
                    }
                    filters {
                        filterContent {
                            filterType
                            negate
                            value {
                                key
                            }
                        }
                    }
                }
                visualizations {
                    ... on TableViz {
                        columns {
                            column {
                                id
                                name
                                referencedColumns {
                                    guid
                                    displayName
                                }
                            }
                        }
                    }
                }
            }
        }
    }

`,Lf=`
    query GetTableWithHeadlineData($session: BachSessionIdInput!, $deadline: Int!, $dataPaginationParams: DataPaginationParamsInput!) {
        getAnswer(session: $session) {
            ${It}
            answer {
                id
                visualizations {
                    id
                    ... on TableViz {
                        columns {
                            column {
                                id
                                name
                                type
                                aggregationType
                                dataType
                            }
                        }
                        data(deadline: $deadline, pagination: $dataPaginationParams)
                    }          
                }
            }
        }
    }
`;var as;(function(e){e.GetChartWithData="GetChartWithData",e.GetTableWithHeadlineData="GetTableWithHeadlineData"})(as||(as={}));class Br{constructor(t,r,i,n){this.session=t,this.thoughtSpotHost=i,this.selectedPoints=n,this.session=Ks(t),r?this.answer=r:this.answer=this.executeQuery(Df,{}).then(s=>s==null?void 0:s.answer)}async getSourceDetail(){const t=(await this.answer).sources[0].header.guid;return xf(this.thoughtSpotHost,t)}async removeColumns(t){return this.executeQuery(Mf,{logicalColumnIds:t})}async addColumns(t){return this.executeQuery(Rf,{columns:t.map(r=>({logicalColumnId:r}))})}async addColumnsByName(t){const r=await this.getSourceDetail(),i=ci(r,t);return this.addColumns([...i])}async addFilter(t,r,i){const n=await this.getSourceDetail(),s=ci(n,[t]);return this.executeQuery($f,{params:{filterContent:[{filterType:r,value:i.map(o=>{const[l,a]=ja(o);return{type:l.toUpperCase(),[`${a}Value`]:o}})}],filterGroupId:{logicalColumnId:s.values().next().value}}})}async fetchData(t=0,r=1e3){const{answer:i}=await this.executeQuery(Lf,{deadline:0,dataPaginationParams:{isClientPaginated:!0,offset:t,size:r}}),{columns:n,data:s}=i.visualizations.find(o=>!!o.data)||{};return{columns:n,data:s}}async fetchCSVBlob(t="en-us",r=!1){const i=this.getFetchCSVBlobUrl(t,r);return zi(i,{credentials:"include"})}getFetchCSVBlobUrl(t="en-us",r=!1){return`${this.thoughtSpotHost}/prism/download/answer/csv?sessionId=${this.session.sessionId}&genNo=${this.session.genNo}&userLocale=${t}&exportFileName=data&hideCsvHeader=${!r}`}async getUnderlyingDataForPoint(t,r){if(!r&&!this.selectedPoints)throw new Error("Needs to be triggered in context of a point");r||(r=Nf(this.selectedPoints));const i=await this.getSourceDetail(),n=ci(i,t),s=await Ti({query:kf,variables:{session:this.session,columns:r},thoughtSpotHost:this.thoughtSpotHost}),o=new Br(s.id,s.answer,this.thoughtSpotHost),l=new Set(s.answer.visualizations[0].columns.map(d=>d.column.referencedColumns[0].guid)),a=[...n].filter(d=>!l.has(d));a.length&&await o.addColumns(a);const u=[...l].filter(d=>!n.has(d));return u.length&&await o.removeColumns(u),o}async executeQuery(t,r){const i=await Ti({query:t,variables:{session:this.session,...r},thoughtSpotHost:this.thoughtSpotHost,isCompositeQuery:!1});return this.session=Fa(this.session,(i==null?void 0:i.id)||{}),i}getSession(){return this.session}getAnswer(){return this.answer}}function ci(e,t){const r=e.columns.reduce((i,n)=>(i[n.name.toLowerCase()]=n,i),{});return new Set(t.map(i=>r[i.toLowerCase()].id))}function Nf(e){const t=[];function r(i){var n;const s=i.column.dataType;i.column.id;let o;s==="DATE"?Number.isFinite(i.value)?o=[{epochRange:{startEpoch:i.value}}]:!((n=i.value)===null||n===void 0)&&n.v&&(o=[{epochRange:{startEpoch:i.value.v.s,endEpoch:i.value.v.e}}]):o=[{value:i.value}],t.push({columnId:i.column.id,dataValue:o})}return e.forEach(i=>{i.selectedAttributes.forEach(r)}),t}const Sr={INVALID_THOUGHTSPOT_HOST:"Error parsing ThoughtSpot host. Please provide a valid URL.",LIVEBOARD_VIZ_ID_VALIDATION:"Please select a liveboard to embed.",TRIGGER_TIMED_OUT:"Trigger timedout in getting response",SEARCHEMBED_BETA_WRANING_MESSAGE:"Search Embed is in Beta in this release.",SAGE_EMBED_BETA_WARNING_MESSAGE:"Sage Embed is in Beta in this release."},Pf=new RegExp(["(^(https?:)//)?","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join("")),qi=e=>{if(!e.thoughtSpotHost)throw new Error(Sr.INVALID_THOUGHTSPOT_HOST);const t=e.thoughtSpotHost.match(Pf);if(!t)throw new Error(Sr.INVALID_THOUGHTSPOT_HOST);const r=t[2]||window.location.protocol,i=t[3];let n=t[6];return n.charAt(n.length-1)==="/"&&(n=n.substring(0,n.length-1)),`${r}//${i}${n}`},Uf=e=>{if(e.basepath)return e.basepath;const t=qi(e);return t.includes("://localhost")&&!t.includes(":8443")?"":"v2"},Ff=2e3,Hf="100%",Bf="100%";var X;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(X||(X={}));function jf(e){return e.nodeType===e.ELEMENT_NODE}function Dt(e){const t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function Lt(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function zf(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function qf(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const r=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function wr(e){try{const t=e.rules||e.cssRules;return t?zf(Array.from(t,uo).join("")):null}catch{return null}}function uo(e){let t;if(Vf(e))try{t=wr(e.styleSheet)||qf(e)}catch{}else if(Wf(e)&&e.selectorText.includes(":"))return Gf(e.cssText);return t||e.cssText}function Gf(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function Vf(e){return"styleSheet"in e}function Wf(e){return"selectorText"in e}class ho{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var r;if(!t)return-1;const i=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return i??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){const i=r.id;this.idNodeMap.set(i,t),this.nodeMetaMap.set(t,r)}replace(t,r){const i=this.getNode(t);if(i){const n=this.nodeMetaMap.get(i);n&&this.nodeMetaMap.set(r,n)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Kf(){return new ho}function Gi({element:e,maskInputOptions:t,tagName:r,type:i,value:n,maskInputFn:s}){let o=n||"";const l=i&&Ye(i);return(t[r.toLowerCase()]||l&&t[l])&&(s?o=s(o,e):o="*".repeat(o.length)),o}function Ye(e){return e.toLowerCase()}const ls="__rrweb_original__";function Qf(e){const t=e.getContext("2d");if(!t)return!0;const r=50;for(let i=0;i<e.width;i+=r)for(let n=0;n<e.height;n+=r){const s=t.getImageData,o=ls in s?s[ls]:s;if(new Uint32Array(o.call(t,i,n,Math.min(r,e.width-i),Math.min(r,e.height-n)).data.buffer).some(a=>a!==0))return!1}return!0}function Vi(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Ye(t):null}function po(e,t){var r;let i;try{i=new URL(e,t??window.location.href)}catch{return null}const n=/\.([0-9a-z]+)(?:$)/i,s=i.pathname.match(n);return(r=s==null?void 0:s[1])!==null&&r!==void 0?r:null}let Xf=1;const Yf=new RegExp("[^a-z0-9-_:]"),zt=-2;function fo(){return Xf++}function Jf(e){if(e instanceof HTMLFormElement)return"form";const t=Ye(e.tagName);return Yf.test(t)?"div":t}function Zf(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let it,cs;const eg=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,tg=/^(?:[a-z+]+:)?\/\//i,rg=/^www\..*/i,ig=/^(data:)([^,]*),(.*)/i;function Cr(e,t){return(e||"").replace(eg,(r,i,n,s,o,l)=>{const a=n||o||l,u=i||s||"";if(!a)return r;if(tg.test(a)||rg.test(a))return`url(${u}${a}${u})`;if(ig.test(a))return`url(${u}${a}${u})`;if(a[0]==="/")return`url(${u}${Zf(t)+a}${u})`;const d=t.split("/"),h=a.split("/");d.pop();for(const p of h)p!=="."&&(p===".."?d.pop():d.push(p));return`url(${u}${d.join("/")}${u})`})}const ng=/^[^ \t\n\r\u000c]+/,sg=/^[, \t\n\r\u000c]+/;function og(e,t){if(t.trim()==="")return t;let r=0;function i(s){let o;const l=s.exec(t.substring(r));return l?(o=l[0],r+=o.length,o):""}const n=[];for(;i(sg),!(r>=t.length);){let s=i(ng);if(s.slice(-1)===",")s=ot(e,s.substring(0,s.length-1)),n.push(s);else{let o="";s=ot(e,s);let l=!1;for(;;){const a=t.charAt(r);if(a===""){n.push((s+o).trim());break}else if(l)a===")"&&(l=!1);else if(a===","){r+=1,n.push((s+o).trim());break}else a==="("&&(l=!0);o+=a,r+=1}}}return n.join(", ")}function ot(e,t){if(!t||t.trim()==="")return t;const r=e.createElement("a");return r.href=t,r.href}function ag(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Wi(){const e=document.createElement("a");return e.href="",e.href}function go(e,t,r,i){return i&&(r==="src"||r==="href"&&!(t==="use"&&i[0]==="#")||r==="xlink:href"&&i[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?ot(e,i):r==="srcset"?og(e,i):r==="style"?Cr(i,Wi()):t==="object"&&r==="data"?ot(e,i):i)}function _o(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function lg(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let i=e.classList.length;i--;){const n=e.classList[i];if(t.test(n))return!0}if(r)return e.matches(r)}catch{}return!1}function Ir(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?Ir(e.parentNode,t,r):!1;for(let i=e.classList.length;i--;){const n=e.classList[i];if(t.test(n))return!0}return r?Ir(e.parentNode,t,r):!1}function mo(e,t,r,i){try{const n=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(n===null)return!1;if(typeof t=="string"){if(i){if(n.closest(`.${t}`))return!0}else if(n.classList.contains(t))return!0}else if(Ir(n,t,i))return!0;if(r){if(i){if(n.closest(r))return!0}else if(n.matches(r))return!0}}catch{}return!1}function cg(e,t,r){const i=e.contentWindow;if(!i)return;let n=!1,s;try{s=i.document.readyState}catch{return}if(s!=="complete"){const l=setTimeout(()=>{n||(t(),n=!0)},r);e.addEventListener("load",()=>{clearTimeout(l),n=!0,t()});return}const o="about:blank";if(i.location.href!==o||e.src===o||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function ug(e,t,r){let i=!1,n;try{n=e.sheet}catch{return}if(n)return;const s=setTimeout(()=>{i||(t(),i=!0)},r);e.addEventListener("load",()=>{clearTimeout(s),i=!0,t()})}function dg(e,t){const{doc:r,mirror:i,blockClass:n,blockSelector:s,needsMask:o,inlineStylesheet:l,maskInputOptions:a={},maskTextFn:u,maskInputFn:d,dataURLOptions:h={},inlineImages:p,recordCanvas:f,keepIframeSrcFn:g,newlyAddedElement:_=!1}=t,m=hg(r,i);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:X.Document,childNodes:[],compatMode:e.compatMode}:{type:X.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:X.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:m};case e.ELEMENT_NODE:return fg(e,{doc:r,blockClass:n,blockSelector:s,inlineStylesheet:l,maskInputOptions:a,maskInputFn:d,dataURLOptions:h,inlineImages:p,recordCanvas:f,keepIframeSrcFn:g,newlyAddedElement:_,rootId:m});case e.TEXT_NODE:return pg(e,{needsMask:o,maskTextFn:u,rootId:m});case e.CDATA_SECTION_NODE:return{type:X.CDATA,textContent:"",rootId:m};case e.COMMENT_NODE:return{type:X.Comment,textContent:e.textContent||"",rootId:m};default:return!1}}function hg(e,t){if(!t.hasNode(e))return;const r=t.getId(e);return r===1?void 0:r}function pg(e,t){var r;const{needsMask:i,maskTextFn:n,rootId:s}=t,o=e.parentNode&&e.parentNode.tagName;let l=e.textContent;const a=o==="STYLE"?!0:void 0,u=o==="SCRIPT"?!0:void 0;if(a&&l){try{e.nextSibling||e.previousSibling||!((r=e.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(l=wr(e.parentNode.sheet))}catch(d){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${d}`,e)}l=Cr(l,Wi())}return u&&(l="SCRIPT_PLACEHOLDER"),!a&&!u&&l&&i&&(l=n?n(l,e.parentElement):l.replace(/[\S]/g,"*")),{type:X.Text,textContent:l||"",isStyle:a,rootId:s}}function fg(e,t){const{doc:r,blockClass:i,blockSelector:n,inlineStylesheet:s,maskInputOptions:o={},maskInputFn:l,dataURLOptions:a={},inlineImages:u,recordCanvas:d,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:f}=t,g=lg(e,i,n),_=Jf(e);let m={};const S=e.attributes.length;for(let v=0;v<S;v++){const w=e.attributes[v];_o(_,w.name,w.value)||(m[w.name]=go(r,_,Ye(w.name),w.value))}if(_==="link"&&s){const v=Array.from(r.styleSheets).find(C=>C.href===e.href);let w=null;v&&(w=wr(v)),w&&(delete m.rel,delete m.href,m._cssText=Cr(w,v.href))}if(_==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const v=wr(e.sheet);v&&(m._cssText=Cr(v,Wi()))}if(_==="input"||_==="textarea"||_==="select"){const v=e.value,w=e.checked;m.type!=="radio"&&m.type!=="checkbox"&&m.type!=="submit"&&m.type!=="button"&&v?m.value=Gi({element:e,type:Vi(e),tagName:_,value:v,maskInputOptions:o,maskInputFn:l}):w&&(m.checked=w)}if(_==="option"&&(e.selected&&!o.select?m.selected=!0:delete m.selected),_==="canvas"&&d){if(e.__context==="2d")Qf(e)||(m.rr_dataURL=e.toDataURL(a.type,a.quality));else if(!("__context"in e)){const v=e.toDataURL(a.type,a.quality),w=document.createElement("canvas");w.width=e.width,w.height=e.height;const C=w.toDataURL(a.type,a.quality);v!==C&&(m.rr_dataURL=v)}}if(_==="img"&&u){it||(it=r.createElement("canvas"),cs=it.getContext("2d"));const v=e,w=v.crossOrigin;v.crossOrigin="anonymous";const C=()=>{v.removeEventListener("load",C);try{it.width=v.naturalWidth,it.height=v.naturalHeight,cs.drawImage(v,0,0),m.rr_dataURL=it.toDataURL(a.type,a.quality)}catch(Y){console.warn(`Cannot inline img src=${v.currentSrc}! Error: ${Y}`)}w?m.crossOrigin=w:v.removeAttribute("crossorigin")};v.complete&&v.naturalWidth!==0?C():v.addEventListener("load",C)}if(_==="audio"||_==="video"){const v=m;v.rr_mediaState=e.paused?"paused":"played",v.rr_mediaCurrentTime=e.currentTime,v.rr_mediaPlaybackRate=e.playbackRate,v.rr_mediaMuted=e.muted,v.rr_mediaLoop=e.loop,v.rr_mediaVolume=e.volume}if(p||(e.scrollLeft&&(m.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(m.rr_scrollTop=e.scrollTop)),g){const{width:v,height:w}=e.getBoundingClientRect();m={class:m.class,rr_width:`${v}px`,rr_height:`${w}px`}}_==="iframe"&&!h(m.src)&&(e.contentDocument||(m.rr_src=m.src),delete m.src);let b;try{customElements.get(_)&&(b=!0)}catch{}return{type:X.Element,tagName:_,attributes:m,childNodes:[],isSVG:ag(e)||void 0,needBlock:g,rootId:f,isCustom:b}}function L(e){return e==null?"":e.toLowerCase()}function gg(e,t){if(t.comment&&e.type===X.Comment)return!0;if(e.type===X.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&po(e.attributes.href)==="js"))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(L(e.attributes.name).match(/^msapplication-tile(image|color)$/)||L(e.attributes.name)==="application-name"||L(e.attributes.rel)==="icon"||L(e.attributes.rel)==="apple-touch-icon"||L(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&L(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(L(e.attributes.property).match(/^(og|twitter|fb):/)||L(e.attributes.name).match(/^(og|twitter):/)||L(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(L(e.attributes.name)==="robots"||L(e.attributes.name)==="googlebot"||L(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(L(e.attributes.name)==="author"||L(e.attributes.name)==="generator"||L(e.attributes.name)==="framework"||L(e.attributes.name)==="publisher"||L(e.attributes.name)==="progid"||L(e.attributes.property).match(/^article:/)||L(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(L(e.attributes.name)==="google-site-verification"||L(e.attributes.name)==="yandex-verification"||L(e.attributes.name)==="csrf-token"||L(e.attributes.name)==="p:domain_verify"||L(e.attributes.name)==="verify-v1"||L(e.attributes.name)==="verification"||L(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function at(e,t){const{doc:r,mirror:i,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:l,skipChild:a=!1,inlineStylesheet:u=!0,maskInputOptions:d={},maskTextFn:h,maskInputFn:p,slimDOMOptions:f,dataURLOptions:g={},inlineImages:_=!1,recordCanvas:m=!1,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:v=5e3,onStylesheetLoad:w,stylesheetLoadTimeout:C=5e3,keepIframeSrcFn:Y=()=>!1,newlyAddedElement:G=!1}=t;let{needsMask:N}=t,{preserveWhiteSpace:P=!0}=t;!N&&e.childNodes&&(N=mo(e,o,l,N===void 0));const le=dg(e,{doc:r,mirror:i,blockClass:n,blockSelector:s,needsMask:N,inlineStylesheet:u,maskInputOptions:d,maskTextFn:h,maskInputFn:p,dataURLOptions:g,inlineImages:_,recordCanvas:m,keepIframeSrcFn:Y,newlyAddedElement:G});if(!le)return console.warn(e,"not serialized"),null;let ce;i.hasNode(e)?ce=i.getId(e):gg(le,f)||!P&&le.type===X.Text&&!le.isStyle&&!le.textContent.replace(/^\s+|\s+$/gm,"").length?ce=zt:ce=fo();const R=Object.assign(le,{id:ce});if(i.add(e,R),ce===zt)return null;S&&S(e);let Fe=!a;if(R.type===X.Element){Fe=Fe&&!R.needBlock,delete R.needBlock;const ee=e.shadowRoot;ee&&Lt(ee)&&(R.isShadowHost=!0)}if((R.type===X.Document||R.type===X.Element)&&Fe){f.headWhitespace&&R.type===X.Element&&R.tagName==="head"&&(P=!1);const ee={doc:r,mirror:i,blockClass:n,blockSelector:s,needsMask:N,maskTextClass:o,maskTextSelector:l,skipChild:a,inlineStylesheet:u,maskInputOptions:d,maskTextFn:h,maskInputFn:p,slimDOMOptions:f,dataURLOptions:g,inlineImages:_,recordCanvas:m,preserveWhiteSpace:P,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:v,onStylesheetLoad:w,stylesheetLoadTimeout:C,keepIframeSrcFn:Y};if(!(R.type===X.Element&&R.tagName==="textarea"&&R.attributes.value!==void 0))for(const Ae of Array.from(e.childNodes)){const _e=at(Ae,ee);_e&&R.childNodes.push(_e)}if(jf(e)&&e.shadowRoot)for(const Ae of Array.from(e.shadowRoot.childNodes)){const _e=at(Ae,ee);_e&&(Lt(e.shadowRoot)&&(_e.isShadow=!0),R.childNodes.push(_e))}}return e.parentNode&&Dt(e.parentNode)&&Lt(e.parentNode)&&(R.isShadow=!0),R.type===X.Element&&R.tagName==="iframe"&&cg(e,()=>{const ee=e.contentDocument;if(ee&&b){const Ae=at(ee,{doc:ee,mirror:i,blockClass:n,blockSelector:s,needsMask:N,maskTextClass:o,maskTextSelector:l,skipChild:!1,inlineStylesheet:u,maskInputOptions:d,maskTextFn:h,maskInputFn:p,slimDOMOptions:f,dataURLOptions:g,inlineImages:_,recordCanvas:m,preserveWhiteSpace:P,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:v,onStylesheetLoad:w,stylesheetLoadTimeout:C,keepIframeSrcFn:Y});Ae&&b(e,Ae)}},v),R.type===X.Element&&R.tagName==="link"&&typeof R.attributes.rel=="string"&&(R.attributes.rel==="stylesheet"||R.attributes.rel==="preload"&&typeof R.attributes.href=="string"&&po(R.attributes.href)==="css")&&ug(e,()=>{if(w){const ee=at(e,{doc:r,mirror:i,blockClass:n,blockSelector:s,needsMask:N,maskTextClass:o,maskTextSelector:l,skipChild:!1,inlineStylesheet:u,maskInputOptions:d,maskTextFn:h,maskInputFn:p,slimDOMOptions:f,dataURLOptions:g,inlineImages:_,recordCanvas:m,preserveWhiteSpace:P,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:v,onStylesheetLoad:w,stylesheetLoadTimeout:C,keepIframeSrcFn:Y});ee&&w(e,ee)}},C),R}function _g(e,t){const{mirror:r=new ho,blockClass:i="rr-block",blockSelector:n=null,maskTextClass:s="rr-mask",maskTextSelector:o=null,inlineStylesheet:l=!0,inlineImages:a=!1,recordCanvas:u=!1,maskAllInputs:d=!1,maskTextFn:h,maskInputFn:p,slimDOM:f=!1,dataURLOptions:g,preserveWhiteSpace:_,onSerialize:m,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:v,stylesheetLoadTimeout:w,keepIframeSrcFn:C=()=>!1}=t||{};return at(e,{doc:e,mirror:r,blockClass:i,blockSelector:n,maskTextClass:s,maskTextSelector:o,skipChild:!1,inlineStylesheet:l,maskInputOptions:d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:d===!1?{password:!0}:d,maskTextFn:h,maskInputFn:p,slimDOMOptions:f===!0||f==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:f==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:f===!1?{}:f,dataURLOptions:g,inlineImages:a,recordCanvas:u,preserveWhiteSpace:_,onSerialize:m,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:v,stylesheetLoadTimeout:w,keepIframeSrcFn:C,newlyAddedElement:!1})}function ne(e,t,r=document){const i={capture:!0,passive:!0};return r.addEventListener(e,t,i),()=>r.removeEventListener(e,t,i)}const st=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let us={map:{},getId(){return console.error(st),-1},getNode(){return console.error(st),null},removeNodeFromMap(){console.error(st)},has(){return console.error(st),!1},reset(){console.error(st)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(us=new Proxy(us,{get(e,t,r){return t==="map"&&console.error(st),Reflect.get(e,t,r)}}));function qt(e,t,r={}){let i=null,n=0;return function(...s){const o=Date.now();!n&&r.leading===!1&&(n=o);const l=t-(o-n),a=this;l<=0||l>t?(i&&(clearTimeout(i),i=null),n=o,e.apply(a,s)):!i&&r.trailing!==!1&&(i=setTimeout(()=>{n=r.leading===!1?0:Date.now(),i=null,e.apply(a,s)},l))}}function jr(e,t,r,i,n=window){const s=n.Object.getOwnPropertyDescriptor(e,t);return n.Object.defineProperty(e,t,i?r:{set(o){setTimeout(()=>{r.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>jr(e,t,s||{},!0)}function Tt(e,t,r){try{if(!(t in e))return()=>{};const i=e[t],n=r(i);return typeof n=="function"&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:i}})),e[t]=n,()=>{e[t]=i}}catch{return()=>{}}}let Tr=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Tr=()=>new Date().getTime());function yo(e){var t,r,i,n,s,o;const l=e.document;return{left:l.scrollingElement?l.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:(l==null?void 0:l.documentElement.scrollLeft)||((r=(t=l==null?void 0:l.body)===null||t===void 0?void 0:t.parentElement)===null||r===void 0?void 0:r.scrollLeft)||((i=l==null?void 0:l.body)===null||i===void 0?void 0:i.scrollLeft)||0,top:l.scrollingElement?l.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:(l==null?void 0:l.documentElement.scrollTop)||((s=(n=l==null?void 0:l.body)===null||n===void 0?void 0:n.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=l==null?void 0:l.body)===null||o===void 0?void 0:o.scrollTop)||0}}function vo(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function bo(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function So(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function se(e,t,r,i){if(!e)return!1;const n=So(e);if(!n)return!1;try{if(typeof t=="string"){if(n.classList.contains(t)||i&&n.closest("."+t)!==null)return!0}else if(Ir(n,t,i))return!0}catch{}return!!(r&&(n.matches(r)||i&&n.closest(r)!==null))}function mg(e,t){return t.getId(e)!==-1}function ui(e,t){return t.getId(e)===zt}function wo(e,t){if(Dt(e))return!1;const r=t.getId(e);return t.has(r)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?wo(e.parentNode,t):!0:!0}function Ai(e){return!!e.changedTouches}function yg(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let r=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function Co(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function Io(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function Ei(e){return!!(e!=null&&e.shadowRoot)}class vg{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var r;return(r=this.styleIDMap.get(t))!==null&&r!==void 0?r:-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let i;return r===void 0?i=this.id++:i=r,this.styleIDMap.set(t,i),this.idStyleMap.set(i,t),i}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function To(e){var t,r;let i=null;return((r=(t=e.getRootNode)===null||t===void 0?void 0:t.call(e))===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(i=e.getRootNode().host),i}function bg(e){let t=e,r;for(;r=To(t);)t=r;return t}function Sg(e){const t=e.ownerDocument;if(!t)return!1;const r=bg(e);return t.contains(r)}function Ao(e){const t=e.ownerDocument;return t?t.contains(e)||Sg(e):!1}var M=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(M||{}),x=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(x||{}),oe=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(oe||{}),Se=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Se||{}),ft=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ft||{});function ds(e){return"__ln"in e}class wg{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let i=0;i<t;i++)r=(r==null?void 0:r.next)||null;return r}addNode(t){const r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&ds(t.previousSibling)){const i=t.previousSibling.__ln.next;r.next=i,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,i&&(i.previous=r)}else if(t.nextSibling&&ds(t.nextSibling)&&t.nextSibling.__ln.previous){const i=t.nextSibling.__ln.previous;r.previous=i,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,i&&(i.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){const r=t.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const hs=(e,t)=>`${e}@${t}`;class Cg{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],r=new Set,i=new wg,n=a=>{let u=a,d=zt;for(;d===zt;)u=u&&u.nextSibling,d=u&&this.mirror.getId(u);return d},s=a=>{if(!a.parentNode||!Ao(a)||a.parentNode.tagName==="TEXTAREA")return;const u=Dt(a.parentNode)?this.mirror.getId(To(a)):this.mirror.getId(a.parentNode),d=n(a);if(u===-1||d===-1)return i.addNode(a);const h=at(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:p=>{Co(p,this.mirror)&&this.iframeManager.addIframe(p),Io(p,this.mirror)&&this.stylesheetManager.trackLinkElement(p),Ei(a)&&this.shadowDomManager.addShadowRoot(a.shadowRoot,this.doc)},onIframeLoad:(p,f)=>{this.iframeManager.attachIframe(p,f),this.shadowDomManager.observeAttachShadow(p)},onStylesheetLoad:(p,f)=>{this.stylesheetManager.attachLinkElement(p,f)}});h&&(t.push({parentId:u,nextId:d,node:h}),r.add(h.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const a of this.movedSet)ps(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||s(a);for(const a of this.addedSet)!fs(this.droppedSet,a)&&!ps(this.removes,a,this.mirror)||fs(this.movedSet,a)?s(a):this.droppedSet.add(a);let o=null;for(;i.length;){let a=null;if(o){const u=this.mirror.getId(o.value.parentNode),d=n(o.value);u!==-1&&d!==-1&&(a=o)}if(!a){let u=i.tail;for(;u;){const d=u;if(u=u.previous,d){const h=this.mirror.getId(d.value.parentNode);if(n(d.value)===-1)continue;if(h!==-1){a=d;break}else{const f=d.value;if(f.parentNode&&f.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const g=f.parentNode.host;if(this.mirror.getId(g)!==-1){a=d;break}}}}}}if(!a){for(;i.head;)i.removeNode(i.head.value);break}o=a.previous,i.removeNode(a.value),s(a.value)}const l={texts:this.texts.map(a=>{const u=a.node;return u.parentNode&&u.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(u.parentNode),{id:this.mirror.getId(u),value:a.value}}).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>{const{attributes:u}=a;if(typeof u.style=="string"){const d=JSON.stringify(a.styleDiff),h=JSON.stringify(a._unchangedStyles);d.length<u.style.length&&(d+h).split("var(").length===u.style.split("var(").length&&(u.style=a.styleDiff)}return{id:this.mirror.getId(a.node),attributes:u}}).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:t};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))},this.genTextAreaValueMutation=t=>{let r=this.attributeMap.get(t);r||(r={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(r),this.attributeMap.set(t,r)),r.attributes.value=Array.from(t.childNodes,i=>i.textContent||"").join("")},this.processMutation=t=>{if(!ui(t.target,this.mirror))switch(t.type){case"characterData":{const r=t.target.textContent;!se(t.target,this.blockClass,this.blockSelector,!1)&&r!==t.oldValue&&this.texts.push({value:mo(t.target,this.maskTextClass,this.maskTextSelector,!0)&&r?this.maskTextFn?this.maskTextFn(r,So(t.target)):r.replace(/[\S]/g,"*"):r,node:t.target});break}case"attributes":{const r=t.target;let i=t.attributeName,n=t.target.getAttribute(i);if(i==="value"){const o=Vi(r);n=Gi({element:r,maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:o,value:n,maskInputFn:this.maskInputFn})}if(se(t.target,this.blockClass,this.blockSelector,!1)||n===t.oldValue)return;let s=this.attributeMap.get(t.target);if(r.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(n))if(!r.contentDocument)i="rr_src";else return;if(s||(s={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(t.target,s)),i==="type"&&r.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!_o(r.tagName,i)&&(s.attributes[i]=go(this.doc,Ye(r.tagName),Ye(i),n),i==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}const o=this.unattachedDoc.createElement("span");t.oldValue&&o.setAttribute("style",t.oldValue);for(const l of Array.from(r.style)){const a=r.style.getPropertyValue(l),u=r.style.getPropertyPriority(l);a!==o.style.getPropertyValue(l)||u!==o.style.getPropertyPriority(l)?u===""?s.styleDiff[l]=a:s.styleDiff[l]=[a,u]:s._unchangedStyles[l]=[a,u]}for(const l of Array.from(o.style))r.style.getPropertyValue(l)===""&&(s.styleDiff[l]=!1)}break}case"childList":{if(se(t.target,this.blockClass,this.blockSelector,!0))return;if(t.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(t.target);return}t.addedNodes.forEach(r=>this.genAdds(r,t.target)),t.removedNodes.forEach(r=>{const i=this.mirror.getId(r),n=Dt(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);se(t.target,this.blockClass,this.blockSelector,!1)||ui(r,this.mirror)||!mg(r,this.mirror)||(this.addedSet.has(r)?(Oi(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(t.target)&&i===-1||wo(t.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[hs(i,n)]?Oi(this.movedSet,r):this.removes.push({parentId:n,id:i,isShadow:Dt(t.target)&&Lt(t.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(ui(t,this.mirror))return;this.movedSet.add(t);let i=null;r&&this.mirror.hasNode(r)&&(i=this.mirror.getId(r)),i&&i!==-1&&(this.movedMap[hs(this.mirror.getId(t),i)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);se(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach(i=>this.genAdds(i)),Ei(t)&&t.shadowRoot.childNodes.forEach(i=>{this.processedNodeManager.add(i,this),this.genAdds(i,t)}))}}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Oi(e,t){e.delete(t),t.childNodes.forEach(r=>Oi(e,r))}function ps(e,t,r){return e.length===0?!1:Eo(e,t,r)}function Eo(e,t,r){const{parentNode:i}=t;if(!i)return!1;const n=r.getId(i);return e.some(s=>s.id===n)?!0:Eo(e,i,r)}function fs(e,t){return e.size===0?!1:Oo(e,t)}function Oo(e,t){const{parentNode:r}=t;return r?e.has(r)?!0:Oo(e,r):!1}let Nt;function Ig(e){Nt=e}function Tg(){Nt=void 0}const k=e=>Nt?(...r)=>{try{return e(...r)}catch(i){if(Nt&&Nt(i)===!0)return;throw i}}:e,Qe=[];function Xt(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function xo(e,t){var r,i;const n=new Cg;Qe.push(n),n.init(e);let s=window.MutationObserver||window.__rrMutationObserver;const o=(i=(r=window==null?void 0:window.Zone)===null||r===void 0?void 0:r.__symbol__)===null||i===void 0?void 0:i.call(r,"MutationObserver");o&&window[o]&&(s=window[o]);const l=new s(k(n.processMutations.bind(n)));return l.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function Ag({mousemoveCb:e,sampling:t,doc:r,mirror:i}){if(t.mousemove===!1)return()=>{};const n=typeof t.mousemove=="number"?t.mousemove:50,s=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let o=[],l;const a=qt(k(h=>{const p=Date.now()-l;e(o.map(f=>(f.timeOffset-=p,f)),h),o=[],l=null}),s),u=k(qt(k(h=>{const p=Xt(h),{clientX:f,clientY:g}=Ai(h)?h.changedTouches[0]:h;l||(l=Tr()),o.push({x:f,y:g,id:i.getId(p),timeOffset:Tr()-l}),a(typeof DragEvent<"u"&&h instanceof DragEvent?x.Drag:h instanceof MouseEvent?x.MouseMove:x.TouchMove)}),n,{trailing:!1})),d=[ne("mousemove",u,r),ne("touchmove",u,r),ne("drag",u,r)];return k(()=>{d.forEach(h=>h())})}function Eg({mouseInteractionCb:e,doc:t,mirror:r,blockClass:i,blockSelector:n,sampling:s}){if(s.mouseInteraction===!1)return()=>{};const o=s.mouseInteraction===!0||s.mouseInteraction===void 0?{}:s.mouseInteraction,l=[];let a=null;const u=d=>h=>{const p=Xt(h);if(se(p,i,n,!0))return;let f=null,g=d;if("pointerType"in h){switch(h.pointerType){case"mouse":f=Se.Mouse;break;case"touch":f=Se.Touch;break;case"pen":f=Se.Pen;break}f===Se.Touch?oe[d]===oe.MouseDown?g="TouchStart":oe[d]===oe.MouseUp&&(g="TouchEnd"):Se.Pen}else Ai(h)&&(f=Se.Touch);f!==null?(a=f,(g.startsWith("Touch")&&f===Se.Touch||g.startsWith("Mouse")&&f===Se.Mouse)&&(f=null)):oe[d]===oe.Click&&(f=a,a=null);const _=Ai(h)?h.changedTouches[0]:h;if(!_)return;const m=r.getId(p),{clientX:S,clientY:b}=_;k(e)(Object.assign({type:oe[g],id:m,x:S,y:b},f!==null&&{pointerType:f}))};return Object.keys(oe).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&o[d]!==!1).forEach(d=>{let h=Ye(d);const p=u(d);if(window.PointerEvent)switch(oe[d]){case oe.MouseDown:case oe.MouseUp:h=h.replace("mouse","pointer");break;case oe.TouchStart:case oe.TouchEnd:return}l.push(ne(h,p,t))}),k(()=>{l.forEach(d=>d())})}function ko({scrollCb:e,doc:t,mirror:r,blockClass:i,blockSelector:n,sampling:s}){const o=k(qt(k(l=>{const a=Xt(l);if(!a||se(a,i,n,!0))return;const u=r.getId(a);if(a===t&&t.defaultView){const d=yo(t.defaultView);e({id:u,x:d.left,y:d.top})}else e({id:u,x:a.scrollLeft,y:a.scrollTop})}),s.scroll||100));return ne("scroll",o,t)}function Og({viewportResizeCb:e},{win:t}){let r=-1,i=-1;const n=k(qt(k(()=>{const s=vo(),o=bo();(r!==s||i!==o)&&(e({width:Number(o),height:Number(s)}),r=s,i=o)}),200));return ne("resize",n,t)}const xg=["INPUT","TEXTAREA","SELECT"],gs=new WeakMap;function kg({inputCb:e,doc:t,mirror:r,blockClass:i,blockSelector:n,ignoreClass:s,ignoreSelector:o,maskInputOptions:l,maskInputFn:a,sampling:u,userTriggeredOnInput:d}){function h(b){let v=Xt(b);const w=b.isTrusted,C=v&&v.tagName;if(v&&C==="OPTION"&&(v=v.parentElement),!v||!C||xg.indexOf(C)<0||se(v,i,n,!0)||v.classList.contains(s)||o&&v.matches(o))return;let Y=v.value,G=!1;const N=Vi(v)||"";N==="radio"||N==="checkbox"?G=v.checked:(l[C.toLowerCase()]||l[N])&&(Y=Gi({element:v,maskInputOptions:l,tagName:C,type:N,value:Y,maskInputFn:a})),p(v,d?{text:Y,isChecked:G,userTriggered:w}:{text:Y,isChecked:G});const P=v.name;N==="radio"&&P&&G&&t.querySelectorAll(`input[type="radio"][name="${P}"]`).forEach(le=>{if(le!==v){const ce=le.value;p(le,d?{text:ce,isChecked:!G,userTriggered:!1}:{text:ce,isChecked:!G})}})}function p(b,v){const w=gs.get(b);if(!w||w.text!==v.text||w.isChecked!==v.isChecked){gs.set(b,v);const C=r.getId(b);k(e)(Object.assign(Object.assign({},v),{id:C}))}}const g=(u.input==="last"?["change"]:["input","change"]).map(b=>ne(b,k(h),t)),_=t.defaultView;if(!_)return()=>{g.forEach(b=>b())};const m=_.Object.getOwnPropertyDescriptor(_.HTMLInputElement.prototype,"value"),S=[[_.HTMLInputElement.prototype,"value"],[_.HTMLInputElement.prototype,"checked"],[_.HTMLSelectElement.prototype,"value"],[_.HTMLTextAreaElement.prototype,"value"],[_.HTMLSelectElement.prototype,"selectedIndex"],[_.HTMLOptionElement.prototype,"selected"]];return m&&m.set&&g.push(...S.map(b=>jr(b[0],b[1],{set(){k(h)({target:this,isTrusted:!1})}},!1,_))),k(()=>{g.forEach(b=>b())})}function Ar(e){const t=[];function r(i,n){if(nr("CSSGroupingRule")&&i.parentRule instanceof CSSGroupingRule||nr("CSSMediaRule")&&i.parentRule instanceof CSSMediaRule||nr("CSSSupportsRule")&&i.parentRule instanceof CSSSupportsRule||nr("CSSConditionRule")&&i.parentRule instanceof CSSConditionRule){const o=Array.from(i.parentRule.cssRules).indexOf(i);n.unshift(o)}else if(i.parentStyleSheet){const o=Array.from(i.parentStyleSheet.cssRules).indexOf(i);n.unshift(o)}return n}return r(e,t)}function Ee(e,t,r){let i,n;return e?(e.ownerNode?i=t.getId(e.ownerNode):n=r.getId(e),{styleId:n,id:i}):{}}function Mg({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};const n=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(n,{apply:k((d,h,p)=>{const[f,g]=p,{id:_,styleId:m}=Ee(h,t,r.styleMirror);return(_&&_!==-1||m&&m!==-1)&&e({id:_,styleId:m,adds:[{rule:f,index:g}]}),d.apply(h,p)})});const s=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:k((d,h,p)=>{const[f]=p,{id:g,styleId:_}=Ee(h,t,r.styleMirror);return(g&&g!==-1||_&&_!==-1)&&e({id:g,styleId:_,removes:[{index:f}]}),d.apply(h,p)})});let o;i.CSSStyleSheet.prototype.replace&&(o=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:k((d,h,p)=>{const[f]=p,{id:g,styleId:_}=Ee(h,t,r.styleMirror);return(g&&g!==-1||_&&_!==-1)&&e({id:g,styleId:_,replace:f}),d.apply(h,p)})}));let l;i.CSSStyleSheet.prototype.replaceSync&&(l=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=new Proxy(l,{apply:k((d,h,p)=>{const[f]=p,{id:g,styleId:_}=Ee(h,t,r.styleMirror);return(g&&g!==-1||_&&_!==-1)&&e({id:g,styleId:_,replaceSync:f}),d.apply(h,p)})}));const a={};sr("CSSGroupingRule")?a.CSSGroupingRule=i.CSSGroupingRule:(sr("CSSMediaRule")&&(a.CSSMediaRule=i.CSSMediaRule),sr("CSSConditionRule")&&(a.CSSConditionRule=i.CSSConditionRule),sr("CSSSupportsRule")&&(a.CSSSupportsRule=i.CSSSupportsRule));const u={};return Object.entries(a).forEach(([d,h])=>{u[d]={insertRule:h.prototype.insertRule,deleteRule:h.prototype.deleteRule},h.prototype.insertRule=new Proxy(u[d].insertRule,{apply:k((p,f,g)=>{const[_,m]=g,{id:S,styleId:b}=Ee(f.parentStyleSheet,t,r.styleMirror);return(S&&S!==-1||b&&b!==-1)&&e({id:S,styleId:b,adds:[{rule:_,index:[...Ar(f),m||0]}]}),p.apply(f,g)})}),h.prototype.deleteRule=new Proxy(u[d].deleteRule,{apply:k((p,f,g)=>{const[_]=g,{id:m,styleId:S}=Ee(f.parentStyleSheet,t,r.styleMirror);return(m&&m!==-1||S&&S!==-1)&&e({id:m,styleId:S,removes:[{index:[...Ar(f),_]}]}),p.apply(f,g)})})}),k(()=>{i.CSSStyleSheet.prototype.insertRule=n,i.CSSStyleSheet.prototype.deleteRule=s,o&&(i.CSSStyleSheet.prototype.replace=o),l&&(i.CSSStyleSheet.prototype.replaceSync=l),Object.entries(a).forEach(([d,h])=>{h.prototype.insertRule=u[d].insertRule,h.prototype.deleteRule=u[d].deleteRule})})}function Mo({mirror:e,stylesheetManager:t},r){var i,n,s;let o=null;r.nodeName==="#document"?o=e.getId(r):o=e.getId(r.host);const l=r.nodeName==="#document"?(i=r.defaultView)===null||i===void 0?void 0:i.Document:(s=(n=r.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||s===void 0?void 0:s.ShadowRoot,a=l!=null&&l.prototype?Object.getOwnPropertyDescriptor(l==null?void 0:l.prototype,"adoptedStyleSheets"):void 0;return o===null||o===-1||!l||!a?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get(){var u;return(u=a.get)===null||u===void 0?void 0:u.call(this)},set(u){var d;const h=(d=a.set)===null||d===void 0?void 0:d.call(this,u);if(o!==null&&o!==-1)try{t.adoptStyleSheets(u,o)}catch{}return h}}),k(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get:a.get,set:a.set})}))}function Rg({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:i},{win:n}){const s=n.CSSStyleDeclaration.prototype.setProperty;n.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:k((l,a,u)=>{var d;const[h,p,f]=u;if(r.has(h))return s.apply(a,[h,p,f]);const{id:g,styleId:_}=Ee((d=a.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,t,i.styleMirror);return(g&&g!==-1||_&&_!==-1)&&e({id:g,styleId:_,set:{property:h,value:p,priority:f},index:Ar(a.parentRule)}),l.apply(a,u)})});const o=n.CSSStyleDeclaration.prototype.removeProperty;return n.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:k((l,a,u)=>{var d;const[h]=u;if(r.has(h))return o.apply(a,[h]);const{id:p,styleId:f}=Ee((d=a.parentRule)===null||d===void 0?void 0:d.parentStyleSheet,t,i.styleMirror);return(p&&p!==-1||f&&f!==-1)&&e({id:p,styleId:f,remove:{property:h},index:Ar(a.parentRule)}),l.apply(a,u)})}),k(()=>{n.CSSStyleDeclaration.prototype.setProperty=s,n.CSSStyleDeclaration.prototype.removeProperty=o})}function $g({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:i,sampling:n,doc:s}){const o=k(a=>qt(k(u=>{const d=Xt(u);if(!d||se(d,t,r,!0))return;const{currentTime:h,volume:p,muted:f,playbackRate:g,loop:_}=d;e({type:a,id:i.getId(d),currentTime:h,volume:p,muted:f,playbackRate:g,loop:_})}),n.media||500)),l=[ne("play",o(0),s),ne("pause",o(1),s),ne("seeked",o(2),s),ne("volumechange",o(3),s),ne("ratechange",o(4),s)];return k(()=>{l.forEach(a=>a())})}function Dg({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const i=[],n=new WeakMap,s=r.FontFace;r.FontFace=function(a,u,d){const h=new s(a,u,d);return n.set(h,{family:a,buffer:typeof u!="string",descriptors:d,fontSource:typeof u=="string"?u:JSON.stringify(Array.from(new Uint8Array(u)))}),h};const o=Tt(t.fonts,"add",function(l){return function(a){return setTimeout(k(()=>{const u=n.get(a);u&&(e(u),n.delete(a))}),0),l.apply(this,[a])}});return i.push(()=>{r.FontFace=s}),i.push(o),k(()=>{i.forEach(l=>l())})}function Lg(e){const{doc:t,mirror:r,blockClass:i,blockSelector:n,selectionCb:s}=e;let o=!0;const l=k(()=>{const a=t.getSelection();if(!a||o&&(a!=null&&a.isCollapsed))return;o=a.isCollapsed||!1;const u=[],d=a.rangeCount||0;for(let h=0;h<d;h++){const p=a.getRangeAt(h),{startContainer:f,startOffset:g,endContainer:_,endOffset:m}=p;se(f,i,n,!0)||se(_,i,n,!0)||u.push({start:r.getId(f),startOffset:g,end:r.getId(_),endOffset:m})}s({ranges:u})});return l(),ne("selectionchange",l)}function Ng({doc:e,customElementCb:t}){const r=e.defaultView;return!r||!r.customElements?()=>{}:Tt(r.customElements,"define",function(n){return function(s,o,l){try{t({define:{name:s}})}catch{console.warn(`Custom element callback failed for ${s}`)}return n.apply(this,[s,o,l])}})}function Pg(e,t){const{mutationCb:r,mousemoveCb:i,mouseInteractionCb:n,scrollCb:s,viewportResizeCb:o,inputCb:l,mediaInteractionCb:a,styleSheetRuleCb:u,styleDeclarationCb:d,canvasMutationCb:h,fontCb:p,selectionCb:f,customElementCb:g}=e;e.mutationCb=(..._)=>{t.mutation&&t.mutation(..._),r(..._)},e.mousemoveCb=(..._)=>{t.mousemove&&t.mousemove(..._),i(..._)},e.mouseInteractionCb=(..._)=>{t.mouseInteraction&&t.mouseInteraction(..._),n(..._)},e.scrollCb=(..._)=>{t.scroll&&t.scroll(..._),s(..._)},e.viewportResizeCb=(..._)=>{t.viewportResize&&t.viewportResize(..._),o(..._)},e.inputCb=(..._)=>{t.input&&t.input(..._),l(..._)},e.mediaInteractionCb=(..._)=>{t.mediaInteaction&&t.mediaInteaction(..._),a(..._)},e.styleSheetRuleCb=(..._)=>{t.styleSheetRule&&t.styleSheetRule(..._),u(..._)},e.styleDeclarationCb=(..._)=>{t.styleDeclaration&&t.styleDeclaration(..._),d(..._)},e.canvasMutationCb=(..._)=>{t.canvasMutation&&t.canvasMutation(..._),h(..._)},e.fontCb=(..._)=>{t.font&&t.font(..._),p(..._)},e.selectionCb=(..._)=>{t.selection&&t.selection(..._),f(..._)},e.customElementCb=(..._)=>{t.customElement&&t.customElement(..._),g(..._)}}function Ug(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};Pg(e,t);let i;e.recordDOM&&(i=xo(e,e.doc));const n=Ag(e),s=Eg(e),o=ko(e),l=Og(e,{win:r}),a=kg(e),u=$g(e);let d=()=>{},h=()=>{},p=()=>{},f=()=>{};e.recordDOM&&(d=Mg(e,{win:r}),h=Mo(e,e.doc),p=Rg(e,{win:r}),e.collectFonts&&(f=Dg(e)));const g=Lg(e),_=Ng(e),m=[];for(const S of e.plugins)m.push(S.observer(S.callback,r,S.options));return k(()=>{Qe.forEach(S=>S.reset()),i==null||i.disconnect(),n(),s(),o(),l(),a(),u(),d(),h(),p(),f(),g(),_(),m.forEach(S=>S())})}function nr(e){return typeof window[e]<"u"}function sr(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class _s{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,r,i,n){const s=i||this.getIdToRemoteIdMap(t),o=n||this.getRemoteIdToIdMap(t);let l=s.get(r);return l||(l=this.generateIdFn(),s.set(r,l),o.set(l,r)),l}getIds(t,r){const i=this.getIdToRemoteIdMap(t),n=this.getRemoteIdToIdMap(t);return r.map(s=>this.getId(t,s,i,n))}getRemoteId(t,r,i){const n=i||this.getRemoteIdToIdMap(t);if(typeof r!="number")return r;const s=n.get(r);return s||-1}getRemoteIds(t,r){const i=this.getRemoteIdToIdMap(t);return r.map(n=>this.getRemoteId(t,n,i))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}}class Fg{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new _s(fo),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new _s(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var i;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(i=this.loadListener)===null||i===void 0||i.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;const n=this.crossOriginIframeMap.get(t.source);if(!n)return;const s=this.transformCrossOriginEvent(n,r.data.event);s&&this.wrappedEmit(s,r.data.isCheckout)}transformCrossOriginEvent(t,r){var i;switch(r.type){case M.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);const n=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,n),this.patchRootIdOnNode(r.data.node,n),{timestamp:r.timestamp,type:M.IncrementalSnapshot,data:{source:x.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case M.Meta:case M.Load:case M.DomContentLoaded:return!1;case M.Plugin:return r;case M.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case M.IncrementalSnapshot:switch(r.data.source){case x.Mutation:return r.data.adds.forEach(n=>{this.replaceIds(n,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(n.node,t);const s=this.crossOriginIframeRootIdMap.get(t);s&&this.patchRootIdOnNode(n.node,s)}),r.data.removes.forEach(n=>{this.replaceIds(n,t,["parentId","id"])}),r.data.attributes.forEach(n=>{this.replaceIds(n,t,["id"])}),r.data.texts.forEach(n=>{this.replaceIds(n,t,["id"])}),r;case x.Drag:case x.TouchMove:case x.MouseMove:return r.data.positions.forEach(n=>{this.replaceIds(n,t,["id"])}),r;case x.ViewportResize:return!1;case x.MediaInteraction:case x.MouseInteraction:case x.Scroll:case x.CanvasMutation:case x.Input:return this.replaceIds(r.data,t,["id"]),r;case x.StyleSheetRule:case x.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case x.Font:return r;case x.Selection:return r.data.ranges.forEach(n=>{this.replaceIds(n,t,["start","end"])}),r;case x.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(i=r.data.styles)===null||i===void 0||i.forEach(n=>{this.replaceStyleIds(n,t,["styleId"])}),r}}return!1}replace(t,r,i,n){for(const s of n)!Array.isArray(r[s])&&typeof r[s]!="number"||(Array.isArray(r[s])?r[s]=t.getIds(i,r[s]):r[s]=t.getId(i,r[s]));return r}replaceIds(t,r,i){return this.replace(this.crossOriginIframeMirror,t,r,i)}replaceStyleIds(t,r,i){return this.replace(this.crossOriginIframeStyleMirror,t,r,i)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(i=>{this.replaceIdOnNode(i,r)})}patchRootIdOnNode(t,r){t.type!==X.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(i=>{this.patchRootIdOnNode(i,r)})}}class Hg{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!Lt(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);const i=xo(Object.assign(Object.assign({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push(()=>i.disconnect()),this.restoreHandlers.push(ko(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(Mo({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){const i=this;this.restoreHandlers.push(Tt(t.prototype,"attachShadow",function(n){return function(s){const o=n.call(this,s);return this.shadowRoot&&Ao(this)&&i.addShadowRoot(this.shadowRoot,r),o}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Bg(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function jg(e,t,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(i.next(d))}catch(h){o(h)}}function a(d){try{u(i.throw(d))}catch(h){o(h)}}function u(d){d.done?s(d.value):n(d.value).then(l,a)}u((i=i.apply(e,[])).next())})}var lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zg=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var or=0;or<lt.length;or++)zg[lt.charCodeAt(or)]=or;var qg=function(e){var t=new Uint8Array(e),r,i=t.length,n="";for(r=0;r<i;r+=3)n+=lt[t[r]>>2],n+=lt[(t[r]&3)<<4|t[r+1]>>4],n+=lt[(t[r+1]&15)<<2|t[r+2]>>6],n+=lt[t[r+2]&63];return i%3===2?n=n.substring(0,n.length-1)+"=":i%3===1&&(n=n.substring(0,n.length-2)+"=="),n};const ms=new Map;function Gg(e,t){let r=ms.get(e);return r||(r=new Map,ms.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const Ro=(e,t,r)=>{if(!e||!(Do(e,t)||typeof e=="object"))return;const i=e.constructor.name,n=Gg(r,i);let s=n.indexOf(e);return s===-1&&(s=n.length,n.push(e)),s};function ur(e,t,r){if(e instanceof Array)return e.map(i=>ur(i,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const i=e.constructor.name,n=qg(e);return{rr_type:i,base64:n}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[ur(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const i=e.constructor.name,{src:n}=e;return{rr_type:i,src:n}}else if(e instanceof HTMLCanvasElement){const i="HTMLImageElement",n=e.toDataURL();return{rr_type:i,src:n}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[ur(e.data,t,r),e.width,e.height]};if(Do(e,t)||typeof e=="object"){const i=e.constructor.name,n=Ro(e,t,r);return{rr_type:i,index:n}}}}return e}const $o=(e,t,r)=>e.map(i=>ur(i,t,r)),Do=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(n=>typeof t[n]=="function").find(n=>e instanceof t[n]);function Vg(e,t,r,i){const n=[],s=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const o of s)try{if(typeof t.CanvasRenderingContext2D.prototype[o]!="function")continue;const l=Tt(t.CanvasRenderingContext2D.prototype,o,function(a){return function(...u){return se(this.canvas,r,i,!0)||setTimeout(()=>{const d=$o(u,t,this);e(this.canvas,{type:ft["2D"],property:o,args:d})},0),a.apply(this,u)}});n.push(l)}catch{const a=jr(t.CanvasRenderingContext2D.prototype,o,{set(u){e(this.canvas,{type:ft["2D"],property:o,args:[u],setter:!0})}});n.push(a)}return()=>{n.forEach(o=>o())}}function Wg(e){return e==="experimental-webgl"?"webgl":e}function ys(e,t,r,i){const n=[];try{const s=Tt(e.HTMLCanvasElement.prototype,"getContext",function(o){return function(l,...a){if(!se(this,t,r,!0)){const u=Wg(l);if("__context"in this||(this.__context=u),i&&["webgl","webgl2"].includes(u))if(a[0]&&typeof a[0]=="object"){const d=a[0];d.preserveDrawingBuffer||(d.preserveDrawingBuffer=!0)}else a.splice(0,1,{preserveDrawingBuffer:!0})}return o.apply(this,[l,...a])}});n.push(s)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{n.forEach(s=>s())}}function vs(e,t,r,i,n,s,o){const l=[],a=Object.getOwnPropertyNames(e);for(const u of a)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(u))try{if(typeof e[u]!="function")continue;const d=Tt(e,u,function(h){return function(...p){const f=h.apply(this,p);if(Ro(f,o,this),"tagName"in this.canvas&&!se(this.canvas,i,n,!0)){const g=$o(p,o,this),_={type:t,property:u,args:g};r(this.canvas,_)}return f}});l.push(d)}catch{const h=jr(e,u,{set(p){r(this.canvas,{type:t,property:u,args:[p],setter:!0})}});l.push(h)}return l}function Kg(e,t,r,i,n){const s=[];return s.push(...vs(t.WebGLRenderingContext.prototype,ft.WebGL,e,r,i,n,t)),typeof t.WebGL2RenderingContext<"u"&&s.push(...vs(t.WebGL2RenderingContext.prototype,ft.WebGL2,e,r,i,n,t)),()=>{s.forEach(o=>o())}}function Qg(e,t){var r=e.toString(),i=r.split(`
`);i.pop(),i.shift();for(var n=i[0].search(/\S/),s=/(['"])__worker_loader_strict__(['"])/g,o=0,l=i.length;o<l;++o)i[o]=i[o].substring(n).replace(s,"$1use strict$2")+`
`;return i}function Xg(e,t){var r=Qg(e),i=new Blob(r,{type:"application/javascript"});return URL.createObjectURL(i)}function Yg(e,t){var r;return function(n){return r=r||Xg(e),new Worker(r,n)}}var Jg=Yg(function(){(function(){"__worker_loader_strict__";/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(u,d,h,p){function f(g){return g instanceof h?g:new h(function(_){_(g)})}return new(h||(h=Promise))(function(g,_){function m(v){try{b(p.next(v))}catch(w){_(w)}}function S(v){try{b(p.throw(v))}catch(w){_(w)}}function b(v){v.done?g(v.value):f(v.value).then(m,S)}b((p=p.apply(u,[])).next())})}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=typeof Uint8Array>"u"?[]:new Uint8Array(256),i=0;i<t.length;i++)r[t.charCodeAt(i)]=i;var n=function(u){var d=new Uint8Array(u),h,p=d.length,f="";for(h=0;h<p;h+=3)f+=t[d[h]>>2],f+=t[(d[h]&3)<<4|d[h+1]>>4],f+=t[(d[h+1]&15)<<2|d[h+2]>>6],f+=t[d[h+2]&63];return p%3===2?f=f.substring(0,f.length-1)+"=":p%3===1&&(f=f.substring(0,f.length-2)+"=="),f};const s=new Map,o=new Map;function l(u,d,h){return e(this,void 0,void 0,function*(){const p=`${u}-${d}`;if("OffscreenCanvas"in globalThis){if(o.has(p))return o.get(p);const f=new OffscreenCanvas(u,d);f.getContext("2d");const _=yield(yield f.convertToBlob(h)).arrayBuffer(),m=n(_);return o.set(p,m),m}else return""})}const a=self;a.onmessage=function(u){return e(this,void 0,void 0,function*(){if("OffscreenCanvas"in globalThis){const{id:d,bitmap:h,width:p,height:f,dataURLOptions:g}=u.data,_=l(p,f,g),m=new OffscreenCanvas(p,f);m.getContext("2d").drawImage(h,0,0),h.close();const b=yield m.convertToBlob(g),v=b.type,w=yield b.arrayBuffer(),C=n(w);if(!s.has(d)&&(yield _)===C)return s.set(d,C),a.postMessage({id:d});if(s.get(d)===C)return a.postMessage({id:d});a.postMessage({id:d,type:v,base64:C,width:p,height:f}),s.set(d,C)}else return a.postMessage({id:u.data.id})})}})()});class Zg{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(a,u)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(a)||this.pendingCanvasMutations.set(a,[]),this.pendingCanvasMutations.get(a).push(u)};const{sampling:r="all",win:i,blockClass:n,blockSelector:s,recordCanvas:o,dataURLOptions:l}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,o&&r==="all"&&this.initCanvasMutationObserver(i,n,s),o&&typeof r=="number"&&this.initCanvasFPSObserver(r,i,n,s,{dataURLOptions:l})}initCanvasFPSObserver(t,r,i,n,s){const o=ys(r,i,n,!0),l=new Map,a=new Jg;a.onmessage=g=>{const{id:_}=g.data;if(l.set(_,!1),!("base64"in g.data))return;const{base64:m,type:S,width:b,height:v}=g.data;this.mutationCb({id:_,type:ft["2D"],commands:[{property:"clearRect",args:[0,0,b,v]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:m}],type:S}]},0,0]}]})};const u=1e3/t;let d=0,h;const p=()=>{const g=[];return r.document.querySelectorAll("canvas").forEach(_=>{se(_,i,n,!0)||g.push(_)}),g},f=g=>{if(d&&g-d<u){h=requestAnimationFrame(f);return}d=g,p().forEach(_=>jg(this,void 0,void 0,function*(){var m;const S=this.mirror.getId(_);if(l.get(S)||_.width===0||_.height===0)return;if(l.set(S,!0),["webgl","webgl2"].includes(_.__context)){const v=_.getContext(_.__context);((m=v==null?void 0:v.getContextAttributes())===null||m===void 0?void 0:m.preserveDrawingBuffer)===!1&&v.clear(v.COLOR_BUFFER_BIT)}const b=yield createImageBitmap(_);a.postMessage({id:S,bitmap:b,width:_.width,height:_.height,dataURLOptions:s.dataURLOptions},[b])})),h=requestAnimationFrame(f)};h=requestAnimationFrame(f),this.resetObservers=()=>{o(),cancelAnimationFrame(h)}}initCanvasMutationObserver(t,r,i){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=ys(t,r,i,!1),s=Vg(this.processMutation.bind(this),t,r,i),o=Kg(this.processMutation.bind(this),t,r,i,this.mirror);this.resetObservers=()=>{n(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{const i=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,i)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;const i=this.pendingCanvasMutations.get(t);if(!i||r===-1)return;const n=i.map(o=>Bg(o,["type"])),{type:s}=i[0];this.mutationCb({id:r,type:s,commands:n}),this.pendingCanvasMutations.delete(t)}}class e_{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new vg,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;const i={id:r,styleIds:[]},n=[];for(const s of t){let o;this.styleMirror.has(s)?o=this.styleMirror.getId(s):(o=this.styleMirror.add(s),n.push({styleId:o,rules:Array.from(s.rules||CSSRule,(l,a)=>({rule:uo(l),index:a}))})),i.styleIds.push(o)}n.length>0&&(i.styles=n),this.adoptedStyleSheetCb(i)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class t_{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(t,r){const i=this.nodeMap.get(t);return i&&Array.from(i).some(n=>n!==r)}add(t,r){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function W(e){return Object.assign(Object.assign({},e),{timestamp:Tr()})}let q,dr,di,Er=!1;const he=Kf();function Yt(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:i,blockClass:n="rr-block",blockSelector:s=null,ignoreClass:o="rr-ignore",ignoreSelector:l=null,maskTextClass:a="rr-mask",maskTextSelector:u=null,inlineStylesheet:d=!0,maskAllInputs:h,maskInputOptions:p,slimDOMOptions:f,maskInputFn:g,maskTextFn:_,hooks:m,packFn:S,sampling:b={},dataURLOptions:v={},mousemoveWait:w,recordDOM:C=!0,recordCanvas:Y=!1,recordCrossOriginIframes:G=!1,recordAfter:N=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:P=!1,collectFonts:le=!1,inlineImages:ce=!1,plugins:R,keepIframeSrcFn:Fe=()=>!1,ignoreCSSAttributes:ee=new Set([]),errorHandler:Ae}=e;Ig(Ae);const _e=G?window.parent===window:!0;let Zt=!1;if(!_e)try{window.parent.document&&(Zt=!1)}catch{Zt=!0}if(_e&&!t)throw new Error("emit function is required");w!==void 0&&b.mousemove===void 0&&(b.mousemove=w),he.reset();const Kr=h===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:p!==void 0?p:{password:!0},Qr=f===!0||f==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:f==="all",headMetaDescKeywords:f==="all"}:f||{};yg();let dn,Xr=0;const hn=E=>{for(const de of R||[])de.eventProcessor&&(E=de.eventProcessor(E));return S&&!Zt&&(E=S(E)),E};q=(E,de)=>{var j;if(!((j=Qe[0])===null||j===void 0)&&j.isFrozen()&&E.type!==M.FullSnapshot&&!(E.type===M.IncrementalSnapshot&&E.data.source===x.Mutation)&&Qe.forEach(te=>te.unfreeze()),_e)t==null||t(hn(E),de);else if(Zt){const te={type:"rrweb",event:hn(E),origin:window.location.origin,isCheckout:de};window.parent.postMessage(te,"*")}if(E.type===M.FullSnapshot)dn=E,Xr=0;else if(E.type===M.IncrementalSnapshot){if(E.data.source===x.Mutation&&E.data.isAttachIframe)return;Xr++;const te=i&&Xr>=i,je=r&&E.timestamp-dn.timestamp>r;(te||je)&&dr(!0)}};const er=E=>{q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.Mutation},E)}))},pn=E=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.Scroll},E)})),fn=E=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.CanvasMutation},E)})),ra=E=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.AdoptedStyleSheet},E)})),He=new e_({mutationCb:er,adoptedStyleSheetCb:ra}),Be=new Fg({mirror:he,mutationCb:er,stylesheetManager:He,recordCrossOriginIframes:G,wrappedEmit:q});for(const E of R||[])E.getMirror&&E.getMirror({nodeMirror:he,crossOriginIframeMirror:Be.crossOriginIframeMirror,crossOriginIframeStyleMirror:Be.crossOriginIframeStyleMirror});const Yr=new t_;di=new Zg({recordCanvas:Y,mutationCb:fn,win:window,blockClass:n,blockSelector:s,mirror:he,sampling:b.canvas,dataURLOptions:v});const tr=new Hg({mutationCb:er,scrollCb:pn,bypassOptions:{blockClass:n,blockSelector:s,maskTextClass:a,maskTextSelector:u,inlineStylesheet:d,maskInputOptions:Kr,dataURLOptions:v,maskTextFn:_,maskInputFn:g,recordCanvas:Y,inlineImages:ce,sampling:b,slimDOMOptions:Qr,iframeManager:Be,stylesheetManager:He,canvasManager:di,keepIframeSrcFn:Fe,processedNodeManager:Yr},mirror:he});dr=(E=!1)=>{if(!C)return;q(W({type:M.Meta,data:{href:window.location.href,width:bo(),height:vo()}}),E),He.reset(),tr.init(),Qe.forEach(j=>j.lock());const de=_g(document,{mirror:he,blockClass:n,blockSelector:s,maskTextClass:a,maskTextSelector:u,inlineStylesheet:d,maskAllInputs:Kr,maskTextFn:_,slimDOM:Qr,dataURLOptions:v,recordCanvas:Y,inlineImages:ce,onSerialize:j=>{Co(j,he)&&Be.addIframe(j),Io(j,he)&&He.trackLinkElement(j),Ei(j)&&tr.addShadowRoot(j.shadowRoot,document)},onIframeLoad:(j,te)=>{Be.attachIframe(j,te),tr.observeAttachShadow(j)},onStylesheetLoad:(j,te)=>{He.attachLinkElement(j,te)},keepIframeSrcFn:Fe});if(!de)return console.warn("Failed to snapshot the document");q(W({type:M.FullSnapshot,data:{node:de,initialOffset:yo(window)}}),E),Qe.forEach(j=>j.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&He.adoptStyleSheets(document.adoptedStyleSheets,he.getId(document))};try{const E=[],de=te=>{var je;return k(Ug)({mutationCb:er,mousemoveCb:(U,Jr)=>q(W({type:M.IncrementalSnapshot,data:{source:Jr,positions:U}})),mouseInteractionCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.MouseInteraction},U)})),scrollCb:pn,viewportResizeCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.ViewportResize},U)})),inputCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.Input},U)})),mediaInteractionCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.MediaInteraction},U)})),styleSheetRuleCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.StyleSheetRule},U)})),styleDeclarationCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.StyleDeclaration},U)})),canvasMutationCb:fn,fontCb:U=>q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.Font},U)})),selectionCb:U=>{q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.Selection},U)}))},customElementCb:U=>{q(W({type:M.IncrementalSnapshot,data:Object.assign({source:x.CustomElement},U)}))},blockClass:n,ignoreClass:o,ignoreSelector:l,maskTextClass:a,maskTextSelector:u,maskInputOptions:Kr,inlineStylesheet:d,sampling:b,recordDOM:C,recordCanvas:Y,inlineImages:ce,userTriggeredOnInput:P,collectFonts:le,doc:te,maskInputFn:g,maskTextFn:_,keepIframeSrcFn:Fe,blockSelector:s,slimDOMOptions:Qr,dataURLOptions:v,mirror:he,iframeManager:Be,stylesheetManager:He,shadowDomManager:tr,processedNodeManager:Yr,canvasManager:di,ignoreCSSAttributes:ee,plugins:((je=R==null?void 0:R.filter(U=>U.observer))===null||je===void 0?void 0:je.map(U=>({observer:U.observer,options:U.options,callback:Jr=>q(W({type:M.Plugin,data:{plugin:U.name,payload:Jr}}))})))||[]},m)};Be.addLoadListener(te=>{try{E.push(de(te.contentDocument))}catch(je){console.warn(je)}});const j=()=>{dr(),E.push(de(document)),Er=!0};return document.readyState==="interactive"||document.readyState==="complete"?j():(E.push(ne("DOMContentLoaded",()=>{q(W({type:M.DomContentLoaded,data:{}})),N==="DOMContentLoaded"&&j()})),E.push(ne("load",()=>{q(W({type:M.Load,data:{}})),N==="load"&&j()},window))),()=>{E.forEach(te=>te()),Yr.destroy(),Er=!1,Tg()}}catch(E){console.warn(E)}}Yt.addCustomEvent=(e,t)=>{if(!Er)throw new Error("please add custom event after start recording");q(W({type:M.Custom,data:{tag:e,payload:t}}))};Yt.freezePage=()=>{Qe.forEach(e=>e.freeze())};Yt.takeFullSnapshot=e=>{if(!Er)throw new Error("please take full snapshot after start recording");dr(e)};Yt.mirror=he;var Lo=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(Lo||{}),me=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(me||{}),we={DEBUG:!1,LIB_VERSION:"2.54.0"},A;if(typeof window>"u"){var bs={hostname:""};A={navigator:{userAgent:""},document:{location:bs,referrer:""},screen:{width:0,height:0},location:bs}}else A=window;var Pt=24*60*60*1e3,zr=Array.prototype,r_=Function.prototype,No=Object.prototype,Me=zr.slice,Jt=No.toString,qr=No.hasOwnProperty,V=A.console,Re=A.navigator,D=A.document,ar=A.opera,Or=A.screen,ye=Re.userAgent,hi=r_.bind,Ss=zr.forEach,ws=zr.indexOf,Cs=zr.map,i_=Array.isArray,xi={},c={trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},$={log:function(){if(we.DEBUG&&!c.isUndefined(V)&&V)try{V.log.apply(V,arguments)}catch{c.each(arguments,function(t){V.log(t)})}},warn:function(){if(we.DEBUG&&!c.isUndefined(V)&&V){var e=["Mixpanel warning:"].concat(c.toArray(arguments));try{V.warn.apply(V,e)}catch{c.each(e,function(r){V.warn(r)})}}},error:function(){if(we.DEBUG&&!c.isUndefined(V)&&V){var e=["Mixpanel error:"].concat(c.toArray(arguments));try{V.error.apply(V,e)}catch{c.each(e,function(r){V.error(r)})}}},critical:function(){if(!c.isUndefined(V)&&V){var e=["Mixpanel error:"].concat(c.toArray(arguments));try{V.error.apply(V,e)}catch{c.each(e,function(r){V.error(r)})}}}},pi=function(e,t){return function(){return arguments[0]="["+t+"] "+arguments[0],e.apply($,arguments)}},Gr=function(e){return{log:pi($.log,e),error:pi($.error,e),critical:pi($.critical,e)}};c.bind=function(e,t){var r,i;if(hi&&e.bind===hi)return hi.apply(e,Me.call(arguments,1));if(!c.isFunction(e))throw new TypeError;return r=Me.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,r.concat(Me.call(arguments)));var n={};n.prototype=e.prototype;var s=new n;n.prototype=null;var o=e.apply(s,r.concat(Me.call(arguments)));return Object(o)===o?o:s},i};c.each=function(e,t,r){if(e!=null){if(Ss&&e.forEach===Ss)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,n=e.length;i<n;i++)if(i in e&&t.call(r,e[i],i,e)===xi)return}else for(var s in e)if(qr.call(e,s)&&t.call(r,e[s],s,e)===xi)return}};c.extend=function(e){return c.each(Me.call(arguments,1),function(t){for(var r in t)t[r]!==void 0&&(e[r]=t[r])}),e};c.isArray=i_||function(e){return Jt.call(e)==="[object Array]"};c.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch{return!1}};c.isArguments=function(e){return!!(e&&qr.call(e,"callee"))};c.toArray=function(e){return e?e.toArray?e.toArray():c.isArray(e)||c.isArguments(e)?Me.call(e):c.values(e):[]};c.map=function(e,t,r){if(Cs&&e.map===Cs)return e.map(t,r);var i=[];return c.each(e,function(n){i.push(t.call(r,n))}),i};c.keys=function(e){var t=[];return e===null||c.each(e,function(r,i){t[t.length]=i}),t};c.values=function(e){var t=[];return e===null||c.each(e,function(r){t[t.length]=r}),t};c.include=function(e,t){var r=!1;return e===null?r:ws&&e.indexOf===ws?e.indexOf(t)!=-1:(c.each(e,function(i){if(r||(r=i===t))return xi}),r)};c.includes=function(e,t){return e.indexOf(t)!==-1};c.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e};c.isObject=function(e){return e===Object(e)&&!c.isArray(e)};c.isEmptyObject=function(e){if(c.isObject(e)){for(var t in e)if(qr.call(e,t))return!1;return!0}return!1};c.isUndefined=function(e){return e===void 0};c.isString=function(e){return Jt.call(e)=="[object String]"};c.isDate=function(e){return Jt.call(e)=="[object Date]"};c.isNumber=function(e){return Jt.call(e)=="[object Number]"};c.isElement=function(e){return!!(e&&e.nodeType===1)};c.encodeDates=function(e){return c.each(e,function(t,r){c.isDate(t)?e[r]=c.formatDate(t):c.isObject(t)&&(e[r]=c.encodeDates(t))}),e};c.timestamp=function(){return Date.now=Date.now||function(){return+new Date},Date.now()};c.formatDate=function(e){function t(r){return r<10?"0"+r:r}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())};c.strip_empty_properties=function(e){var t={};return c.each(e,function(r,i){c.isString(r)&&r.length>0&&(t[i]=r)}),t};c.truncate=function(e,t){var r;return typeof e=="string"?r=e.slice(0,t):c.isArray(e)?(r=[],c.each(e,function(i){r.push(c.truncate(i,t))})):c.isObject(e)?(r={},c.each(e,function(i,n){r[n]=c.truncate(i,t)})):r=e,r};c.JSONEncode=function(){return function(e){var t=e,r=function(n){var s=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return s.lastIndex=0,s.test(n)?'"'+n.replace(s,function(l){var a=o[l];return typeof a=="string"?a:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'},i=function(n,s){var o="",l="    ",a=0,u="",d="",h=0,p=o,f=[],g=s[n];switch(g&&typeof g=="object"&&typeof g.toJSON=="function"&&(g=g.toJSON(n)),typeof g){case"string":return r(g);case"number":return isFinite(g)?String(g):"null";case"boolean":case"null":return String(g);case"object":if(!g)return"null";if(o+=l,f=[],Jt.apply(g)==="[object Array]"){for(h=g.length,a=0;a<h;a+=1)f[a]=i(a,g)||"null";return d=f.length===0?"[]":o?`[
`+o+f.join(`,
`+o)+`
`+p+"]":"["+f.join(",")+"]",o=p,d}for(u in g)qr.call(g,u)&&(d=i(u,g),d&&f.push(r(u)+(o?": ":":")+d));return d=f.length===0?"{}":o?"{"+f.join(",")+p+"}":"{"+f.join(",")+"}",o=p,d}};return i("",{"":t})}}();c.JSONDecode=function(){var e,t,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},i,n=function(f){var g=new SyntaxError(f);throw g.at=e,g.text=i,g},s=function(f){return f&&f!==t&&n("Expected '"+f+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},o=function(){var f,g="";for(t==="-"&&(g="-",s("-"));t>="0"&&t<="9";)g+=t,s();if(t===".")for(g+=".";s()&&t>="0"&&t<="9";)g+=t;if(t==="e"||t==="E")for(g+=t,s(),(t==="-"||t==="+")&&(g+=t,s());t>="0"&&t<="9";)g+=t,s();if(f=+g,!isFinite(f))n("Bad number");else return f},l=function(){var f,g,_="",m;if(t==='"')for(;s();){if(t==='"')return s(),_;if(t==="\\")if(s(),t==="u"){for(m=0,g=0;g<4&&(f=parseInt(s(),16),!!isFinite(f));g+=1)m=m*16+f;_+=String.fromCharCode(m)}else if(typeof r[t]=="string")_+=r[t];else break;else _+=t}n("Bad string")},a=function(){for(;t&&t<=" ";)s()},u=function(){switch(t){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}n('Unexpected "'+t+'"')},d,h=function(){var f=[];if(t==="["){if(s("["),a(),t==="]")return s("]"),f;for(;t;){if(f.push(d()),a(),t==="]")return s("]"),f;s(","),a()}}n("Bad array")},p=function(){var f,g={};if(t==="{"){if(s("{"),a(),t==="}")return s("}"),g;for(;t;){if(f=l(),a(),s(":"),Object.hasOwnProperty.call(g,f)&&n('Duplicate key "'+f+'"'),g[f]=d(),a(),t==="}")return s("}"),g;s(","),a()}}n("Bad object")};return d=function(){switch(a(),t){case"{":return p();case"[":return h();case'"':return l();case"-":return o();default:return t>="0"&&t<="9"?o():u()}},function(f){var g;return i=f,e=0,t=" ",g=d(),a(),t&&n("Syntax error"),g}}();c.base64Encode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,i,n,s,o,l,a,u,d=0,h=0,p="",f=[];if(!e)return e;e=c.utf8Encode(e);do r=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),u=r<<16|i<<8|n,s=u>>18&63,o=u>>12&63,l=u>>6&63,a=u&63,f[h++]=t.charAt(s)+t.charAt(o)+t.charAt(l)+t.charAt(a);while(d<e.length);switch(p=f.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"=";break}return p};c.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`);var t="",r,i,n=0,s;for(r=i=0,n=e.length,s=0;s<n;s++){var o=e.charCodeAt(s),l=null;o<128?i++:o>127&&o<2048?l=String.fromCharCode(o>>6|192,o&63|128):l=String.fromCharCode(o>>12|224,o>>6&63|128,o&63|128),l!==null&&(i>r&&(t+=e.substring(r,i)),t+=l,r=i=s+1)}return i>r&&(t+=e.substring(r,e.length)),t};c.UUID=function(){var e=function(){var i=1*new Date,n;if(A.performance&&A.performance.now)n=A.performance.now();else for(n=0;i==1*new Date;)n++;return i.toString(16)+Math.floor(n).toString(16)},t=function(){return Math.random().toString(16).replace(".","")},r=function(){var i=ye,n,s,o=[],l=0;function a(u,d){var h,p=0;for(h=0;h<d.length;h++)p|=o[h]<<h*8;return u^p}for(n=0;n<i.length;n++)s=i.charCodeAt(n),o.unshift(s&255),o.length>=4&&(l=a(l,o),o=[]);return o.length>0&&(l=a(l,o)),l.toString(16)};return function(){var i=(Or.height*Or.width).toString(16);return e()+"-"+t()+"-"+r()+"-"+i+"-"+e()}}();var Is=["ahrefsbot","ahrefssiteaudit","baiduspider","bingbot","bingpreview","chrome-lighthouse","facebookexternal","petalbot","pinterest","screaming frog","yahoo! slurp","yandexbot","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google"];c.isBlockedUA=function(e){var t;for(e=e.toLowerCase(),t=0;t<Is.length;t++)if(e.indexOf(Is[t])!==-1)return!0;return!1};c.HTTPBuildQuery=function(e,t){var r,i,n=[];return c.isUndefined(t)&&(t="&"),c.each(e,function(s,o){r=encodeURIComponent(s.toString()),i=encodeURIComponent(o),n[n.length]=i+"="+r}),n.join(t)};c.getQueryParam=function(e,t){t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+t+"=([^&#]*)",i=new RegExp(r),n=i.exec(e);if(n===null||n&&typeof n[1]!="string"&&n[1].length)return"";var s=n[1];try{s=decodeURIComponent(s)}catch{$.error("Skipping decoding for malformed query param: "+s)}return s.replace(/\+/g," ")};c.cookie={get:function(e){for(var t=e+"=",r=D.cookie.split(";"),i=0;i<r.length;i++){for(var n=r[i];n.charAt(0)==" ";)n=n.substring(1,n.length);if(n.indexOf(t)===0)return decodeURIComponent(n.substring(t.length,n.length))}return null},parse:function(e){var t;try{t=c.JSONDecode(c.cookie.get(e))||{}}catch{}return t},set_seconds:function(e,t,r,i,n,s,o){var l="",a="",u="";if(o)l="; domain="+o;else if(i){var d=Ts(D.location.hostname);l=d?"; domain=."+d:""}if(r){var h=new Date;h.setTime(h.getTime()+r*1e3),a="; expires="+h.toGMTString()}s&&(n=!0,u="; SameSite=None"),n&&(u+="; secure"),D.cookie=e+"="+encodeURIComponent(t)+a+"; path=/"+l+u},set:function(e,t,r,i,n,s,o){var l="",a="",u="";if(o)l="; domain="+o;else if(i){var d=Ts(D.location.hostname);l=d?"; domain=."+d:""}if(r){var h=new Date;h.setTime(h.getTime()+r*24*60*60*1e3),a="; expires="+h.toGMTString()}s&&(n=!0,u="; SameSite=None"),n&&(u+="; secure");var p=e+"="+encodeURIComponent(t)+a+"; path=/"+l+u;return D.cookie=p,p},remove:function(e,t,r){c.cookie.set(e,"",-1,t,!1,!1,r)}};var fi=null,xr=function(e,t){if(fi!==null&&!t)return fi;var r=!0;try{e=e||window.localStorage;var i="__mplss_"+Ki(8),n="xyz";e.setItem(i,n),e.getItem(i)!==n&&(r=!1),e.removeItem(i)}catch{r=!1}return fi=r,r};c.localStorage={is_supported:function(e){var t=xr(null,e);return t||$.error("localStorage unsupported; falling back to cookie store"),t},error:function(e){$.error("localStorage error: "+e)},get:function(e){try{return window.localStorage.getItem(e)}catch(t){c.localStorage.error(t)}return null},parse:function(e){try{return c.JSONDecode(c.localStorage.get(e))||{}}catch{}return null},set:function(e,t){try{window.localStorage.setItem(e,t)}catch(r){c.localStorage.error(r)}},remove:function(e){try{window.localStorage.removeItem(e)}catch(t){c.localStorage.error(t)}}};c.register_event=function(){var e=function(i,n,s,o,l){if(!i){$.error("No valid element provided to register_event");return}if(i.addEventListener&&!o)i.addEventListener(n,s,!!l);else{var a="on"+n,u=i[a];i[a]=t(i,s,u)}};function t(i,n,s){var o=function(l){if(l=l||r(window.event),!!l){var a=!0,u,d;return c.isFunction(s)&&(u=s(l)),d=n.call(i,l),(u===!1||d===!1)&&(a=!1),a}};return o}function r(i){return i&&(i.preventDefault=r.preventDefault,i.stopPropagation=r.stopPropagation),i}return r.preventDefault=function(){this.returnValue=!1},r.stopPropagation=function(){this.cancelBubble=!0},e}();var n_=new RegExp('^(\\w*)\\[(\\w+)([=~\\|\\^\\$\\*]?)=?"?([^\\]"]*)"?\\]$');c.dom_query=function(){function e(n){return n.all?n.all:n.getElementsByTagName("*")}var t=/[\t\r\n]/g;function r(n,s){var o=" "+s+" ";return(" "+n.className+" ").replace(t," ").indexOf(o)>=0}function i(n){if(!D.getElementsByTagName)return[];var s=n.split(" "),o,l,a,u,d,h,p,f,g,_,m=[D];for(h=0;h<s.length;h++){if(o=s[h].replace(/^\s+/,"").replace(/\s+$/,""),o.indexOf("#")>-1){l=o.split("#"),a=l[0];var S=l[1],b=D.getElementById(S);if(!b||a&&b.nodeName.toLowerCase()!=a)return[];m=[b];continue}if(o.indexOf(".")>-1){l=o.split("."),a=l[0];var v=l[1];for(a||(a="*"),u=[],d=0,p=0;p<m.length;p++)for(a=="*"?g=e(m[p]):g=m[p].getElementsByTagName(a),f=0;f<g.length;f++)u[d++]=g[f];for(m=[],_=0,p=0;p<u.length;p++)u[p].className&&c.isString(u[p].className)&&r(u[p],v)&&(m[_++]=u[p]);continue}var w=o.match(n_);if(w){a=w[1];var C=w[2],Y=w[3],G=w[4];for(a||(a="*"),u=[],d=0,p=0;p<m.length;p++)for(a=="*"?g=e(m[p]):g=m[p].getElementsByTagName(a),f=0;f<g.length;f++)u[d++]=g[f];m=[],_=0;var N;switch(Y){case"=":N=function(P){return P.getAttribute(C)==G};break;case"~":N=function(P){return P.getAttribute(C).match(new RegExp("\\b"+G+"\\b"))};break;case"|":N=function(P){return P.getAttribute(C).match(new RegExp("^"+G+"-?"))};break;case"^":N=function(P){return P.getAttribute(C).indexOf(G)===0};break;case"$":N=function(P){return P.getAttribute(C).lastIndexOf(G)==P.getAttribute(C).length-G.length};break;case"*":N=function(P){return P.getAttribute(C).indexOf(G)>-1};break;default:N=function(P){return P.getAttribute(C)}}for(m=[],_=0,p=0;p<u.length;p++)N(u[p])&&(m[_++]=u[p]);continue}for(a=o,u=[],d=0,p=0;p<m.length;p++)for(g=m[p].getElementsByTagName(a),f=0;f<g.length;f++)u[d++]=g[f];m=u}return m}return function(n){return c.isElement(n)?[n]:c.isObject(n)&&!c.isUndefined(n.length)?n:i.call(this,n)}}();var s_=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],o_=["dclid","fbclid","gclid","ko_click_id","li_fat_id","msclkid","ttclid","twclid","wbraid"];c.info={campaignParams:function(e){var t="",r={};return c.each(s_,function(i){t=c.getQueryParam(D.URL,i),t.length?r[i]=t:e!==void 0&&(r[i]=e)}),r},clickParams:function(){var e="",t={};return c.each(o_,function(r){e=c.getQueryParam(D.URL,r),e.length&&(t[r]=e)}),t},marketingParams:function(){return c.extend(c.info.campaignParams(),c.info.clickParams())},searchEngine:function(e){return e.search("https?://(.*)google.([^/?]*)")===0?"google":e.search("https?://(.*)bing.com")===0?"bing":e.search("https?://(.*)yahoo.com")===0?"yahoo":e.search("https?://(.*)duckduckgo.com")===0?"duckduckgo":null},searchInfo:function(e){var t=c.info.searchEngine(e),r=t!="yahoo"?"q":"p",i={};if(t!==null){i.$search_engine=t;var n=c.getQueryParam(e,r);n.length&&(i.mp_keyword=n)}return i},browser:function(e,t,r){return t=t||"",r||c.includes(e," OPR/")?c.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":c.includes(e,"IEMobile")||c.includes(e,"WPDesktop")?"Internet Explorer Mobile":c.includes(e,"SamsungBrowser/")?"Samsung Internet":c.includes(e,"Edge")||c.includes(e,"Edg/")?"Microsoft Edge":c.includes(e,"FBIOS")?"Facebook Mobile":c.includes(e,"Chrome")?"Chrome":c.includes(e,"CriOS")?"Chrome iOS":c.includes(e,"UCWEB")||c.includes(e,"UCBrowser")?"UC Browser":c.includes(e,"FxiOS")?"Firefox iOS":c.includes(t,"Apple")?c.includes(e,"Mobile")?"Mobile Safari":"Safari":c.includes(e,"Android")?"Android Mobile":c.includes(e,"Konqueror")?"Konqueror":c.includes(e,"Firefox")?"Firefox":c.includes(e,"MSIE")||c.includes(e,"Trident/")?"Internet Explorer":c.includes(e,"Gecko")?"Mozilla":""},browserVersion:function(e,t,r){var i=c.info.browser(e,t,r),n={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge?\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Samsung Internet":/SamsungBrowser\/(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/},s=n[i];if(s===void 0)return null;var o=e.match(s);return o?parseFloat(o[o.length-2]):null},os:function(){var e=ye;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"Chrome OS":""},device:function(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},currentUrl:function(){return A.location.href},properties:function(e){return typeof e!="object"&&(e={}),c.extend(c.strip_empty_properties({$os:c.info.os(),$browser:c.info.browser(ye,Re.vendor,ar),$referrer:D.referrer,$referring_domain:c.info.referringDomain(D.referrer),$device:c.info.device(ye)}),{$current_url:c.info.currentUrl(),$browser_version:c.info.browserVersion(ye,Re.vendor,ar),$screen_height:Or.height,$screen_width:Or.width,mp_lib:"web",$lib_version:we.LIB_VERSION,$insert_id:Ki(),time:c.timestamp()/1e3},c.strip_empty_properties(e))},people_properties:function(){return c.extend(c.strip_empty_properties({$os:c.info.os(),$browser:c.info.browser(ye,Re.vendor,ar)}),{$browser_version:c.info.browserVersion(ye,Re.vendor,ar)})},mpPageViewProperties:function(){return c.strip_empty_properties({current_page_title:D.title,current_domain:A.location.hostname,current_url_path:A.location.pathname,current_url_protocol:A.location.protocol,current_url_search:A.location.search})}};var Ki=function(e){var t=Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10);return e?t.substring(0,e):t},a_=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i,l_=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,Ts=function(e){var t=l_,r=e.split("."),i=r[r.length-1];(i.length>4||i==="com"||i==="org")&&(t=a_);var n=e.match(t);return n?n[0]:""},kr=null,Mr=null;typeof JSON<"u"&&(kr=JSON.stringify,Mr=JSON.parse);kr=kr||c.JSONEncode;Mr=Mr||c.JSONDecode;c.toArray=c.toArray;c.isObject=c.isObject;c.JSONEncode=c.JSONEncode;c.JSONDecode=c.JSONDecode;c.isBlockedUA=c.isBlockedUA;c.isEmptyObject=c.isEmptyObject;c.info=c.info;c.info.device=c.info.device;c.info.browser=c.info.browser;c.info.browserVersion=c.info.browserVersion;c.info.properties=c.info.properties;var c_="__mp_opt_in_out_";function u_(e,t){Fo(!0,e,t)}function d_(e,t){Fo(!1,e,t)}function h_(e,t){return Uo(e,t)==="1"}function Po(e,t){if(f_(t))return $.warn('This browser has "Do Not Track" enabled. This will prevent the Mixpanel SDK from sending any data. To ignore the "Do Not Track" browser setting, initialize the Mixpanel instance with the config "ignore_dnt: true"'),!0;var r=Uo(e,t)==="0";return r&&$.warn("You are opted out of Mixpanel tracking. This will prevent the Mixpanel SDK from sending any data."),r}function Ne(e){return Yi(e,function(t){return this.get_config(t)})}function Pe(e){return Yi(e,function(t){return this._get_config(t)})}function At(e){return Yi(e,function(t){return this._get_config(t)})}function p_(e,t){t=t||{},Qi(t).remove(Xi(e,t),!!t.crossSubdomainCookie,t.cookieDomain)}function Qi(e){return e=e||{},e.persistenceType==="localStorage"?c.localStorage:c.cookie}function Xi(e,t){return t=t||{},(t.persistencePrefix||c_)+e}function Uo(e,t){return Qi(t).get(Xi(e,t))}function f_(e){if(e&&e.ignoreDnt)return!1;var t=e&&e.window||A,r=t.navigator||{},i=!1;return c.each([r.doNotTrack,r.msDoNotTrack,t.doNotTrack],function(n){c.includes([!0,1,"1","yes"],n)&&(i=!0)}),i}function Fo(e,t,r){if(!c.isString(t)||!t.length){$.error("gdpr."+(e?"optIn":"optOut")+" called with an invalid token");return}r=r||{},Qi(r).set(Xi(t,r),e?1:0,c.isNumber(r.cookieExpiration)?r.cookieExpiration:null,!!r.crossSubdomainCookie,!!r.secureCookie,!!r.crossSiteCookie,r.cookieDomain),r.track&&e&&r.track(r.trackEventName||"$opt_in",r.trackProperties,{send_immediately:!0})}function Yi(e,t){return function(){var r=!1;try{var i=t.call(this,"token"),n=t.call(this,"ignore_dnt"),s=t.call(this,"opt_out_tracking_persistence_type"),o=t.call(this,"opt_out_tracking_cookie_prefix"),l=t.call(this,"window");i&&(r=Po(i,{ignoreDnt:n,persistenceType:s,persistencePrefix:o,window:l}))}catch(u){$.error("Unexpected error when checking tracking opt-out status: "+u)}if(!r)return e.apply(this,arguments);var a=arguments[arguments.length-1];typeof a=="function"&&a(0)}}var g_=Gr("lock"),Ho=function(e,t){t=t||{},this.storageKey=e,this.storage=t.storage||window.localStorage,this.pollIntervalMS=t.pollIntervalMS||100,this.timeoutMS=t.timeoutMS||2e3};Ho.prototype.withLock=function(e,t,r){!r&&typeof t!="function"&&(r=t,t=null);var i=r||new Date().getTime()+"|"+Math.random(),n=new Date().getTime(),s=this.storageKey,o=this.pollIntervalMS,l=this.timeoutMS,a=this.storage,u=s+":X",d=s+":Y",h=s+":Z",p=function(b){t&&t(b)},f=function(b){if(new Date().getTime()-n>l){g_.error("Timeout waiting for mutex on "+s+"; clearing lock. ["+i+"]"),a.removeItem(h),a.removeItem(d),m();return}setTimeout(function(){try{b()}catch(v){p(v)}},o*(Math.random()+.1))},g=function(b,v){b()?v():f(function(){g(b,v)})},_=function(){var b=a.getItem(d);if(b&&b!==i)return!1;if(a.setItem(d,i),a.getItem(d)===i)return!0;if(!xr(a,!0))throw new Error("localStorage support dropped while acquiring lock");return!1},m=function(){a.setItem(u,i),g(_,function(){if(a.getItem(u)===i){S();return}f(function(){if(a.getItem(d)!==i){m();return}g(function(){return!a.getItem(h)},S)})})},S=function(){a.setItem(h,"1");try{e()}finally{a.removeItem(h),a.getItem(d)===i&&a.removeItem(d),a.getItem(u)===i&&a.removeItem(u)}};try{if(xr(a,!0))m();else throw new Error("localStorage support check failed")}catch(b){p(b)}};var As=Gr("batch"),Ue=function(e,t){t=t||{},this.storageKey=e,this.storage=t.storage||window.localStorage,this.reportError=t.errorReporter||c.bind(As.error,As),this.lock=new Ho(e,{storage:this.storage}),this.usePersistence=t.usePersistence,this.pid=t.pid||null,this.memQueue=[]};Ue.prototype.enqueue=function(e,t,r){var i={id:Ki(),flushAfter:new Date().getTime()+t*2,payload:e};this.usePersistence?this.lock.withLock(c.bind(function(){var s;try{var o=this.readFromStorage();o.push(i),s=this.saveToStorage(o),s&&this.memQueue.push(i)}catch{this.reportError("Error enqueueing item",e),s=!1}r&&r(s)},this),c.bind(function(s){this.reportError("Error acquiring storage lock",s),r&&r(!1)},this),this.pid):(this.memQueue.push(i),r&&r(!0))};Ue.prototype.fillBatch=function(e){var t=this.memQueue.slice(0,e);if(this.usePersistence&&t.length<e){var r=this.readFromStorage();if(r.length){var i={};c.each(t,function(o){i[o.id]=!0});for(var n=0;n<r.length;n++){var s=r[n];if(new Date().getTime()>s.flushAfter&&!i[s.id]&&(s.orphaned=!0,t.push(s),t.length>=e))break}}}return t};var Es=function(e,t){var r=[];return c.each(e,function(i){i.id&&!t[i.id]&&r.push(i)}),r};Ue.prototype.removeItemsByID=function(e,t){var r={};if(c.each(e,function(n){r[n]=!0}),this.memQueue=Es(this.memQueue,r),!this.usePersistence)t&&t(!0);else{var i=c.bind(function(){var n;try{var s=this.readFromStorage();if(s=Es(s,r),n=this.saveToStorage(s),n){s=this.readFromStorage();for(var o=0;o<s.length;o++){var l=s[o];if(l.id&&r[l.id])return this.reportError("Item not removed from storage"),!1}}}catch{this.reportError("Error removing items",e),n=!1}return n},this);this.lock.withLock(function(){var s=i();t&&t(s)},c.bind(function(s){var o=!1;if(this.reportError("Error acquiring storage lock",s),!xr(this.storage,!0)&&(o=i(),!o))try{this.storage.removeItem(this.storageKey)}catch(l){this.reportError("Error clearing queue",l)}t&&t(o)},this),this.pid)}};var Os=function(e,t){var r=[];return c.each(e,function(i){var n=i.id;if(n in t){var s=t[n];s!==null&&(i.payload=s,r.push(i))}else r.push(i)}),r};Ue.prototype.updatePayloads=function(e,t){this.memQueue=Os(this.memQueue,e),this.usePersistence?this.lock.withLock(c.bind(function(){var i;try{var n=this.readFromStorage();n=Os(n,e),i=this.saveToStorage(n)}catch{this.reportError("Error updating items",e),i=!1}t&&t(i)},this),c.bind(function(i){this.reportError("Error acquiring storage lock",i),t&&t(!1)},this),this.pid):t&&t(!0)};Ue.prototype.readFromStorage=function(){var e;try{e=this.storage.getItem(this.storageKey),e&&(e=Mr(e),c.isArray(e)||(this.reportError("Invalid storage entry:",e),e=null))}catch(t){this.reportError("Error retrieving queue",t),e=null}return e||[]};Ue.prototype.saveToStorage=function(e){try{return this.storage.setItem(this.storageKey,kr(e)),!0}catch(t){return this.reportError("Error saving queue",t),!1}};Ue.prototype.clear=function(){this.memQueue=[],this.usePersistence&&this.storage.removeItem(this.storageKey)};var __=10*60*1e3,Ut=Gr("batch"),fe=function(e,t){this.errorReporter=t.errorReporter,this.queue=new Ue(e,{errorReporter:c.bind(this.reportError,this),storage:t.storage,usePersistence:t.usePersistence}),this.libConfig=t.libConfig,this.sendRequest=t.sendRequestFunc,this.beforeSendHook=t.beforeSendHook,this.stopAllBatching=t.stopAllBatchingFunc,this.batchSize=this.libConfig.batch_size,this.flushInterval=this.libConfig.batch_flush_interval_ms,this.stopped=!this.libConfig.batch_autostart,this.consecutiveRemovalFailures=0,this.itemIdsSentSuccessfully={},this.flushOnlyOnInterval=t.flushOnlyOnInterval||!1};fe.prototype.enqueue=function(e,t){this.queue.enqueue(e,this.flushInterval,t)};fe.prototype.start=function(){this.stopped=!1,this.consecutiveRemovalFailures=0,this.flush()};fe.prototype.stop=function(){this.stopped=!0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null)};fe.prototype.clear=function(){this.queue.clear()};fe.prototype.resetBatchSize=function(){this.batchSize=this.libConfig.batch_size};fe.prototype.resetFlush=function(){this.scheduleFlush(this.libConfig.batch_flush_interval_ms)};fe.prototype.scheduleFlush=function(e){this.flushInterval=e,this.stopped||(this.timeoutID=setTimeout(c.bind(this.flush,this),this.flushInterval))};fe.prototype.flush=function(e){try{if(this.requestInProgress){Ut.log("Flush: Request already in progress");return}e=e||{};var t=this.libConfig.batch_request_timeout_ms,r=new Date().getTime(),i=this.batchSize,n=this.queue.fillBatch(i),s=n.length===i,o=[],l={};if(c.each(n,function(d){var h=d.payload;if(this.beforeSendHook&&!d.orphaned&&(h=this.beforeSendHook(h)),h){h.event&&h.properties&&(h.properties=c.extend({},h.properties,{mp_sent_by_lib_version:we.LIB_VERSION}));var p=!0,f=d.id;f?(this.itemIdsSentSuccessfully[f]||0)>5&&(this.reportError("[dupe] item ID sent too many times, not sending",{item:d,batchSize:n.length,timesSent:this.itemIdsSentSuccessfully[f]}),p=!1):this.reportError("[dupe] found item with no ID",{item:d}),p&&o.push(h)}l[d.id]=h},this),o.length<1){this.resetFlush();return}this.requestInProgress=!0;var a=c.bind(function(d){this.requestInProgress=!1;try{var h=!1;if(e.unloading)this.queue.updatePayloads(l);else if(c.isObject(d)&&d.error==="timeout"&&new Date().getTime()-r>=t)this.reportError("Network timeout; retrying"),this.flush();else if(c.isObject(d)&&(d.httpStatusCode>=500||d.httpStatusCode===429||d.error==="timeout")){var p=this.flushInterval*2;d.retryAfter&&(p=parseInt(d.retryAfter,10)*1e3||p),p=Math.min(__,p),this.reportError("Error; retry in "+p+" ms"),this.scheduleFlush(p)}else if(c.isObject(d)&&d.httpStatusCode===413)if(n.length>1){var f=Math.max(1,Math.floor(i/2));this.batchSize=Math.min(this.batchSize,f,n.length-1),this.reportError("413 response; reducing batch size to "+this.batchSize),this.resetFlush()}else this.reportError("Single-event request too large; dropping",n),this.resetBatchSize(),h=!0;else h=!0;h&&(this.queue.removeItemsByID(c.map(n,function(g){return g.id}),c.bind(function(g){g?(this.consecutiveRemovalFailures=0,this.flushOnlyOnInterval&&!s?this.resetFlush():this.flush()):(this.reportError("Failed to remove items from queue"),++this.consecutiveRemovalFailures>5?(this.reportError("Too many queue failures; disabling batching system."),this.stopAllBatching()):this.resetFlush())},this)),c.each(n,c.bind(function(g){var _=g.id;_?(this.itemIdsSentSuccessfully[_]=this.itemIdsSentSuccessfully[_]||0,this.itemIdsSentSuccessfully[_]++,this.itemIdsSentSuccessfully[_]>5&&this.reportError("[dupe] item ID sent too many times",{item:g,batchSize:n.length,timesSent:this.itemIdsSentSuccessfully[_]})):this.reportError("[dupe] found item with no ID while removing",{item:g})},this)))}catch(g){this.reportError("Error handling API response",g),this.resetFlush()}},this),u={method:"POST",verbose:!0,ignore_json_errors:!0,timeout_ms:t};e.unloading&&(u.transport="sendBeacon"),Ut.log("MIXPANEL REQUEST:",o),this.sendRequest(o,u,a)}catch(d){this.reportError("Error flushing request queue",d),this.resetFlush()}};fe.prototype.reportError=function(e,t){if(Ut.error.apply(Ut.error,arguments),this.errorReporter)try{t instanceof Error||(t=new Error(e)),this.errorReporter(e,t)}catch(r){Ut.error(r)}};var ut=Gr("recorder"),xs=A.CompressionStream,m_={batch_size:1e3,batch_flush_interval_ms:10*1e3,batch_request_timeout_ms:90*1e3,batch_autostart:!0},y_=new Set([me.MouseMove,me.MouseInteraction,me.Scroll,me.ViewportResize,me.Input,me.TouchMove,me.MediaInteraction,me.Drag,me.Selection]);function v_(e){return e.type===Lo.IncrementalSnapshot&&y_.has(e.source)}var ge=function(e){this._mixpanel=e,this._stopRecording=null,this.recEvents=[],this.seqNo=0,this.replayId=null,this.replayStartTime=null,this.sendBatchId=null,this.idleTimeoutId=null,this.maxTimeoutId=null,this.recordMaxMs=Pt,this._initBatcher()};ge.prototype._initBatcher=function(){this.batcher=new fe("__mprec",{libConfig:m_,sendRequestFunc:c.bind(this.flushEventsWithOptOut,this),errorReporter:c.bind(this.reportError,this),flushOnlyOnInterval:!0,usePersistence:!1})};ge.prototype.get_config=function(e){return this._mixpanel.get_config(e)};ge.prototype.startRecording=function(){if(this._stopRecording!==null){ut.log("Recording already in progress, skipping startRecording.");return}this.recordMaxMs=this.get_config("record_max_ms"),this.recordMaxMs>Pt&&(this.recordMaxMs=Pt,ut.critical("record_max_ms cannot be greater than "+Pt+"ms. Capping value.")),this.recEvents=[],this.seqNo=0,this.replayStartTime=null,this.replayId=c.UUID(),this.batcher.start();var e=c.bind(function(){clearTimeout(this.idleTimeoutId),this.idleTimeoutId=setTimeout(c.bind(function(){ut.log("Idle timeout reached, restarting recording."),this.resetRecording()},this),this.get_config("record_idle_timeout_ms"))},this);this._stopRecording=Yt({emit:c.bind(function(t){this.batcher.enqueue(t),v_(t)&&e()},this),blockClass:this.get_config("record_block_class"),blockSelector:this.get_config("record_block_selector"),collectFonts:this.get_config("record_collect_fonts"),inlineImages:this.get_config("record_inline_images"),maskAllInputs:!0,maskTextClass:this.get_config("record_mask_text_class"),maskTextSelector:this.get_config("record_mask_text_selector")}),e(),this.maxTimeoutId=setTimeout(c.bind(this.resetRecording,this),this.recordMaxMs)};ge.prototype.resetRecording=function(){this.stopRecording(),this.startRecording()};ge.prototype.stopRecording=function(){this._stopRecording!==null&&(this._stopRecording(),this._stopRecording=null),this.batcher.flush(),this.replayId=null,clearTimeout(this.idleTimeoutId),clearTimeout(this.maxTimeoutId)};ge.prototype.flushEventsWithOptOut=function(e,t,r){this._flushEvents(e,t,r,c.bind(this._onOptOut,this))};ge.prototype._onOptOut=function(e){e===0&&(this.recEvents=[],this.stopRecording())};ge.prototype._sendRequest=function(e,t,r){var i=c.bind(function(n,s){n.status===200&&this.seqNo++,r({status:0,httpStatusCode:n.status,responseBody:s,retryAfter:n.headers.get("Retry-After")})},this);A.fetch(this.get_config("api_host")+"/"+this.get_config("api_routes").record+"?"+new URLSearchParams(e),{method:"POST",headers:{Authorization:"Basic "+btoa(this.get_config("token")+":"),"Content-Type":"application/octet-stream"},body:t}).then(function(n){n.json().then(function(s){i(n,s)}).catch(function(s){r({error:s})})}).catch(function(n){r({error:n})})};ge.prototype._flushEvents=Ne(function(e,t,r){const i=e.length;if(i>0){var n=e[0].timestamp;this.seqNo===0&&(this.replayStartTime=n);var s=e[i-1].timestamp-this.replayStartTime,o={distinct_id:String(this._mixpanel.get_distinct_id()),seq:this.seqNo,batch_start_time:n/1e3,replay_id:this.replayId,replay_length_ms:s,replay_start_time:this.replayStartTime/1e3},l=c.JSONEncode(e),a=this._mixpanel.get_property("$device_id");a&&(o.$device_id=a);var u=this._mixpanel.get_property("$user_id");if(u&&(o.$user_id=u),xs){var d=new Blob([l],{type:"application/json"}).stream(),h=d.pipeThrough(new xs("gzip"));new Response(h).blob().then(c.bind(function(p){o.format="gzip",this._sendRequest(o,p,r)},this))}else o.format="body",this._sendRequest(o,l,r)}});ge.prototype.reportError=function(e,t){ut.error.apply(ut.error,arguments);try{!t&&!(e instanceof Error)&&(e=new Error(e)),this.get_config("error_reporter")(e,t)}catch(r){ut.error(r)}};A.__mp_recorder=ge;var Te=function(){};Te.prototype.create_properties=function(){};Te.prototype.event_handler=function(){};Te.prototype.after_track_handler=function(){};Te.prototype.init=function(e){return this.mp=e,this};Te.prototype.track=function(e,t,r,i){var n=this,s=c.dom_query(e);if(s.length===0){$.error("The DOM query ("+e+") returned 0 elements");return}return c.each(s,function(o){c.register_event(o,this.override_event,function(l){var a={},u=n.create_properties(r,this),d=n.mp.get_config("track_links_timeout");n.event_handler(l,this,a),window.setTimeout(n.track_callback(i,u,a,!0),d),n.mp.track(t,u,n.track_callback(i,u,a))})},this),!0};Te.prototype.track_callback=function(e,t,r,i){i=i||!1;var n=this;return function(){r.callback_fired||(r.callback_fired=!0,!(e&&e(i,t)===!1)&&n.after_track_handler(t,r,i))}};Te.prototype.create_properties=function(e,t){var r;return typeof e=="function"?r=e(t):r=c.extend({},e),r};var gt=function(){this.override_event="click"};c.inherit(gt,Te);gt.prototype.create_properties=function(e,t){var r=gt.superclass.create_properties.apply(this,arguments);return t.href&&(r.url=t.href),r};gt.prototype.event_handler=function(e,t,r){r.new_tab=e.which===2||e.metaKey||e.ctrlKey||t.target==="_blank",r.href=t.href,r.new_tab||e.preventDefault()};gt.prototype.after_track_handler=function(e,t){t.new_tab||setTimeout(function(){window.location=t.href},0)};var Vr=function(){this.override_event="submit"};c.inherit(Vr,Te);Vr.prototype.event_handler=function(e,t,r){r.element=t,e.preventDefault()};Vr.prototype.after_track_handler=function(e,t){setTimeout(function(){t.element.submit()},0)};var Le="$set",_t="$set_once",pe="$unset",Je="$add",be="$append",Ze="$union",Ce="$remove",b_="$delete",Bo={set_action:function(e,t){var r={},i={};return c.isObject(e)?c.each(e,function(n,s){this._is_reserved_property(s)||(i[s]=n)},this):i[e]=t,r[Le]=i,r},unset_action:function(e){var t={},r=[];return c.isArray(e)||(e=[e]),c.each(e,function(i){this._is_reserved_property(i)||r.push(i)},this),t[pe]=r,t},set_once_action:function(e,t){var r={},i={};return c.isObject(e)?c.each(e,function(n,s){this._is_reserved_property(s)||(i[s]=n)},this):i[e]=t,r[_t]=i,r},union_action:function(e,t){var r={},i={};return c.isObject(e)?c.each(e,function(n,s){this._is_reserved_property(s)||(i[s]=c.isArray(n)?n:[n])},this):i[e]=c.isArray(t)?t:[t],r[Ze]=i,r},append_action:function(e,t){var r={},i={};return c.isObject(e)?c.each(e,function(n,s){this._is_reserved_property(s)||(i[s]=n)},this):i[e]=t,r[be]=i,r},remove_action:function(e,t){var r={},i={};return c.isObject(e)?c.each(e,function(n,s){this._is_reserved_property(s)||(i[s]=n)},this):i[e]=t,r[Ce]=i,r},delete_action:function(){var e={};return e[b_]="",e}},B=function(){};c.extend(B.prototype,Bo);B.prototype._init=function(e,t,r){this._mixpanel=e,this._group_key=t,this._group_id=r};B.prototype.set=At(function(e,t,r){var i=this.set_action(e,t);return c.isObject(e)&&(r=t),this._send_request(i,r)});B.prototype.set_once=At(function(e,t,r){var i=this.set_once_action(e,t);return c.isObject(e)&&(r=t),this._send_request(i,r)});B.prototype.unset=At(function(e,t){var r=this.unset_action(e);return this._send_request(r,t)});B.prototype.union=At(function(e,t,r){c.isObject(e)&&(r=t);var i=this.union_action(e,t);return this._send_request(i,r)});B.prototype.delete=At(function(e){var t=this.delete_action();return this._send_request(t,e)});B.prototype.remove=At(function(e,t,r){var i=this.remove_action(e,t);return this._send_request(i,r)});B.prototype._send_request=function(e,t){e.$group_key=this._group_key,e.$group_id=this._group_id,e.$token=this._get_config("token");var r=c.encodeDates(e);return this._mixpanel._track_or_batch({type:"groups",data:r,endpoint:this._get_config("api_host")+"/"+this._get_config("api_routes").groups,batcher:this._mixpanel.request_batchers.groups},t)};B.prototype._is_reserved_property=function(e){return e==="$group_key"||e==="$group_id"};B.prototype._get_config=function(e){return this._mixpanel.get_config(e)};B.prototype.toString=function(){return this._mixpanel.toString()+".group."+this._group_key+"."+this._group_id};B.prototype.remove=B.prototype.remove;B.prototype.set=B.prototype.set;B.prototype.set_once=B.prototype.set_once;B.prototype.union=B.prototype.union;B.prototype.unset=B.prototype.unset;B.prototype.toString=B.prototype.toString;var T=function(){};c.extend(T.prototype,Bo);T.prototype._init=function(e){this._mixpanel=e};T.prototype.set=Pe(function(e,t,r){var i=this.set_action(e,t);return c.isObject(e)&&(r=t),this._get_config("save_referrer")&&this._mixpanel.persistence.update_referrer_info(document.referrer),i[Le]=c.extend({},c.info.people_properties(),i[Le]),this._send_request(i,r)});T.prototype.set_once=Pe(function(e,t,r){var i=this.set_once_action(e,t);return c.isObject(e)&&(r=t),this._send_request(i,r)});T.prototype.unset=Pe(function(e,t){var r=this.unset_action(e);return this._send_request(r,t)});T.prototype.increment=Pe(function(e,t,r){var i={},n={};return c.isObject(e)?(c.each(e,function(s,o){if(!this._is_reserved_property(o))if(isNaN(parseFloat(s))){$.error("Invalid increment value passed to mixpanel.people.increment - must be a number");return}else n[o]=s},this),r=t):(c.isUndefined(t)&&(t=1),n[e]=t),i[Je]=n,this._send_request(i,r)});T.prototype.append=Pe(function(e,t,r){c.isObject(e)&&(r=t);var i=this.append_action(e,t);return this._send_request(i,r)});T.prototype.remove=Pe(function(e,t,r){c.isObject(e)&&(r=t);var i=this.remove_action(e,t);return this._send_request(i,r)});T.prototype.union=Pe(function(e,t,r){c.isObject(e)&&(r=t);var i=this.union_action(e,t);return this._send_request(i,r)});T.prototype.track_charge=Pe(function(e,t,r){if(!c.isNumber(e)&&(e=parseFloat(e),isNaN(e))){$.error("Invalid value passed to mixpanel.people.track_charge - must be a number");return}return this.append("$transactions",c.extend({$amount:e},t),r)});T.prototype.clear_charges=function(e){return this.set("$transactions",[],e)};T.prototype.delete_user=function(){if(!this._identify_called()){$.error("mixpanel.people.delete_user() requires you to call identify() first");return}var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)};T.prototype.toString=function(){return this._mixpanel.toString()+".people"};T.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var r=this._mixpanel.get_property("$device_id"),i=this._mixpanel.get_property("$user_id"),n=this._mixpanel.get_property("$had_persisted_distinct_id");r&&(e.$device_id=r),i&&(e.$user_id=i),n&&(e.$had_persisted_distinct_id=n);var s=c.encodeDates(e);return this._identify_called()?this._mixpanel._track_or_batch({type:"people",data:s,endpoint:this._get_config("api_host")+"/"+this._get_config("api_routes").engage,batcher:this._mixpanel.request_batchers.people},t):(this._enqueue(e),c.isUndefined(t)||(this._get_config("verbose")?t({status:-1,error:null}):t(-1)),c.truncate(s,255))};T.prototype._get_config=function(e){return this._mixpanel.get_config(e)};T.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0};T.prototype._enqueue=function(e){Le in e?this._mixpanel.persistence._add_to_people_queue(Le,e):_t in e?this._mixpanel.persistence._add_to_people_queue(_t,e):pe in e?this._mixpanel.persistence._add_to_people_queue(pe,e):Je in e?this._mixpanel.persistence._add_to_people_queue(Je,e):be in e?this._mixpanel.persistence._add_to_people_queue(be,e):Ce in e?this._mixpanel.persistence._add_to_people_queue(Ce,e):Ze in e?this._mixpanel.persistence._add_to_people_queue(Ze,e):$.error("Invalid call to _enqueue():",e)};T.prototype._flush_one_queue=function(e,t,r,i){var n=this,s=c.extend({},this._mixpanel.persistence.load_queue(e)),o=s;!c.isUndefined(s)&&c.isObject(s)&&!c.isEmptyObject(s)&&(n._mixpanel.persistence._pop_from_people_queue(e,s),n._mixpanel.persistence.save(),i&&(o=i(s)),t.call(n,o,function(l,a){l===0&&n._mixpanel.persistence._add_to_people_queue(e,s),c.isUndefined(r)||r(l,a)}))};T.prototype._flush=function(e,t,r,i,n,s,o){var l=this;this._flush_one_queue(Le,this.set,e),this._flush_one_queue(_t,this.set_once,i),this._flush_one_queue(pe,this.unset,s,function(m){return c.keys(m)}),this._flush_one_queue(Je,this.increment,t),this._flush_one_queue(Ze,this.union,n);var a=this._mixpanel.persistence.load_queue(be);if(!c.isUndefined(a)&&c.isArray(a)&&a.length)for(var u,d=function(m,S){m===0&&l._mixpanel.persistence._add_to_people_queue(be,u),c.isUndefined(r)||r(m,S)},h=a.length-1;h>=0;h--)a=this._mixpanel.persistence.load_queue(be),u=a.pop(),l._mixpanel.persistence.save(),c.isEmptyObject(u)||l.append(u,d);var p=this._mixpanel.persistence.load_queue(Ce);if(!c.isUndefined(p)&&c.isArray(p)&&p.length)for(var f,g=function(m,S){m===0&&l._mixpanel.persistence._add_to_people_queue(Ce,f),c.isUndefined(o)||o(m,S)},_=p.length-1;_>=0;_--)p=this._mixpanel.persistence.load_queue(Ce),f=p.pop(),l._mixpanel.persistence.save(),c.isEmptyObject(f)||l.remove(f,g)};T.prototype._is_reserved_property=function(e){return e==="$distinct_id"||e==="$token"||e==="$device_id"||e==="$user_id"||e==="$had_persisted_distinct_id"};T.prototype.set=T.prototype.set;T.prototype.set_once=T.prototype.set_once;T.prototype.unset=T.prototype.unset;T.prototype.increment=T.prototype.increment;T.prototype.append=T.prototype.append;T.prototype.remove=T.prototype.remove;T.prototype.union=T.prototype.union;T.prototype.track_charge=T.prototype.track_charge;T.prototype.clear_charges=T.prototype.clear_charges;T.prototype.delete_user=T.prototype.delete_user;T.prototype.toString=T.prototype.toString;var Ji="__mps",Zi="__mpso",en="__mpus",tn="__mpa",rn="__mpap",nn="__mpr",sn="__mpu",jo="$people_distinct_id",Rr="__alias",Gt="__timers",S_=[Ji,Zi,en,tn,rn,nn,sn,jo,Rr,Gt],O=function(e){this.props={},this.campaign_params_saved=!1,e.persistence_name?this.name="mp_"+e.persistence_name:this.name="mp_"+e.token+"_mixpanel";var t=e.persistence;t!=="cookie"&&t!=="localStorage"&&($.critical("Unknown persistence type "+t+"; falling back to cookie"),t=e.persistence="cookie"),t==="localStorage"&&c.localStorage.is_supported()?this.storage=c.localStorage:this.storage=c.cookie,this.load(),this.update_config(e),this.upgrade(),this.save()};O.prototype.properties=function(){var e={};return this.load(),c.each(this.props,function(t,r){c.include(S_,r)||(e[r]=t)}),e};O.prototype.load=function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=c.extend({},e))}};O.prototype.upgrade=function(){var e,t;this.storage===c.localStorage?(e=c.cookie.parse(this.name),c.cookie.remove(this.name),c.cookie.remove(this.name,!0),e&&this.register_once(e)):this.storage===c.cookie&&(t=c.localStorage.parse(this.name),c.localStorage.remove(this.name),t&&this.register_once(t))};O.prototype.save=function(){this.disabled||this.storage.set(this.name,c.JSONEncode(this.props),this.expire_days,this.cross_subdomain,this.secure,this.cross_site,this.cookie_domain)};O.prototype.load_prop=function(e){return this.load(),this.props[e]};O.prototype.remove=function(){this.storage.remove(this.name,!1,this.cookie_domain),this.storage.remove(this.name,!0,this.cookie_domain)};O.prototype.clear=function(){this.remove(),this.props={}};O.prototype.register_once=function(e,t,r){return c.isObject(e)?(typeof t>"u"&&(t="None"),this.expire_days=typeof r>"u"?this.default_expiry:r,this.load(),c.each(e,function(i,n){(!this.props.hasOwnProperty(n)||this.props[n]===t)&&(this.props[n]=i)},this),this.save(),!0):!1};O.prototype.register=function(e,t){return c.isObject(e)?(this.expire_days=typeof t>"u"?this.default_expiry:t,this.load(),c.extend(this.props,e),this.save(),!0):!1};O.prototype.unregister=function(e){this.load(),e in this.props&&(delete this.props[e],this.save())};O.prototype.update_search_keyword=function(e){this.register(c.info.searchInfo(e))};O.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:c.info.referringDomain(e)||"$direct"},"")};O.prototype.get_referrer_info=function(){return c.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})};O.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cookie_domain(e.cookie_domain),this.set_cross_site(e.cross_site_cookie),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)};O.prototype.set_disabled=function(e){this.disabled=e,this.disabled?this.remove():this.save()};O.prototype.set_cookie_domain=function(e){e!==this.cookie_domain&&(this.remove(),this.cookie_domain=e,this.save())};O.prototype.set_cross_site=function(e){e!==this.cross_site&&(this.cross_site=e,this.remove(),this.save())};O.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())};O.prototype.get_cross_subdomain=function(){return this.cross_subdomain};O.prototype.set_secure=function(e){e!==this.secure&&(this.secure=!!e,this.remove(),this.save())};O.prototype._add_to_people_queue=function(e,t){var r=this._get_queue_key(e),i=t[e],n=this._get_or_create_queue(Le),s=this._get_or_create_queue(_t),o=this._get_or_create_queue(pe),l=this._get_or_create_queue(Je),a=this._get_or_create_queue(Ze),u=this._get_or_create_queue(Ce,[]),d=this._get_or_create_queue(be,[]);r===Ji?(c.extend(n,i),this._pop_from_people_queue(Je,i),this._pop_from_people_queue(Ze,i),this._pop_from_people_queue(pe,i)):r===Zi?(c.each(i,function(h,p){p in s||(s[p]=h)}),this._pop_from_people_queue(pe,i)):r===en?c.each(i,function(h){c.each([n,s,l,a],function(p){h in p&&delete p[h]}),c.each(d,function(p){h in p&&delete p[h]}),o[h]=!0}):r===tn?(c.each(i,function(h,p){p in n?n[p]+=h:(p in l||(l[p]=0),l[p]+=h)},this),this._pop_from_people_queue(pe,i)):r===sn?(c.each(i,function(h,p){c.isArray(h)&&(p in a||(a[p]=[]),a[p]=a[p].concat(h))}),this._pop_from_people_queue(pe,i)):r===nn?(u.push(i),this._pop_from_people_queue(be,i)):r===rn&&(d.push(i),this._pop_from_people_queue(pe,i)),$.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),$.log(t),this.save()};O.prototype._pop_from_people_queue=function(e,t){var r=this.props[this._get_queue_key(e)];c.isUndefined(r)||c.each(t,function(i,n){e===be||e===Ce?c.each(r,function(s){s[n]===i&&delete s[n]}):delete r[n]},this)};O.prototype.load_queue=function(e){return this.load_prop(this._get_queue_key(e))};O.prototype._get_queue_key=function(e){if(e===Le)return Ji;if(e===_t)return Zi;if(e===pe)return en;if(e===Je)return tn;if(e===be)return rn;if(e===Ce)return nn;if(e===Ze)return sn;$.error("Invalid queue:",e)};O.prototype._get_or_create_queue=function(e,t){var r=this._get_queue_key(e);return t=c.isUndefined(t)?{}:t,this.props[r]||(this.props[r]=t)};O.prototype.set_event_timer=function(e,t){var r=this.load_prop(Gt)||{};r[e]=t,this.props[Gt]=r,this.save()};O.prototype.remove_event_timer=function(e){var t=this.load_prop(Gt)||{},r=t[e];return c.isUndefined(r)||(delete this.props[Gt][e],this.save()),r};var on,zo=function(e,t){throw new Error(e+" not available in this build.")},Z,qo=0,w_=1,C_=function(e){return e},Vt=function(){},ue="mixpanel",Go="base64",I_="json",an="$device:",dt=A.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,Vo=!dt&&ye.indexOf("MSIE")===-1&&ye.indexOf("Mozilla")===-1,$r=null;Re.sendBeacon&&($r=function(){return Re.sendBeacon.apply(Re,arguments)});var Wo={track:"track/",engage:"engage/",groups:"groups/",record:"record/"},ks={api_host:"https://api-js.mixpanel.com",api_routes:Wo,api_method:"POST",api_transport:"XHR",api_payload_format:Go,app_host:"https://mixpanel.com",cdn:"https://cdn.mxpnl.com",cross_site_cookie:!1,cross_subdomain_cookie:!0,error_reporter:Vt,persistence:"cookie",persistence_name:"",cookie_domain:"",cookie_name:"",loaded:Vt,mp_loader:null,track_marketing:!0,track_pageview:!1,skip_first_touch_marketing:!1,store_google:!0,stop_utm_persistence:!1,save_referrer:!0,test:!1,verbose:!1,img:!1,debug:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_persistence:!1,disable_cookie:!1,secure_cookie:!1,ip:!0,opt_out_tracking_by_default:!1,opt_out_persistence_by_default:!1,opt_out_tracking_persistence_type:"localStorage",opt_out_tracking_cookie_prefix:null,property_blacklist:[],xhr_headers:{},ignore_dnt:!1,batch_requests:!0,batch_size:50,batch_flush_interval_ms:5e3,batch_request_timeout_ms:9e4,batch_autostart:!0,hooks:{},record_block_class:new RegExp("^(mp-block|fs-exclude|amp-block|rr-block|ph-no-capture)$"),record_block_selector:"img, video",record_collect_fonts:!1,record_idle_timeout_ms:30*60*1e3,record_inline_images:!1,record_mask_text_class:new RegExp("^(mp-mask|fs-mask|amp-mask|rr-mask|ph-mask)$"),record_mask_text_selector:"*",record_max_ms:Pt,record_sessions_percent:0,recorder_src:"https://cdn.mxpnl.com/libs/mixpanel-recorder.min.js"},Ko=!1,y=function(){},ki=function(e,t,r){var i,n=r===ue?Z:Z[r];if(n&&on===qo)i=n;else{if(n&&!c.isArray(n)){$.error("You have already initialized "+r);return}i=new y}if(i._cached_groups={},i._init(e,t,r),i.people=new T,i.people._init(i),!i.get_config("skip_first_touch_marketing")){var s=c.info.campaignParams(null),o={},l=!1;c.each(s,function(a,u){o["initial_"+u]=a,a&&(l=!0)}),l&&i.people.set_once(o)}return we.DEBUG=we.DEBUG||i.get_config("debug"),!c.isUndefined(n)&&c.isArray(n)&&(i._execute_array.call(i.people,n.people),i._execute_array(n)),i};y.prototype.init=function(e,t,r){if(c.isUndefined(r)){this.report_error("You must name your new library: init(token, config, name)");return}if(r===ue){this.report_error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");return}var i=ki(e,t,r);return Z[r]=i,i._loaded(),i};y.prototype._init=function(e,t,r){t=t||{},this.__loaded=!0,this.config={};var i={};if(!("api_payload_format"in t)){var n=t.api_host||ks.api_host;n.match(/\.mixpanel\.com/)&&(i.api_payload_format=I_)}if(this.set_config(c.extend({},ks,i,t,{name:r,token:e,callback_fn:(r===ue?r:ue+"."+r)+"._jsc"})),this._jsc=Vt,this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.request_batchers={},this._batch_requests=this.get_config("batch_requests"),this._batch_requests){if(!c.localStorage.is_supported(!0)||!dt)this._batch_requests=!1,$.log("Turning off Mixpanel request-queueing; needs XHR and localStorage support"),c.each(this.get_batcher_configs(),function(a){$.log("Clearing batch queue "+a.queue_key),c.localStorage.remove(a.queue_key)});else if(this.init_batchers(),$r&&A.addEventListener){var s=c.bind(function(){this.request_batchers.events.stopped||this.request_batchers.events.flush({unloading:!0})},this);A.addEventListener("pagehide",function(a){a.persisted&&s()}),A.addEventListener("visibilitychange",function(){D.visibilityState==="hidden"&&s()})}}this.persistence=this.cookie=new O(this.config),this.unpersisted_superprops={},this._gdpr_init();var o=c.UUID();this.get_distinct_id()||this.register_once({distinct_id:an+o,$device_id:o},"");var l=this.get_config("track_pageview");l&&this._init_url_change_tracking(l),this.get_config("record_sessions_percent")>0&&Math.random()*100<=this.get_config("record_sessions_percent")&&this.start_session_recording()};y.prototype.start_session_recording=Ne(function(){if(!A.MutationObserver){$.critical("Browser does not support MutationObserver; skipping session recording");return}var e=c.bind(function(){this._recorder=this._recorder||new A.__mp_recorder(this),this._recorder.startRecording()},this);c.isUndefined(A.__mp_recorder)?zo(this.get_config("recorder_src"),e):e()});y.prototype.stop_session_recording=function(){this._recorder?this._recorder.stopRecording():$.critical("Session recorder module not loaded")};y.prototype.get_session_recording_properties=function(){var e={};if(this._recorder){var t=this._recorder.replayId;t&&(e.$mp_replay_id=t)}return e};y.prototype._loaded=function(){if(this.get_config("loaded")(this),this._set_default_superprops(),this.people.set_once(this.persistence.get_referrer_info()),this.get_config("store_google")&&this.get_config("stop_utm_persistence")){var e=c.info.campaignParams(null);c.each(e,(function(t,r){this.unregister(r)}).bind(this))}};y.prototype._set_default_superprops=function(){this.persistence.update_search_keyword(D.referrer),this.get_config("store_google")&&!this.get_config("stop_utm_persistence")&&this.register(c.info.campaignParams()),this.get_config("save_referrer")&&this.persistence.update_referrer_info(D.referrer)};y.prototype._dom_loaded=function(){c.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),this.has_opted_out_tracking()||c.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue};y.prototype._track_dom=function(e,t){if(this.get_config("img"))return this.report_error("You can't use DOM tracking functions with img = true."),!1;if(!Ko)return this.__dom_loaded_queue.push([e,t]),!1;var r=new e().init(this);return r.track.apply(r,t)};y.prototype._init_url_change_tracking=function(e){var t="",r=this.track_pageview();if(r&&(t=c.info.currentUrl()),c.include(["full-url","url-with-path-and-query-string","url-with-path"],e)){A.addEventListener("popstate",function(){A.dispatchEvent(new Event("mp_locationchange"))}),A.addEventListener("hashchange",function(){A.dispatchEvent(new Event("mp_locationchange"))});var i=A.history.pushState;typeof i=="function"&&(A.history.pushState=function(s,o,l){i.call(A.history,s,o,l),A.dispatchEvent(new Event("mp_locationchange"))});var n=A.history.replaceState;typeof n=="function"&&(A.history.replaceState=function(s,o,l){n.call(A.history,s,o,l),A.dispatchEvent(new Event("mp_locationchange"))}),A.addEventListener("mp_locationchange",(function(){var s=c.info.currentUrl(),o=!1;if(e==="full-url"?o=s!==t:e==="url-with-path-and-query-string"?o=s.split("#")[0]!==t.split("#")[0]:e==="url-with-path"&&(o=s.split("#")[0].split("?")[0]!==t.split("#")[0].split("?")[0]),o){var l=this.track_pageview();l&&(t=s)}}).bind(this))}};y.prototype._prepare_callback=function(e,t){if(c.isUndefined(e))return null;if(dt){var r=function(o){e(o,t)};return r}else{var i=this._jsc,n=""+Math.floor(Math.random()*1e8),s=this.get_config("callback_fn")+"["+n+"]";return i[n]=function(o){delete i[n],e(o,t)},s}};y.prototype._send_request=function(e,t,r,i){var n=!0;if(Vo)return this.__request_queue.push(arguments),n;var s={method:this.get_config("api_method"),transport:this.get_config("api_transport"),verbose:this.get_config("verbose")},o=null;!i&&(c.isFunction(r)||typeof r=="string")&&(i=r,r=null),r=c.extend(s,r||{}),dt||(r.method="GET");var l=r.method==="POST",a=$r&&l&&r.transport.toLowerCase()==="sendbeacon",u=r.verbose;t.verbose&&(u=!0),this.get_config("test")&&(t.test=1),u&&(t.verbose=1),this.get_config("img")&&(t.img=1),dt||(i?t.callback=i:(u||this.get_config("test"))&&(t.callback="(function(){})")),t.ip=this.get_config("ip")?1:0,t._=new Date().getTime().toString(),l&&(o="data="+encodeURIComponent(t.data),delete t.data),e+="?"+c.HTTPBuildQuery(t);var d=this;if("img"in t){var h=D.createElement("img");h.src=e,D.body.appendChild(h)}else if(a){try{n=$r(e,o)}catch(S){d.report_error(S),n=!1}try{i&&i(n?1:0)}catch(S){d.report_error(S)}}else if(dt)try{var p=new XMLHttpRequest;p.open(r.method,e,!0);var f=this.get_config("xhr_headers");if(l&&(f["Content-Type"]="application/x-www-form-urlencoded"),c.each(f,function(S,b){p.setRequestHeader(b,S)}),r.timeout_ms&&typeof p.timeout<"u"){p.timeout=r.timeout_ms;var g=new Date().getTime()}p.withCredentials=!0,p.onreadystatechange=function(){if(p.readyState===4)if(p.status===200){if(i)if(u){var S;try{S=c.JSONDecode(p.responseText)}catch(w){if(d.report_error(w),r.ignore_json_errors)S=p.responseText;else return}i(S)}else i(Number(p.responseText))}else{var b;if(p.timeout&&!p.status&&new Date().getTime()-g>=p.timeout?b="timeout":b="Bad HTTP status: "+p.status+" "+p.statusText,d.report_error(b),i)if(u){var v=p.responseHeaders||{};i({status:0,httpStatusCode:p.status,error:b,retryAfter:v["Retry-After"]})}else i(0)}},p.send(o)}catch(S){d.report_error(S),n=!1}else{var _=D.createElement("script");_.type="text/javascript",_.async=!0,_.defer=!0,_.src=e;var m=D.getElementsByTagName("script")[0];m.parentNode.insertBefore(_,m)}return n};y.prototype._execute_array=function(e){var t,r=[],i=[],n=[];c.each(e,function(o){o&&(t=o[0],c.isArray(t)?n.push(o):typeof o=="function"?o.call(this):c.isArray(o)&&t==="alias"?r.push(o):c.isArray(o)&&t.indexOf("track")!==-1&&typeof this[t]=="function"?n.push(o):i.push(o))},this);var s=function(o,l){c.each(o,function(a){if(c.isArray(a[0])){var u=l;c.each(a,function(d){u=u[d[0]].apply(u,d.slice(1))})}else this[a[0]].apply(this,a.slice(1))},l)};s(r,this),s(i,this),s(n,this)};y.prototype.are_batchers_initialized=function(){return!!this.request_batchers.events};y.prototype.get_batcher_configs=function(){var e="__mpq_"+this.get_config("token"),t=this.get_config("api_routes");return this._batcher_configs=this._batcher_configs||{events:{type:"events",endpoint:"/"+t.track,queue_key:e+"_ev"},people:{type:"people",endpoint:"/"+t.engage,queue_key:e+"_pp"},groups:{type:"groups",endpoint:"/"+t.groups,queue_key:e+"_gr"}},this._batcher_configs};y.prototype.init_batchers=function(){if(!this.are_batchers_initialized()){var e=c.bind(function(r){return new fe(r.queue_key,{libConfig:this.config,errorReporter:this.get_config("error_reporter"),sendRequestFunc:c.bind(function(i,n,s){this._send_request(this.get_config("api_host")+r.endpoint,this._encode_data_for_request(i),n,this._prepare_callback(s,i))},this),beforeSendHook:c.bind(function(i){return this._run_hook("before_send_"+r.type,i)},this),stopAllBatchingFunc:c.bind(this.stop_batch_senders,this),usePersistence:!0})},this),t=this.get_batcher_configs();this.request_batchers={events:e(t.events),people:e(t.people),groups:e(t.groups)}}this.get_config("batch_autostart")&&this.start_batch_senders()};y.prototype.start_batch_senders=function(){this._batchers_were_started=!0,this.are_batchers_initialized()&&(this._batch_requests=!0,c.each(this.request_batchers,function(e){e.start()}))};y.prototype.stop_batch_senders=function(){this._batch_requests=!1,c.each(this.request_batchers,function(e){e.stop(),e.clear()})};y.prototype.push=function(e){this._execute_array([e])};y.prototype.disable=function(e){typeof e>"u"?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)};y.prototype._encode_data_for_request=function(e){var t=c.JSONEncode(e);return this.get_config("api_payload_format")===Go&&(t=c.base64Encode(t)),{data:t}};y.prototype._track_or_batch=function(e,t){var r=c.truncate(e.data,255),i=e.endpoint,n=e.batcher,s=e.should_send_immediately,o=e.send_request_options||{};t=t||Vt;var l=!0,a=c.bind(function(){return o.skip_hooks||(r=this._run_hook("before_send_"+e.type,r)),r?($.log("MIXPANEL REQUEST:"),$.log(r),this._send_request(i,this._encode_data_for_request(r),o,this._prepare_callback(t,r))):null},this);return this._batch_requests&&!s?n.enqueue(r,function(u){u?t(1,r):a()}):l=a(),l&&r};y.prototype.track=Ne(function(e,t,r,i){!i&&typeof r=="function"&&(i=r,r=null),r=r||{};var n=r.transport;n&&(r.transport=n);var s=r.send_immediately;if(typeof i!="function"&&(i=Vt),c.isUndefined(e)){this.report_error("No event name provided to mixpanel.track");return}if(this._event_is_disabled(e)){i(0);return}t=c.extend({},t),t.token=this.get_config("token");var o=this.persistence.remove_event_timer(e);if(!c.isUndefined(o)){var l=new Date().getTime()-o;t.$duration=parseFloat((l/1e3).toFixed(3))}this._set_default_superprops();var a=this.get_config("track_marketing")?c.info.marketingParams():{};t=c.extend({},c.info.properties({mp_loader:this.get_config("mp_loader")}),a,this.persistence.properties(),this.unpersisted_superprops,this.get_session_recording_properties(),t);var u=this.get_config("property_blacklist");c.isArray(u)?c.each(u,function(p){delete t[p]}):this.report_error("Invalid value for property_blacklist config: "+u);var d={event:e,properties:t},h=this._track_or_batch({type:"events",data:d,endpoint:this.get_config("api_host")+"/"+this.get_config("api_routes").track,batcher:this.request_batchers.events,should_send_immediately:s,send_request_options:r},i);return h});y.prototype.set_group=Ne(function(e,t,r){c.isArray(t)||(t=[t]);var i={};return i[e]=t,this.register(i),this.people.set(e,t,r)});y.prototype.add_group=Ne(function(e,t,r){var i=this.get_property(e),n={};return i===void 0?(n[e]=[t],this.register(n)):i.indexOf(t)===-1&&(i.push(t),n[e]=i,this.register(n)),this.people.union(e,t,r)});y.prototype.remove_group=Ne(function(e,t,r){var i=this.get_property(e);if(i!==void 0){var n=i.indexOf(t);n>-1&&(i.splice(n,1),this.register({group_key:i})),i.length===0&&this.unregister(e)}return this.people.remove(e,t,r)});y.prototype.track_with_groups=Ne(function(e,t,r,i){var n=c.extend({},t||{});return c.each(r,function(s,o){s!=null&&(n[o]=s)}),this.track(e,n,i)});y.prototype._create_map_key=function(e,t){return e+"_"+JSON.stringify(t)};y.prototype._remove_group_from_cache=function(e,t){delete this._cached_groups[this._create_map_key(e,t)]};y.prototype.get_group=function(e,t){var r=this._create_map_key(e,t),i=this._cached_groups[r];return(i===void 0||i._group_key!==e||i._group_id!==t)&&(i=new B,i._init(this,e,t),this._cached_groups[r]=i),i};y.prototype.track_pageview=Ne(function(e,t){typeof e!="object"&&(e={}),t=t||{};var r=t.event_name||"$mp_web_page_view",i=c.extend(c.info.mpPageViewProperties(),c.info.campaignParams(),c.info.clickParams()),n=c.extend({},i,e);return this.track(r,n)});y.prototype.track_links=function(){return this._track_dom.call(this,gt,arguments)};y.prototype.track_forms=function(){return this._track_dom.call(this,Vr,arguments)};y.prototype.time_event=function(e){if(c.isUndefined(e)){this.report_error("No event name provided to mixpanel.time_event");return}this._event_is_disabled(e)||this.persistence.set_event_timer(e,new Date().getTime())};var T_={persistent:!0},ln=function(e){var t;return c.isObject(e)?t=e:c.isUndefined(e)?t={}:t={days:e},c.extend({},T_,t)};y.prototype.register=function(e,t){var r=ln(t);r.persistent?this.persistence.register(e,r.days):c.extend(this.unpersisted_superprops,e)};y.prototype.register_once=function(e,t,r){var i=ln(r);i.persistent?this.persistence.register_once(e,t,i.days):(typeof t>"u"&&(t="None"),c.each(e,function(n,s){(!this.unpersisted_superprops.hasOwnProperty(s)||this.unpersisted_superprops[s]===t)&&(this.unpersisted_superprops[s]=n)},this))};y.prototype.unregister=function(e,t){t=ln(t),t.persistent?this.persistence.unregister(e):delete this.unpersisted_superprops[e]};y.prototype._register_single=function(e,t){var r={};r[e]=t,this.register(r)};y.prototype.identify=function(e,t,r,i,n,s,o,l){var a=this.get_distinct_id();if(e&&a!==e){if(typeof e=="string"&&e.indexOf(an)===0)return this.report_error("distinct_id cannot have $device: prefix"),-1;this.register({$user_id:e})}if(!this.get_property("$device_id")){var u=a;this.register_once({$had_persisted_distinct_id:!0,$device_id:u},"")}e!==a&&e!==this.get_property(Rr)&&(this.unregister(Rr),this.register({distinct_id:e})),this._flags.identify_called=!0,this.people._flush(t,r,i,n,s,o,l),e!==a&&this.track("$identify",{distinct_id:e,$anon_distinct_id:a},{skip_hooks:!0})};y.prototype.reset=function(){this.persistence.clear(),this._flags.identify_called=!1;var e=c.UUID();this.register_once({distinct_id:an+e,$device_id:e},"")};y.prototype.get_distinct_id=function(){return this.get_property("distinct_id")};y.prototype.alias=function(e,t){if(e===this.get_property(jo))return this.report_error("Attempting to create alias for existing People user - aborting."),-2;var r=this;return c.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(Rr,e),this.track("$create_alias",{alias:e,distinct_id:t},{skip_hooks:!0},function(){r.identify(e)})):(this.report_error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)};y.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)};y.prototype.set_config=function(e){if(c.isObject(e)){c.extend(this.config,e);var t=e.batch_size;t&&c.each(this.request_batchers,function(r){r.resetBatchSize()}),this.get_config("persistence_name")||(this.config.persistence_name=this.config.cookie_name),this.get_config("disable_persistence")||(this.config.disable_persistence=this.config.disable_cookie),this.persistence&&this.persistence.update_config(this.config),we.DEBUG=we.DEBUG||this.get_config("debug")}};y.prototype.get_config=function(e){return this.config[e]};y.prototype._run_hook=function(e){var t=(this.config.hooks[e]||C_).apply(this,Me.call(arguments,1));return typeof t>"u"&&(this.report_error(e+" hook did not return a value"),t=null),t};y.prototype.get_property=function(e){return this.persistence.load_prop([e])};y.prototype.toString=function(){var e=this.get_config("name");return e!==ue&&(e=ue+"."+e),e};y.prototype._event_is_disabled=function(e){return c.isBlockedUA(ye)||this._flags.disable_all_events||c.include(this.__disabled_events,e)};y.prototype._gdpr_init=function(){var e=this.get_config("opt_out_tracking_persistence_type")==="localStorage";e&&c.localStorage.is_supported()&&(!this.has_opted_in_tracking()&&this.has_opted_in_tracking({persistence_type:"cookie"})&&this.opt_in_tracking({enable_persistence:!1}),!this.has_opted_out_tracking()&&this.has_opted_out_tracking({persistence_type:"cookie"})&&this.opt_out_tracking({clear_persistence:!1}),this.clear_opt_in_out_tracking({persistence_type:"cookie",enable_persistence:!1})),this.has_opted_out_tracking()?this._gdpr_update_persistence({clear_persistence:!0}):!this.has_opted_in_tracking()&&(this.get_config("opt_out_tracking_by_default")||c.cookie.get("mp_optout"))&&(c.cookie.remove("mp_optout"),this.opt_out_tracking({clear_persistence:this.get_config("opt_out_persistence_by_default")}))};y.prototype._gdpr_update_persistence=function(e){var t;if(e&&e.clear_persistence)t=!0;else if(e&&e.enable_persistence)t=!1;else return;!this.get_config("disable_persistence")&&this.persistence.disabled!==t&&this.persistence.set_disabled(t),t?this.stop_batch_senders():this._batchers_were_started&&this.start_batch_senders()};y.prototype._gdpr_call_func=function(e,t){return t=c.extend({track:c.bind(this.track,this),persistence_type:this.get_config("opt_out_tracking_persistence_type"),cookie_prefix:this.get_config("opt_out_tracking_cookie_prefix"),cookie_expiration:this.get_config("cookie_expiration"),cross_site_cookie:this.get_config("cross_site_cookie"),cross_subdomain_cookie:this.get_config("cross_subdomain_cookie"),cookie_domain:this.get_config("cookie_domain"),secure_cookie:this.get_config("secure_cookie"),ignore_dnt:this.get_config("ignore_dnt")},t),c.localStorage.is_supported()||(t.persistence_type="cookie"),e(this.get_config("token"),{track:t.track,trackEventName:t.track_event_name,trackProperties:t.track_properties,persistenceType:t.persistence_type,persistencePrefix:t.cookie_prefix,cookieDomain:t.cookie_domain,cookieExpiration:t.cookie_expiration,crossSiteCookie:t.cross_site_cookie,crossSubdomainCookie:t.cross_subdomain_cookie,secureCookie:t.secure_cookie,ignoreDnt:t.ignore_dnt})};y.prototype.opt_in_tracking=function(e){e=c.extend({enable_persistence:!0},e),this._gdpr_call_func(u_,e),this._gdpr_update_persistence(e)};y.prototype.opt_out_tracking=function(e){e=c.extend({clear_persistence:!0,delete_user:!0},e),e.delete_user&&this.people&&this.people._identify_called()&&(this.people.delete_user(),this.people.clear_charges()),this._gdpr_call_func(d_,e),this._gdpr_update_persistence(e)};y.prototype.has_opted_in_tracking=function(e){return this._gdpr_call_func(h_,e)};y.prototype.has_opted_out_tracking=function(e){return this._gdpr_call_func(Po,e)};y.prototype.clear_opt_in_out_tracking=function(e){e=c.extend({enable_persistence:!0},e),this._gdpr_call_func(p_,e),this._gdpr_update_persistence(e)};y.prototype.report_error=function(e,t){$.error.apply($.error,arguments);try{!t&&!(e instanceof Error)&&(e=new Error(e)),this.get_config("error_reporter")(e,t)}catch(r){$.error(r)}};y.prototype.init=y.prototype.init;y.prototype.reset=y.prototype.reset;y.prototype.disable=y.prototype.disable;y.prototype.time_event=y.prototype.time_event;y.prototype.track=y.prototype.track;y.prototype.track_links=y.prototype.track_links;y.prototype.track_forms=y.prototype.track_forms;y.prototype.track_pageview=y.prototype.track_pageview;y.prototype.register=y.prototype.register;y.prototype.register_once=y.prototype.register_once;y.prototype.unregister=y.prototype.unregister;y.prototype.identify=y.prototype.identify;y.prototype.alias=y.prototype.alias;y.prototype.name_tag=y.prototype.name_tag;y.prototype.set_config=y.prototype.set_config;y.prototype.get_config=y.prototype.get_config;y.prototype.get_property=y.prototype.get_property;y.prototype.get_distinct_id=y.prototype.get_distinct_id;y.prototype.toString=y.prototype.toString;y.prototype.opt_out_tracking=y.prototype.opt_out_tracking;y.prototype.opt_in_tracking=y.prototype.opt_in_tracking;y.prototype.has_opted_out_tracking=y.prototype.has_opted_out_tracking;y.prototype.has_opted_in_tracking=y.prototype.has_opted_in_tracking;y.prototype.clear_opt_in_out_tracking=y.prototype.clear_opt_in_out_tracking;y.prototype.get_group=y.prototype.get_group;y.prototype.set_group=y.prototype.set_group;y.prototype.add_group=y.prototype.add_group;y.prototype.remove_group=y.prototype.remove_group;y.prototype.track_with_groups=y.prototype.track_with_groups;y.prototype.start_batch_senders=y.prototype.start_batch_senders;y.prototype.stop_batch_senders=y.prototype.stop_batch_senders;y.prototype.start_session_recording=y.prototype.start_session_recording;y.prototype.stop_session_recording=y.prototype.stop_session_recording;y.prototype.get_session_recording_properties=y.prototype.get_session_recording_properties;y.prototype.DEFAULT_API_ROUTES=Wo;O.prototype.properties=O.prototype.properties;O.prototype.update_search_keyword=O.prototype.update_search_keyword;O.prototype.update_referrer_info=O.prototype.update_referrer_info;O.prototype.get_cross_subdomain=O.prototype.get_cross_subdomain;O.prototype.clear=O.prototype.clear;var ct={},A_=function(){c.each(ct,function(e,t){t!==ue&&(Z[t]=e)}),Z._=c},E_=function(){Z.init=function(e,t,r){if(r)return Z[r]||(Z[r]=ct[r]=ki(e,t,r),Z[r]._loaded()),Z[r];var i=Z;ct[ue]?i=ct[ue]:e&&(i=ki(e,t,ue),i._loaded(),ct[ue]=i),Z=i,on===w_&&(A[ue]=Z),A_()}},O_=function(){function e(){e.done||(e.done=!0,Ko=!0,Vo=!1,c.each(ct,function(i){i._dom_loaded()}))}function t(){try{D.documentElement.doScroll("left")}catch{setTimeout(t,1);return}e()}if(D.addEventListener)D.readyState==="complete"?e():D.addEventListener("DOMContentLoaded",e,!1);else if(D.attachEvent){D.attachEvent("onreadystatechange",e);var r=!1;try{r=A.frameElement===null}catch{}D.documentElement.doScroll&&r&&t()}c.register_event(A,"load",e,!0)};function x_(e){return zo=e,on=qo,Z=new y,E_(),Z.init(),O_(),Z}function k_(e,t){t()}var M_=x_(k_),Qo=M_;const Xo=Pi(Qo),R_=ia({__proto__:null,default:Xo},[Qo]),$_=Xo||R_;let hr;const Ge={VISUAL_SDK_RENDER_START:"visual-sdk-render-start",VISUAL_SDK_CALLED_INIT:"visual-sdk-called-init",VISUAL_SDK_RENDER_COMPLETE:"visual-sdk-render-complete",VISUAL_SDK_RENDER_FAILED:"visual-sdk-render-failed",VISUAL_SDK_TRIGGER:"visual-sdk-trigger",VISUAL_SDK_ON:"visual-sdk-on",VISUAL_SDK_IFRAME_LOAD_PERFORMANCE:"visual-sdk-iframe-load-performance",VISUAL_SDK_EMBED_CREATE:"visual-sdk-embed-create",VERCEL_INTEGRATION_COMPLETED:"vercel-integration-completed"};let cn=!1,Mi=[];function Oe(e,t={}){if(!cn){Mi.push({eventId:e,eventProps:t});return}hr.track(e,t)}function D_(){cn&&(Mi.forEach(e=>{Oe(e.eventId,e.eventProps)}),Mi=[])}function L_(e){var t;if(!e||!e.mixpanelToken)return;const r=!!e.isPublicUser,i=e.mixpanelToken;try{i&&(hr=$_.init(i,void 0,"tsEmbed"),r||hr.identify(e.userGUID),hr.register_once({clusterId:e.clusterId,clusterName:e.clusterName,releaseVersion:e.releaseVersion,hostAppUrl:((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.host)||""}),cn=!0,D_())}catch(n){K.error("Error initializing mixpanel",n)}}var Yo={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function n(a,u,d){this.fn=a,this.context=u,this.once=d||!1}function s(a,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var f=new n(d,h||a,p),g=r?r+u:u;return a._events[g]?a._events[g].fn?a._events[g]=[a._events[g],f]:a._events[g].push(f):(a._events[g]=f,a._eventsCount++),a}function o(a,u){--a._eventsCount===0?a._events=new i:delete a._events[u]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,f=h.length,g=new Array(f);p<f;p++)g[p]=h[p].fn;return g},l.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,p,f,g){var _=r?r+u:u;if(!this._events[_])return!1;var m=this._events[_],S=arguments.length,b,v;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),S){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,h),!0;case 4:return m.fn.call(m.context,d,h,p),!0;case 5:return m.fn.call(m.context,d,h,p,f),!0;case 6:return m.fn.call(m.context,d,h,p,f,g),!0}for(v=1,b=new Array(S-1);v<S;v++)b[v-1]=arguments[v];m.fn.apply(m.context,b)}else{var w=m.length,C;for(v=0;v<w;v++)switch(m[v].once&&this.removeListener(u,m[v].fn,void 0,!0),S){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,d);break;case 3:m[v].fn.call(m[v].context,d,h);break;case 4:m[v].fn.call(m[v].context,d,h,p);break;default:if(!b)for(C=1,b=new Array(S-1);C<S;C++)b[C-1]=arguments[C];m[v].fn.apply(m[v].context,b)}}return!0},l.prototype.on=function(u,d,h){return s(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return s(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,p){var f=r?r+u:u;if(!this._events[f])return this;if(!d)return o(this,f),this;var g=this._events[f];if(g.fn)g.fn===d&&(!p||g.once)&&(!h||g.context===h)&&o(this,f);else{for(var _=0,m=[],S=g.length;_<S;_++)(g[_].fn!==d||p&&!g[_].once||h&&g[_].context!==h)&&m.push(g[_]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Yo);var N_=Yo.exports;const P_=Pi(N_);function U_(e,t={}){return zi(e,t).then(async r=>{var i;return!r.ok&&r.type!=="opaqueredirect"&&r.type!=="opaque"&&K.error("Failure",await((i=r.text)===null||i===void 0?void 0:i.call(r))),r})}function F_(e){return U_(e,{credentials:"include"})}let re=!1,lr=null,gi=null,kt=null,Jo=null;new Promise(e=>{Jo=e});let H_="";const Wr="5e16222e-ef02-43e9-9fbd-24226bf3ce5b";var et;(function(e){e.SDK="SDK",e.NO_COOKIE_ACCESS="NO_COOKIE_ACCESS",e.EXPIRY="EXPIRY",e.OTHER="OTHER"})(et||(et={}));var tt;(function(e){e.FAILURE="FAILURE",e.SDK_SUCCESS="SDK_SUCCESS",e.SUCCESS="SUCCESS",e.LOGOUT="LOGOUT",e.WAITING_FOR_POPUP="WAITING_FOR_POPUP"})(tt||(tt={}));var Ri;(function(e){e.TRIGGER_SSO_POPUP="TRIGGER_SSO_POPUP"})(Ri||(Ri={}));let ie;function B_(e){ie=e}function j_(){if(!ie){K.error("SDK not initialized");return}ie.emit(tt.SDK_SUCCESS)}function z_(){if(!ie){K.error("SDK not initialized");return}ie.emit(tt.SUCCESS,kt)}function Wt(e){if(!ie){K.error("SDK not initialized");return}ie.emit(tt.FAILURE,e)}function q_(){if(!ie){K.error("SDK not initialized");return}ie.emit(tt.LOGOUT)}const Zo=e=>{const t=ae();kt==null&&(kt=e,t.disableSDKTracking||L_(kt),Jo(kt))},G_=e=>{const t=e.configInfo.mixpanelConfig.devSdkKey,r=e.configInfo.mixpanelConfig.prodSdkKey,i=e.configInfo.mixpanelConfig.production?r:t;return{userGUID:e.userGUID,mixpanelToken:i,isPublicUser:e.configInfo.isPublicUser,releaseVersion:e.releaseVersion,clusterId:e.configInfo.selfClusterId,clusterName:e.configInfo.selfClusterName,...e}};async function mt(e){const t=`${e}${rt.AUTH_VERIFICATION}`;let r=null;try{r=await F_(t);const i=await r.json(),n=G_(i);Zo(n),H_=i.releaseVersion}catch{return!1}return r.status===200}function Ms(){return window.location.href.indexOf(Wr)>=0}function Rs(){window.location.hash=window.location.hash.replace(Wr,"")}const V_=async e=>{const{thoughtSpotHost:t,username:r,authEndpoint:i,getAuthToken:n}=e;if(!i&&!n)throw new Error("Either auth endpoint or getAuthToken function must be provided");if(re=await mt(t),!re){const s=await jt(e);let o;try{o=await If(t,r,s)}catch{o=await Cf(t,r,s)}re=o.ok||o.type==="opaqueredirect",re&&e.detectCookieAccessSlow&&(re=await mt(t))}return re},W_=async e=>{const{authEndpoint:t,getAuthToken:r}=e;if(!t&&!r)throw new Error("Either auth endpoint or getAuthToken function must be provided");let i=!1;try{await jt(e)&&(i=!0)}catch{i=!1}return i},K_=async e=>{const{thoughtSpotHost:t,username:r,password:i}=e;return await mt(t)?re=!0:(re=(await Tf(t,r,i)).ok,e.detectCookieAccessSlow&&(re=await mt(t))),re};async function Q_(e,t,r){const i=()=>{lr===null||lr.closed?lr=window.open(e,"_blank","location=no,height=570,width=520,scrollbars=yes,status=yes"):lr.focus()};ie==null||ie.emit(tt.WAITING_FOR_POPUP);const n=Ws(t);if(n){n.innerHTML='<button id="ts-auth-btn" class="ts-auth-btn" style="margin: auto;"></button>';const s=document.getElementById("ts-auth-btn");s.textContent=r,s.addEventListener("click",i,{once:!0})}return gi=gi||new Promise((s,o)=>{window.addEventListener("message",l=>{l.data.type===H.SAMLComplete&&(l.source.close(),s())})}),ie==null||ie.once(Ri.TRIGGER_SSO_POPUP,i),gi}const ea=async(e,t)=>{const{thoughtSpotHost:r}=e;if(await mt(r)){Ms()&&Rs(),re=!0;return}if(Ms()){Rs(),re=!1;return}const n=`${r}${t}`;if(e.inPopup){await Q_(n,e.authTriggerContainer,e.authTriggerText),re=await mt(r);return}window.location.href=n},X_=async e=>{const{thoughtSpotHost:t}=e,r=e.inPopup?`${t}/v2/#/embed/saml-complete`:Vs(window.location.href,Wr,e.redirectPath),i=`${rt.SAML_LOGIN_TEMPLATE(encodeURIComponent(r))}`;return await ea(e,i),re},Y_=async e=>{const{thoughtSpotHost:t}=e,r=e.noRedirect||e.inPopup?`${t}/v2/#/embed/saml-complete`:Vs(window.location.href,Wr,e.redirectPath),i=`${rt.OIDC_LOGIN_TEMPLATE(encodeURIComponent(r))}`;return await ea(e,i),re},J_=async e=>{const{authType:t}=e;switch(t){case Q.SSO:case Q.SAMLRedirect:case Q.SAML:return X_(e);case Q.OIDC:case Q.OIDCRedirect:return Y_(e);case Q.AuthServer:case Q.TrustedAuthToken:return V_(e);case Q.TrustedAuthTokenCookieless:return W_(e);case Q.Basic:return K_(e);default:return Promise.resolve(!0)}},Z_={loginFailedMessage:"Not logged in",authTriggerText:"Authorize",authType:Q.None,logLevel:z.ERROR};let pr;const em=()=>pr,ta=()=>(pr=J_(ae()),pr.then(e=>{e?j_():Wt(et.SDK)},()=>{Wt(et.SDK)}),pr),tm={[We.SearchEmbed]:e=>`${e}v2/#/embed/answer`,[We.LiveboardEmbed]:e=>e,[We.FullApp]:e=>e,[We.VizEmbed]:e=>e},rm=(e,t)=>{if(e==="")K.warn("The prefetch method does not have a valid URL");else{const r=[We.FullApp];let i=e||ae().thoughtSpotHost;i=i[i.length-1]==="/"?i:`${i}/`,Array.from(new Set(r.map(n=>tm[n](i)))).forEach((n,s)=>{const o=document.createElement("iframe");o.src=n,o.style.width="0",o.style.height="0",o.style.border="0",o.classList.add("prefetchIframe"),o.classList.add(`prefetchIframeNum-${s}`),document.body.appendChild(o)})}};function im(e){if(e.thoughtSpotHost===void 0)throw new Error("ThoughtSpot host not provided");if(e.authType===Q.TrustedAuthToken&&!e.authEndpoint&&typeof e.getAuthToken!="function")throw new Error("Trusted auth should provide either authEndpoint or getAuthToken")}function nm(e){const t={...e};return e.noRedirect!==void 0&&e.inPopup===void 0&&(t.inPopup=e.noRedirect),t}const sm=e=>{var t,r,i,n,s,o,l,a,u,d,h;im(e),ji(),e=Ef(nm({...Z_,...e,thoughtSpotHost:qi(e)})),qa(e.logLevel);const p=new P_;B_(p),ta();const{password:f,...g}=ae();return Oe(Ge.VISUAL_SDK_CALLED_INIT,{...g,usedCustomizationSheet:((r=(t=e.customizations)===null||t===void 0?void 0:t.style)===null||r===void 0?void 0:r.customCSSUrl)!=null,usedCustomizationVariables:((s=(n=(i=e.customizations)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.customCSS)===null||s===void 0?void 0:s.variables)!=null,usedCustomizationRules:((a=(l=(o=e.customizations)===null||o===void 0?void 0:o.style)===null||l===void 0?void 0:l.customCSS)===null||a===void 0?void 0:a.rules_UNSTABLE)!=null,usedCustomizationStrings:!!(!((d=(u=e.customizations)===null||u===void 0?void 0:u.content)===null||d===void 0)&&d.strings),usedCustomizationIconSprite:!!(!((h=e.customizations)===null||h===void 0)&&h.iconSpriteUrl)}),ae().callPrefetch&&rm(ae().thoughtSpotHost),p};function om(){ae().autoLogin=!1}let _i=Promise.resolve();const am=e=>{const{queueMultiRenders:t=!1}=ae();return t?(_i=_i.then(()=>new Promise(r=>e(r))),_i):e(()=>{})};function lm(e,t){const{session:r,embedAnswerData:i,contextMenuPoints:n}=e.data,s=new Br(r,i||{},t,n==null?void 0:n.selectedPoints);return{...e,answerService:s}}function cm(e){var t,r;return Zo(e.data),z_(),{...e,data:{userGUID:((t=e.data)===null||t===void 0?void 0:t.userGUID)||((r=e.payload)===null||r===void 0?void 0:r.userGUID)}}}function um(e,t){const{loginFailedMessage:r,suppressNoCookieAccessAlert:i,ignoreNoCookieAccess:n,suppressErrorAlerts:s}=ae();return n||(!i&&!s&&alert("Third party cookie access is blocked on this browser, please allow third party cookies for this to work properly. \nYou can use `suppressNoCookieAccessAlert` to suppress this message."),t.innerHTML=r),Wt(et.NO_COOKIE_ACCESS),e}function $i(e,t){const{loginFailedMessage:r,authType:i}=ae();return i!==Q.None&&(t.innerHTML=r,Wt(et.OTHER)),ji(),e}function dm(e,t){const{loginFailedMessage:r}=ae();return t.innerHTML=r,ji(),om(),q_(),e}function hm(e,t,r,i){switch(e){case H.CustomAction:return lm(t,r);case H.AuthInit:return cm(t);case H.NoCookieAccess:return um(t,i);case H.AuthFailure:return $i(t,i);case H.AuthLogout:return dm(t,i)}return t}const pm=e=>{const t=e.src;e.src="",setTimeout(()=>{e.src=t},100)};function fm(e,t,r,i){return e.contentWindow.postMessage(t,r,[i==null?void 0:i.port2])}const gm=3e4;function _m(e,t,r,i){return new Promise((n,s)=>{if(t===De.Reload)return pm(e),n(null);const o=new MessageChannel;return o.port1.onmessage=({data:l})=>{o.port1.close(),l.error?s(l.error):n(l)},setTimeout(()=>{o.port1.close(),n(new Error(Sr.TRIGGER_TIMED_OUT))},gm),fm(e,{type:t,data:i},r,o)})}const mm="@thoughtspot/visual-embed-sdk",ym="1.31.2",vm="ThoughtSpot Embed SDK",bm="lib/src/index.js",Sm="dist/tsembed.js",wm="lib/src/index.d.ts",Cm=["dist/**","lib/**","src/**","cjs/**"],Im={".":{import:"./lib/src/index.js",require:"./cjs/src/index.js",types:"./lib/src/index.d.ts"},"./react":{import:"./lib/src/react/all-types-export.js",require:"./cjs/src/react/all-types-export.js",types:"./lib/src/react/all-types-export.d.ts"},"./lib/src/react":{import:"./lib/src/react/all-types-export.js",require:"./cjs/src/react/all-types-export.js",types:"./lib/src/react/all-types-export.d.ts"}},Tm={"*":{react:["./lib/src/react/all-types-export.d.ts"]}},Am={lint:"eslint 'src/**'","lint:fix":"eslint 'src/**/*.*' --fix",tsc:"tsc -p . --incremental false; tsc -p . --incremental false --module commonjs --outDir cjs",start:"gatsby develop","build:gatsby":"npm run clean:gatsby && gatsby build --prefix-paths","build:gatsby:noprefix":"npm run clean:gatsby && gatsby build","serve:gatsby":"gatsby serve","clean:gatsby":"gatsby clean","build-and-publish":"npm run build:gatsby && npm run publish","bundle-dts-file":"dts-bundle --name @thoughtspot/visual-embed-sdk --out visual-embed-sdk.d.ts --main lib/src/index.d.ts","bundle-dts":"dts-bundle --name ../../dist/visual-embed-sdk --main lib/src/index.d.ts --outputAsModuleFolder=true","bundle-dts-react":"dts-bundle --name ../../../dist/visual-embed-sdk-react --main lib/src/react/index.d.ts --outputAsModuleFolder=true","bundle-dts-react-full":"dts-bundle --name ../../../dist/visual-embed-sdk-react-full --main lib/src/react/all-types-export.d.ts --outputAsModuleFolder=true",build:"rollup -c",watch:"rollup -cw","docs-cmd":"node scripts/gatsby-commands.js",docgen:"typedoc --tsconfig tsconfig.json --theme typedoc-theme","test-sdk":"jest -c jest.config.sdk.js --runInBand","test-docs":"jest -c jest.config.docs.js",test:"npm run test-sdk && npm run test-docs",posttest:"cat ./coverage/sdk/lcov.info | coveralls","is-publish-allowed":"node scripts/is-publish-allowed.js",prepublishOnly:"npm run is-publish-allowed && npm run test && npm run tsc && npm run bundle-dts-file && npm run bundle-dts && npm run bundle-dts-react && npm run bundle-dts-react-full && npm run build","check-size":"npm run build && size-limit","publish-dev":"npm publish --tag dev","publish-prod":"npm publish --tag latest"},Em={react:"> 16.8.0","react-dom":"> 16.8.0"},Om={algoliasearch:"^4.10.5",classnames:"^2.3.1",dompurify:"^2.3.4","eslint-plugin-comment-length":"^0.9.2","eslint-plugin-jsdoc":"^46.9.0",eventemitter3:"^4.0.7","gatsby-plugin-vercel":"^1.0.3","html-react-parser":"^1.4.12",lodash:"^4.17.21","mixpanel-browser":"^2.45.0","ts-deepmerge":"^6.0.2",tslib:"^2.5.3","use-deep-compare-effect":"^1.8.1"},xm={"@mdx-js/mdx":"^1.6.22","@mdx-js/react":"^1.6.22","@react-icons/all-files":"^4.1.0","@rollup/plugin-commonjs":"^18.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.1","@rollup/plugin-replace":"^5.0.2","@size-limit/preset-big-lib":"^8.2.6","@testing-library/dom":"^7.31.0","@testing-library/jest-dom":"^5.14.1","@testing-library/react":"^11.2.7","@testing-library/user-event":"^13.1.8","@types/jest":"^22.2.3","@types/mixpanel-browser":"^2.35.6","@types/react-test-renderer":"^17.0.1","@typescript-eslint/eslint-plugin":"^4.6.0","@typescript-eslint/parser":"^4.6.0",asciidoctor:"^2.2.1","babel-jest":"^26.6.3","babel-preset-gatsby":"^1.10.0","command-line-args":"^5.1.1",coveralls:"^3.1.0","current-git-branch":"^1.1.0","dts-bundle":"^0.7.3",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.2.0","eslint-config-prettier":"^6.15.0","eslint-import-resolver-typescript":"^2.3.0","eslint-plugin-import":"^2.22.1","eslint-plugin-prettier":"^3.1.4","eslint-plugin-react-hooks":"^4.2.0","fs-extra":"^10.0.0",gatsby:"3.13.1","gatsby-plugin-algolia":"^0.22.2","gatsby-plugin-catch-links":"^3.1.0","gatsby-plugin-env-variables":"^2.1.0","gatsby-plugin-intl":"^0.3.3","gatsby-plugin-manifest":"^3.2.0","gatsby-plugin-output":"^0.1.3","gatsby-plugin-sass":"6.7.0","gatsby-plugin-sitemap":"^4.10.0","gatsby-source-filesystem":"3.1.0","gatsby-transformer-asciidoc":"2.1.0","gatsby-transformer-rehype":"2.0.0","gh-pages":"^3.1.0","highlight.js":"^10.6.0","html-to-text":"^8.0.0","identity-obj-proxy":"^3.0.0","istanbul-merge":"^1.1.1",jest:"^26.6.3","jest-fetch-mock":"^3.0.3",jsdom:"^17.0.0","node-sass":"^8.0.0",prettier:"2.1.2",react:"^16.14.0","react-dom":"^16.14.0","react-resizable":"^1.11.0","react-resize-detector":"^6.6.0","react-test-renderer":"^17.0.2","react-use-flexsearch":"^0.1.1",rollup:"2.30.0","rollup-plugin-typescript2":"0.27.3","ts-jest":"^26.5.5","ts-loader":"8.0.4",typedoc:"0.21.6","typedoc-plugin-toc-group":"thoughtspot/typedoc-plugin-toc-group",typescript:"^4.9.4","url-search-params-polyfill":"^8.1.0",util:"^0.12.4"},km="ThoughtSpot",Mm="support@thoughtspot.com",Rm="ThoughtSpot Development Tools End User License Agreement",$m={lib:"lib"},Dm={type:"git",url:"git+https://github.com/thoughtspot/visual-embed-sdk.git"},Lm={registry:"https://registry.npmjs.org"},Nm=["thoughtspot","everywhere","embedded","embed","sdk","analytics"],Pm={url:"https://github.com/thoughtspot/visual-embed-sdk/issues"},Um="https://github.com/thoughtspot/visual-embed-sdk#readme",Fm={window:{}},Hm={name:mm,version:ym,description:vm,module:bm,main:Sm,types:wm,files:Cm,exports:Im,typesVersions:Tm,"size-limit":[{path:"dist/tsembed.js",limit:"45 kB"}],scripts:Am,peerDependencies:Em,dependencies:Om,devDependencies:xm,author:km,email:Mm,license:Rm,directories:$m,repository:Dm,publishConfig:Lm,keywords:Nm,bugs:Pm,homepage:Um,globals:Fm},{version:Bm}=Hm,jm="ts-",mi="_thoughtspot-embed",zm={};class qm{constructor(t,r){this.embedNodeKey="__tsEmbed",this.isAppInitialized=!1,this.shouldEncodeUrlQueryParams=!1,this.defaultHiddenActions=[ke.ReportError],this.subscribedListeners={},this.appInitCb=async(i,n)=>{var s,o;let l="";if(this.embedConfig.authType===Q.TrustedAuthTokenCookieless)try{l=await jt(this.embedConfig)}catch(a){$i(a,this.isPreRendered?this.preRenderWrapper:this.el);return}this.isAppInitialized=!0,n({type:H.APP_INIT,data:{customisations:Pa(this.embedConfig,this.viewConfig),authToken:l,runtimeFilterParams:this.viewConfig.excludeRuntimeFiltersfromURL?Ua(this.viewConfig.runtimeFilters):null,runtimeParameterParams:this.viewConfig.excludeRuntimeParametersfromURL?qs(this.viewConfig.runtimeParameters||[]):null,hiddenHomepageModules:this.viewConfig.hiddenHomepageModules||[],reorderedHomepageModules:this.viewConfig.reorderedHomepageModules||[],hostConfig:this.embedConfig.hostConfig,hiddenHomeLeftNavItems:!((s=this.viewConfig)===null||s===void 0)&&s.hiddenHomeLeftNavItems?(o=this.viewConfig)===null||o===void 0?void 0:o.hiddenHomeLeftNavItems:[]}})},this.updateAuthToken=async(i,n)=>{const{autoLogin:s=!1,authType:o}=this.embedConfig;if(o===Q.TrustedAuthTokenCookieless){let l="";try{l=await jt(this.embedConfig),n({type:H.AuthExpire,data:{authToken:l}})}catch(a){$i(a,this.isPreRendered?this.preRenderWrapper:this.el)}}else s&&ta();Wt(et.EXPIRY)},this.registerAppInit=()=>{this.on(H.APP_INIT,this.appInitCb,{start:!1},!0),this.on(H.AuthExpire,this.updateAuthToken,{start:!1},!0)},this.showPreRenderByDefault=!1,this.validatePreRenderViewConfig=i=>{var n;const s=["preRenderId","vizId","liveboardId"],o=(n=this.insertedDomEl)===null||n===void 0?void 0:n[this.embedNodeKey];o&&i.preRenderId&&Object.keys(i).filter(a=>!s.includes(a)&&!a.startsWith("on")).forEach(a=>{!_r(i[a])&&!bf(i[a],o.viewConfig[a])&&K.warn(`${i.embedComponentType||"Component"} was pre-rendered with "${a}" as "${JSON.stringify(o.viewConfig[a])}" but a different value "${JSON.stringify(i[a])}" was passed to the Embed component. The new value provided is ignored, the value provided during preRender is used.`)})},this.el=Ws(t),this.embedConfig=ae(),!this.embedConfig.authTriggerContainer&&!this.embedConfig.useEventForSAMLPopup&&(this.embedConfig.authTriggerContainer=t),this.thoughtSpotHost=qi(this.embedConfig),this.thoughtSpotV2Base=Uf(this.embedConfig),this.eventHandlerMap=new Map,this.isError=!1,this.viewConfig={excludeRuntimeFiltersfromURL:!1,excludeRuntimeParametersfromURL:!1,...r},this.shouldEncodeUrlQueryParams=this.embedConfig.shouldEncodeUrlQueryParams,this.registerAppInit(),Oe(Ge.VISUAL_SDK_EMBED_CREATE,{...r})}throwInitError(){this.handleError("You need to init the ThoughtSpot SDK module first")}handleError(t){this.isError=!0,this.executeCallbacks(H.Error,{error:t}),K.error(t)}getEventType(t){var r,i;return((r=t.data)===null||r===void 0?void 0:r.type)||((i=t.data)===null||i===void 0?void 0:i.__type)}getEventPort(t){return t.ports.length&&t.ports[0]?t.ports[0]:null}formatEventData(t,r){const i={...t.data,type:r};return i.data||(i.data=t.data.payload),i}subscribeToEvents(){this.unsubscribeToEvents();const t=n=>{const s=this.getEventType(n),o=this.getEventPort(n),l=this.formatEventData(n,s);n.source===this.iFrame.contentWindow&&this.executeCallbacks(s,hm(s,l,this.thoughtSpotHost,this.isPreRendered?this.preRenderWrapper:this.el),o)};window.addEventListener("message",t);const r=n=>{this.trigger(De.Reload)};window.addEventListener("online",r);const i=n=>{const s="Network not Detected. Embed is offline. Please reconnect and refresh";this.executeCallbacks(H.Error,{offlineWarning:s}),K.warn(s)};window.addEventListener("offline",i),this.subscribedListeners={message:t,online:r,offline:i}}unsubscribeToEvents(){Object.keys(this.subscribedListeners).forEach(t=>{window.removeEventListener(t,this.subscribedListeners[t])})}getEmbedBasePath(t){let r=t.startsWith("?")?t:`?${t}`;return this.shouldEncodeUrlQueryParams&&(r=`?base64UrlEncodedFlags=${An(r.substr(1))}`),`${[this.thoughtSpotHost,this.thoughtSpotV2Base,r].filter(n=>n.length>0).join("/")}#`}getBaseQueryParams(t={}){var r,i,n,s;let o=((r=window==null?void 0:window.location)===null||r===void 0?void 0:r.host)||"";(o.includes("localhost")||o.includes("127.0.0.1"))&&(o="local-host"),t[I.HostAppUrl]=encodeURIComponent(o),t[I.ViewPortHeight]=window.innerHeight,t[I.ViewPortWidth]=window.innerWidth,t[I.Version]=Bm,t[I.AuthType]=this.embedConfig.authType,t[I.blockNonEmbedFullAppAccess]=(i=this.embedConfig.blockNonEmbedFullAppAccess)!==null&&i!==void 0?i:!0,(this.embedConfig.disableLoginRedirect===!0||this.embedConfig.autoLogin===!0)&&(t[I.DisableLoginRedirect]=!0),this.embedConfig.authType===Q.EmbeddedSSO&&(t[I.ForceSAMLAutoRedirect]=!0),this.embedConfig.authType===Q.TrustedAuthTokenCookieless&&(t[I.cookieless]=!0),this.embedConfig.pendoTrackingKey&&(t[I.PendoTrackingKey]=this.embedConfig.pendoTrackingKey),this.embedConfig.numberFormatLocale&&(t[I.NumberFormatLocale]=this.embedConfig.numberFormatLocale),this.embedConfig.dateFormatLocale&&(t[I.DateFormatLocale]=this.embedConfig.dateFormatLocale),this.embedConfig.currencyFormat&&(t[I.CurrencyFormat]=this.embedConfig.currencyFormat);const{disabledActions:l,disabledActionReason:a,hiddenActions:u,visibleActions:d,hiddenTabs:h,visibleTabs:p,showAlerts:f,additionalFlags:g,locale:_,customizations:m,contextMenuTrigger:S,linkOverride:b,insertInToSlide:v}=this.viewConfig;if(Array.isArray(d)&&Array.isArray(u))return this.handleError("You cannot have both hidden actions and visible actions"),t;if(Array.isArray(p)&&Array.isArray(h))return this.handleError("You cannot have both hidden Tabs and visible Tabs"),t;const w=((n=m==null?void 0:m.style)===null||n===void 0?void 0:n.customCSSUrl)||this.embedConfig.customCssUrl;w&&(t[I.CustomCSSUrl]=w),l!=null&&l.length&&(t[I.DisableActions]=l),a&&(t[I.DisableActionReason]=a),t[I.HideActions]=[...this.defaultHiddenActions,...u??[]],Array.isArray(d)&&(t[I.VisibleActions]=d),Array.isArray(h)&&(t[I.HiddenTabs]=h),Array.isArray(p)&&(t[I.VisibleTabs]=p),S===mr.LEFT_CLICK?t[I.ContextMenuTrigger]=!0:S===mr.RIGHT_CLICK&&(t[I.ContextMenuTrigger]=!1);const C=(m==null?void 0:m.iconSpriteUrl)||((s=this.embedConfig.customizations)===null||s===void 0?void 0:s.iconSpriteUrl);return C&&(t[I.IconSpriteUrl]=C.replace("https://","")),f!==void 0&&(t[I.ShowAlerts]=f),_!==void 0&&(t[I.Locale]=_),g&&g.constructor.name==="Object"&&Object.assign(t,g),b&&(t[I.LinkOverride]=b),v&&(t[I.ShowInsertToSlide]=v),t[I.OverrideNativeConsole]=!0,t[I.ClientLogLevel]=this.embedConfig.logLevel,t}getV1EmbedBasePath(t){const r=this.shouldEncodeUrlQueryParams?`?base64UrlEncodedFlags=${An(t)}`:`?${t}`;return`${this.thoughtSpotHost}/${r}#`}getEmbedParams(){const t=this.getBaseQueryParams();return Gs(t)}getRootIframeSrc(){const t=this.getEmbedParams();return this.getEmbedBasePath(t)}createIframeEl(t){const r=document.createElement("iframe");r.src=t,r.id=mi,r.setAttribute("data-ts-iframe","true"),r.allowFullscreen=!0,r.webkitallowfullscreen=!0,r.mozallowfullscreen=!0,r.allow="clipboard-read; clipboard-write";const{height:i,width:n,...s}=this.viewConfig.frameParams||{},o=ii(n||Hf),l=ii(i||Bf);return Na(r,s),r.style.width=`${o}`,r.style.height=`${l}`,r.style.border="0",r.name="ThoughtSpot Embedded Analytics",r}handleInsertionIntoDOM(t){this.isPreRendered?this.insertIntoDOMForPreRender(t):this.insertIntoDOM(t),this.insertedDomEl instanceof Node&&(this.insertedDomEl[this.embedNodeKey]=this)}async renderIFrame(t){return this.isError?null:(this.thoughtSpotHost||this.throwInitError(),t.length>Ff,am(r=>{var i;const n=Date.now();return this.executeCallbacks(H.Init,{data:{timestamp:n},type:H.Init}),Oe(Ge.VISUAL_SDK_RENDER_START),(i=em())===null||i===void 0?void 0:i.then(s=>{if(!s){this.handleInsertionIntoDOM(this.embedConfig.loginFailedMessage);return}this.iFrame=this.iFrame||this.createIframeEl(t),this.iFrame.addEventListener("load",()=>{r();const l=Date.now();this.executeCallbacks(H.Load,{data:{timestamp:l},type:H.Load}),Oe(Ge.VISUAL_SDK_RENDER_COMPLETE,{elWidth:this.iFrame.clientWidth,elHeight:this.iFrame.clientHeight,timeTookToLoad:l-n})}),this.iFrame.addEventListener("error",()=>{r()}),this.handleInsertionIntoDOM(this.iFrame);const o=document.querySelectorAll(".prefetchIframe");o.length&&o.forEach(l=>{l.remove()}),this.subscribeToEvents()}).catch(s=>{r(),Oe(Ge.VISUAL_SDK_RENDER_FAILED,{error:JSON.stringify(s)}),this.handleInsertionIntoDOM(this.embedConfig.loginFailedMessage),this.handleError(s)})}))}createPreRenderWrapper(){var t;const r=this.getPreRenderIds();(t=document.getElementById(r.wrapper))===null||t===void 0||t.remove();const i=document.createElement("div");return i.id=r.wrapper,Ot(i,{position:"absolute",width:"100vw",height:"100vh"}),i}connectPreRendered(){const t=this.getPreRenderIds();return this.preRenderWrapper=this.preRenderWrapper||document.getElementById(t.wrapper),this.preRenderChild=this.preRenderChild||document.getElementById(t.child),this.preRenderWrapper&&this.preRenderChild&&(this.isPreRendered=!0,this.preRenderChild instanceof HTMLIFrameElement&&(this.iFrame=this.preRenderChild),this.insertedDomEl=this.preRenderWrapper,this.isRendered=!0),this.isPreRenderAvailable()}isPreRenderAvailable(){return this.isRendered&&this.isPreRendered&&!!(this.preRenderWrapper&&this.preRenderChild)}createPreRenderChild(t){var r;const i=this.getPreRenderIds();if((r=document.getElementById(i.child))===null||r===void 0||r.remove(),t instanceof HTMLElement)return t.id=i.child,t;const n=document.createElement("div");return Ot(n,{width:"100%",height:"100%"}),n.id=i.child,typeof t=="string"?n.innerHTML=t:n.appendChild(t),n}insertIntoDOMForPreRender(t){const r=this.createPreRenderChild(t),i=this.createPreRenderWrapper();i.appendChild(r),this.preRenderChild=r,this.preRenderWrapper=i,r instanceof HTMLIFrameElement&&(this.iFrame=r),this.insertedDomEl=i,this.showPreRenderByDefault?this.showPreRender():this.hidePreRender(),document.body.appendChild(i)}insertIntoDOM(t){var r;if(this.viewConfig.insertAsSibling){if(typeof t=="string"){const i=document.createElement("div");i.innerHTML=t,i.id=mi,t=i}((r=this.el.nextElementSibling)===null||r===void 0?void 0:r.id)===mi&&this.el.nextElementSibling.remove(),this.el.parentElement.insertBefore(t,this.el.nextSibling),this.insertedDomEl=t}else typeof t=="string"?(this.el.innerHTML=t,this.insertedDomEl=this.el.children[0]):(this.el.innerHTML="",this.el.appendChild(t),this.insertedDomEl=t)}setIFrameHeight(t){this.iFrame.style.height=ii(t)}executeCallbacks(t,r,i){const n=this.eventHandlerMap.get(t)||[],s=this.eventHandlerMap.get(H.ALL)||[],o=[...n,...s],l=(r==null?void 0:r.status)||ni.END;o.forEach(a=>{(a.options.start&&l===ni.START||!a.options.start&&l===ni.END)&&a.callback(r,u=>{this.triggerEventOnPort(i,u)})})}getThoughtSpotHost(){return this.thoughtSpotHost}getCompatibleEventType(t){return zm[t]||t}getIframeCenter(){const t=La(this.iFrame),r=window.scrollY,i=window.innerHeight,n=this.iFrame.offsetHeight,s=r-t;let o,l;return s<0?(o=i-(t-r),o=Math.min(n,o),l=0):(o=Math.min(n-s,i),l=s),{iframeCenter:l+o/2,iframeScrolled:s,iframeHeight:n,viewPortHeight:i,iframeVisibleViewPort:o}}on(t,r,i={start:!1},n=!1){Oe(`${Ge.VISUAL_SDK_ON}-${t}`,{isRegisteredBySDK:n}),this.isRendered&&this.handleError("Please register event handlers before calling render");const s=this.eventHandlerMap.get(t)||[];return s.push({options:i,callback:r}),this.eventHandlerMap.set(t,s),this}off(t,r){const i=this.eventHandlerMap.get(t)||[],n=i.findIndex(s=>s.callback===r);return n>-1&&i.splice(n,1),this}triggerEventOnPort(t,r){if(t)try{t.postMessage({type:r.type,data:r.data})}catch(i){t.postMessage({error:i}),K.log(i)}else K.log("Event Port is not defined")}trigger(t,r={}){return Oe(`${Ge.VISUAL_SDK_TRIGGER}-${t}`),this.isRendered?t?_m(this.iFrame,t,this.thoughtSpotHost,r):(this.handleError("Host event type is undefined"),null):(this.handleError("Please call render before triggering events"),null)}async render(){return this.isRendered=!0,this}getIframeSrc(){return""}handleRenderForPrerender(){this.render()}preRender(t=!1){return this.viewConfig.preRenderId?(this.isPreRendered=!0,this.showPreRenderByDefault=t,this.handleRenderForPrerender(),this):(K.error("PreRender id is required for preRender"),this)}getThoughtSpotPostUrlParams(){const t=window.location.hash,r=window.location.search,i=t.split("?"),n=i[i.length-1],s=new URLSearchParams(r),o=new URLSearchParams(n),l=new URLSearchParams,a=(d,h)=>{h.startsWith(jm)&&l.append(h,d)};s.forEach(a),o.forEach(a);let u=l.toString();return u=u?`?${u}`:"",u}destroy(){var t;try{(t=this.insertedDomEl)===null||t===void 0||t.parentNode.removeChild(this.insertedDomEl),this.unsubscribeToEvents()}catch(r){K.log("Error destroying TS Embed",r)}}getUnderlyingFrameElement(){return this.iFrame}async prerenderGeneric(){const t=this.getRootIframeSrc();return this.isRendered=!0,this.renderIFrame(t)}beforePrerenderVisible(){}showPreRender(){if(!this.viewConfig.preRenderId){K.error("PreRender id is required for preRender");return}if(!this.isPreRenderAvailable()){if(!this.connectPreRendered()){this.preRender(!0);return}this.validatePreRenderViewConfig(this.viewConfig)}this.el&&(this.syncPreRenderStyle(),this.viewConfig.doNotTrackPreRenderSize||(this.resizeObserver=new ResizeObserver(t=>{t.forEach(r=>{r.contentRect&&r.target===this.el&&Ot(this.preRenderWrapper,{width:`${r.contentRect.width}px`,height:`${r.contentRect.height}px`})})}),this.resizeObserver.observe(this.el))),this.beforePrerenderVisible(),Ba(this.preRenderWrapper,["z-index","opacity","pointer-events"]),this.subscribeToEvents()}syncPreRenderStyle(){if(!this.isPreRenderAvailable()||!this.el){K.error("PreRender should be called before using syncPreRenderStyle");return}const t=this.el.getBoundingClientRect();Ot(this.preRenderWrapper,{top:`${t.y+window.scrollY}px`,left:`${t.x+window.scrollX}px`,width:`${t.width}px`,height:`${t.height}px`})}hidePreRender(){if(!this.isPreRenderAvailable()){K.warn("PreRender should be called before hiding it using hidePreRender.");return}const t={opacity:"0",pointerEvents:"none",zIndex:"-1000",position:"absolute "};Ot(this.preRenderWrapper,t),this.resizeObserver&&this.resizeObserver.disconnect(),this.unsubscribeToEvents()}getPreRenderIds(){return{wrapper:`tsEmbed-pre-render-wrapper-${this.viewConfig.preRenderId}`,child:`tsEmbed-pre-render-child-${this.viewConfig.preRenderId}`}}async getAnswerService(t){const{session:r}=await this.trigger(De.GetAnswerSession,t);return new Br(r,null,this.embedConfig.thoughtSpotHost)}}class Gm extends qm{constructor(t,r){super(t,r),this.viewConfig={excludeRuntimeFiltersfromURL:!1,...r}}renderV1Embed(t){return this.renderIFrame(t)}getRootIframeSrc(){const t=this.getEmbedParams();let r=t;if(!this.viewConfig.excludeRuntimeParametersfromURL){const i=this.viewConfig.runtimeParameters;r=[qs(i||[]),t].filter(Boolean).join("&")}if(!this.viewConfig.excludeRuntimeFiltersfromURL){const i=this.viewConfig.runtimeFilters;r=[zs(i||[]),r].filter(Boolean).join("&")}return this.viewConfig.enableV2Shell_experimental?this.getEmbedBasePath(r):this.getV1EmbedBasePath(r)}on(t,r,i={start:!1}){const n=this.getCompatibleEventType(t);return super.on(n,r,i)}}var $s;(function(e){e.Home="home",e.Search="search",e.Answers="answers",e.Liveboards="liveboards",e.Pinboards="pinboards",e.Data="data",e.SpotIQ="insights"})($s||($s={}));var Ds;(function(e){e.EXPAND_ALL="EXPAND_ALL",e.COLLAPSE_ALL="COLLAPSE_ALL",e.EXPAND_FIRST="EXPAND_FIRST"})(Ds||(Ds={}));class Vm extends Gm{constructor(t,r){r.embedComponentType="LiveboardEmbed",super(t,r),this.defaultHeight=500,this.updateIFrameHeight=i=>{this.setIFrameHeight(Math.max(i.data,this.defaultHeight))},this.embedIframeCenter=(i,n)=>{const s=this.getIframeCenter();n({type:H.EmbedIframeCenter,data:s})},this.setIframeHeightForNonEmbedLiveboard=i=>{i.data.currentPath.startsWith("/embed/viz/")||i.data.currentPath.startsWith("/embed/insights/viz/")||this.setIFrameHeight(this.defaultHeight)},this.viewConfig.fullHeight===!0&&(this.on(H.RouteChange,this.setIframeHeightForNonEmbedLiveboard),this.on(H.EmbedHeight,this.updateIFrameHeight),this.on(H.EmbedIframeCenter,this.embedIframeCenter))}getEmbedParams(){let t={};t[I.EmbedApp]=!0,t=this.getBaseQueryParams(t);const{enableVizTransformations:r,fullHeight:i,defaultHeight:n,visibleVizs:s,liveboardV2:o,vizId:l,hideTabPanel:a,activeTabId:u,hideLiveboardHeader:d,showLiveboardDescription:h,showLiveboardTitle:p,isLiveboardHeaderSticky:f=!0,enableAskSage:g,enable2ColumnLayout:_}=this.viewConfig,m=this.viewConfig.preventLiveboardFilterRemoval||this.viewConfig.preventPinboardFilterRemoval;return i===!0&&(t[I.fullHeight]=!0),n&&(this.defaultHeight=n),r!==void 0&&(t[I.EnableVizTransformations]=r.toString()),m&&(t[I.preventLiveboardFilterRemoval]=!0),s&&(t[I.visibleVizs]=s),t[I.livedBoardEmbed]=!0,l&&(t[I.vizEmbed]=!0),o!==void 0&&(t[I.LiveboardV2Enabled]=o),_!==void 0&&(t[I.Enable2ColumnLayout]=_),a&&(t[I.HideTabPanel]=a),d&&(t[I.HideLiveboardHeader]=d),h&&(t[I.ShowLiveboardDescription]=h),p&&(t[I.ShowLiveboardTitle]=p),g&&(t[I.enableAskSage]=g),t[I.LiveboardHeaderSticky]=f,Gs(t,!0)}getIframeSuffixSrc(t,r,i){let n=`/embed/viz/${t}`;i&&(n=`${n}/tab/${i} `),r&&(n=`${n}/${r}`);const s=this.getThoughtSpotPostUrlParams();return n=`${n}${s}`,n}getIFrameSrc(){var t;const{vizId:r,activeTabId:i}=this.viewConfig,n=(t=this.viewConfig.liveboardId)!==null&&t!==void 0?t:this.viewConfig.pinboardId;return n||this.handleError(Sr.LIVEBOARD_VIZ_ID_VALIDATION),`${this.getRootIframeSrc()}${this.getIframeSuffixSrc(n,r,i)}`}setActiveTab(t){if(!this.viewConfig.vizId){const i=`${this.iFrame.src.split("#/")[1].split("/tab")[0]}/tab/${t.tabId}`;super.trigger(De.Navigate,i)}}beforePrerenderVisible(){var t;const r=(t=this.insertedDomEl)===null||t===void 0?void 0:t[this.embedNodeKey];if(_r(r))return;if(this.viewConfig.liveboardId&&r.viewConfig.liveboardId!==this.viewConfig.liveboardId){const n=this.viewConfig.liveboardId;this.navigateToLiveboard(n)}}handleRenderForPrerender(){if(_r(this.viewConfig.liveboardId)){this.prerenderGeneric();return}super.handleRenderForPrerender()}trigger(t,r={}){const i=r;return t===De.SetActiveTab?(this.setActiveTab(r),Promise.resolve(null)):(typeof i=="object"&&this.viewConfig.vizId&&(i.vizId=this.viewConfig.vizId),super.trigger(t,i))}async render(){super.render();const t=this.getIFrameSrc();return await this.renderV1Embed(t),this}navigateToLiveboard(t,r,i){const n=this.getIframeSuffixSrc(t,r,i);this.viewConfig.liveboardId=t,this.viewConfig.activeTabId=i,this.viewConfig.vizId=r,this.isRendered?this.trigger(De.Navigate,n.substring(1)):this.viewConfig.preRenderId?this.preRender(!0):this.render()}}var Ls;(function(e){e.EXPAND_ALL="EXPAND_ALL",e.COLLAPSE_ALL="COLLAPSE_ALL",e.EXPAND_FIRST="EXPAND_FIRST"})(Ls||(Ls={}));ke.EditACopy,ke.SaveAsView,ke.UpdateTML,ke.EditTML,ke.AnswerDelete;var Wm=Object.defineProperty,Km=Object.getOwnPropertyDescriptor,un=(e,t,r,i)=>{for(var n=i>1?void 0:i?Km(t,r):t,s=e.length-1,o;s>=0;s--)(o=e[s])&&(n=(i?o(t,r,n):o(n))||n);return i&&n&&Wm(t,r,n),n};let Kt=class extends $t{constructor(){super(...arguments),this.eventTracker=[]}connectedCallback(){super.connectedCallback(),sm({thoughtSpotHost:"team2.thoughtspot.cloud",authType:Q.Basic,username:"letsthinkbetter@gmail.com",password:"ltb@MAX55"});debugger}firstUpdated(e){super.firstUpdated(e),console.log(this.vizcont);const t=new Vm(this.vizcont,{frameParams:{width:"100%",height:"100%"},liveboardId:"26bdf658-9fbc-4c36-87a7-a7f657cc4627"});t.render(),this.bindEvents(t)}bindEvents(e){e.on(H.FilterChanged,t=>{this.eventTracker.push(t),console.log(this.eventTracker)}),e.on(H.VizPointClick,t=>{this.eventTracker.push(t),console.log(this.eventTracker)})}render(){return ma`
      <div class="event-tracker">
        <div class="note">Host app context</div>
      </div>
      <div class="container">elem</div>
    `}};Kt.styles=[sa`
      :host {
        display: block;
      }
      .container {
        width: 100vw;
        height: 80vh;
      }
      .event-tracker {
        height: 400px;
        width: 100vw;
        background: lightblue;
        border: 1px solid lightgray;
      }
    `];un([Ma(".container")],Kt.prototype,"vizcont",2);un([xa()],Kt.prototype,"eventTracker",2);Kt=un([Ta("my-element")],Kt);
